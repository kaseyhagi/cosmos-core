<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>COSMOS core: Socket library functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo80.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">COSMOS core
   &#160;<span id="projectnumber">1.0.2 (beta)</span>
   </div>
   <div id="projectbrief">Comprehensive Open-architecture Solution for Mission Operations Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__socketlib__functions.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Socket library functions<div class="ingroups"><a class="el" href="group__libraries.html">API libraries</a> &raquo; <a class="el" href="group__support.html">Support Libraries</a> &raquo; <a class="el" href="group__socketlib.html">Socket Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Socket library functions:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="group__socketlib__functions.svg" width="324" height="38"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_socket_options.html">SocketOptions</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_udp.html">Udp</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:gabb124101a33109d7b58c6e831cc79e03"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#gabb124101a33109d7b58c6e831cc79e03">socket_open</a> (<a class="el" href="structsocket__channel.html">socket_channel</a> *channel, <a class="el" href="group__socketlib__constants.html#gac3df430da2e0e847835025092b9dfdcf">NetworkType</a> <a class="el" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>, <a class="el" href="zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *<a class="el" href="udp__send_8cpp.html#af3b7e39acd3b2652e57c54093e6beaef">address</a>, uint16_t <a class="el" href="udp__send_8cpp.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>, uint16_t direction, bool blocking=true, uint32_t usectimeo=0, uint32_t rcvbuf=0, uint32_t sndbuf=0)</td></tr>
<tr class="memdesc:gabb124101a33109d7b58c6e831cc79e03"><td class="mdescLeft">&#160;</td><td class="mdescRight">Open UDP socket.  <a href="#gabb124101a33109d7b58c6e831cc79e03">More...</a><br /></td></tr>
<tr class="separator:gabb124101a33109d7b58c6e831cc79e03"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadc9c28341847933fbd2cbe57c2b278cd"><td class="memItemLeft" align="right" valign="top">uint16_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#gadc9c28341847933fbd2cbe57c2b278cd">socket_calc_udp_checksum</a> (vector&lt; uint8_t &gt; packet)</td></tr>
<tr class="memdesc:gadc9c28341847933fbd2cbe57c2b278cd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate UDP Checksum.  <a href="#gadc9c28341847933fbd2cbe57c2b278cd">More...</a><br /></td></tr>
<tr class="separator:gadc9c28341847933fbd2cbe57c2b278cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga44805df384d591e227045a2780ec0616"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#ga44805df384d591e227045a2780ec0616">socket_check_udp_checksum</a> (vector&lt; uint8_t &gt; packet)</td></tr>
<tr class="memdesc:ga44805df384d591e227045a2780ec0616"><td class="mdescLeft">&#160;</td><td class="mdescRight">Check UDP checksum.  <a href="#ga44805df384d591e227045a2780ec0616">More...</a><br /></td></tr>
<tr class="separator:ga44805df384d591e227045a2780ec0616"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga2bc088ec7864272341176ada2851ab5f"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#ga2bc088ec7864272341176ada2851ab5f">socket_set_udp_checksum</a> (vector&lt; uint8_t &gt; &amp;packet)</td></tr>
<tr class="memdesc:ga2bc088ec7864272341176ada2851ab5f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set UDP checksum.  <a href="#ga2bc088ec7864272341176ada2851ab5f">More...</a><br /></td></tr>
<tr class="separator:ga2bc088ec7864272341176ada2851ab5f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaa81a137bf0b76f9cbc78e7edc0a43135"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#gaa81a137bf0b76f9cbc78e7edc0a43135">socket_blocking</a> (<a class="el" href="structsocket__channel.html">socket_channel</a> *channel, bool blocking)</td></tr>
<tr class="separator:gaa81a137bf0b76f9cbc78e7edc0a43135"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga995ad21401aa032f11d701e040e88fde"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#ga995ad21401aa032f11d701e040e88fde">socket_close</a> (<a class="el" href="structsocket__channel.html">socket_channel</a> *channel)</td></tr>
<tr class="memdesc:ga995ad21401aa032f11d701e040e88fde"><td class="mdescLeft">&#160;</td><td class="mdescRight">Close socket.  <a href="#ga995ad21401aa032f11d701e040e88fde">More...</a><br /></td></tr>
<tr class="separator:ga995ad21401aa032f11d701e040e88fde"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad7703247267bf6c7e6a6262080778842"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#gad7703247267bf6c7e6a6262080778842">socket_recvfrom</a> (<a class="el" href="structsocket__channel.html">socket_channel</a> &amp;channel, vector&lt; uint8_t &gt; &amp;<a class="el" href="agent__arduino_8cpp.html#aa5e7416ffd9d6ea495320bee92ef6e4e">buffer</a>, size_t maxlen, int flags=0)</td></tr>
<tr class="separator:gad7703247267bf6c7e6a6262080778842"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga328988b9045593830a259930727700ed"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#ga328988b9045593830a259930727700ed">socket_sendto</a> (<a class="el" href="structsocket__channel.html">socket_channel</a> &amp;channel, string <a class="el" href="agent__arduino_8cpp.html#aa5e7416ffd9d6ea495320bee92ef6e4e">buffer</a>, int flags=0)</td></tr>
<tr class="separator:ga328988b9045593830a259930727700ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8579796c053b5d1e80127989ff46cd80"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#ga8579796c053b5d1e80127989ff46cd80">socket_sendto</a> (<a class="el" href="structsocket__channel.html">socket_channel</a> &amp;channel, vector&lt; uint8_t &gt; &amp;<a class="el" href="agent__arduino_8cpp.html#aa5e7416ffd9d6ea495320bee92ef6e4e">buffer</a>, int flags=0)</td></tr>
<tr class="separator:ga8579796c053b5d1e80127989ff46cd80"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga9e02d25f0adbe973a9242387d362c531"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="structsocket__channel.html">socket_channel</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__socketlib__functions.html#ga9e02d25f0adbe973a9242387d362c531">socket_find_addresses</a> (<a class="el" href="group__socketlib__constants.html#gac3df430da2e0e847835025092b9dfdcf">NetworkType</a> <a class="el" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>)</td></tr>
<tr class="memdesc:ga9e02d25f0adbe973a9242387d362c531"><td class="mdescLeft">&#160;</td><td class="mdescRight">Discover interfaces.  <a href="#ga9e02d25f0adbe973a9242387d362c531">More...</a><br /></td></tr>
<tr class="separator:ga9e02d25f0adbe973a9242387d362c531"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="gabb124101a33109d7b58c6e831cc79e03"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_open </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsocket__channel.html">socket_channel</a> *&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="group__socketlib__constants.html#gac3df430da2e0e847835025092b9dfdcf">NetworkType</a>&#160;</td>
          <td class="paramname"><em>ntype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="zconf_8h.html#a2c212835823e3c54a8ab6d95c652660e">const</a> char *&#160;</td>
          <td class="paramname"><em>address</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>port</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>role</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>blocking</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>usectimeo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>rcvbuf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>sndbuf</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Open UDP socket. </p>
<p>Open a UDP socket and configure it for the specified use. Various flags are set, and the socket is bound, if necessary. Support is provided for the extra steps necessary for MS Windows. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td>Pointer to <a class="el" href="structsocket__channel.html">socket_channel</a> holding final configuration. </td></tr>
    <tr><td class="paramname">ntype</td><td>type of casting (<a class="el" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa81d741a35dc8a42c885b7cc031afd17f" title="Agent socket using Broadcast UDP. ">NetworkType::BROADCAST</a>, <a class="el" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32" title="Agent socket using Multicast UDP. ">NetworkType::MULTICAST</a>, <a class="el" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763" title="Agent socket using Unicast TCP. ">NetworkType::TCP</a>) </td></tr>
    <tr><td class="paramname">address</td><td>Destination address </td></tr>
    <tr><td class="paramname">port</td><td>Source port. If zero, automatically assigned. </td></tr>
    <tr><td class="paramname">role</td><td>Publish, subscribe, communicate. </td></tr>
    <tr><td class="paramname">blocking</td><td>True or false. </td></tr>
    <tr><td class="paramname">usectimeo</td><td>Blocking read timeout in micro seconds. </td></tr>
    <tr><td class="paramname">rcvbuf</td><td>Optional size of buffer for setsockopt SO_RCVBUF. </td></tr>
    <tr><td class="paramname">sndbuf</td><td>Optional size of buffer for setsockopt SO_SNDBUF. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero, or negative error. </dd></dl>
<ol type="1">
<li>Join multicast </li>
</ol>
<div class="fragment"><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;{</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;<span class="comment">//    socklen_t namelen;</span></div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <span class="keyword">struct </span>ip_mreq mreq;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;    <span class="keywordtype">int</span> on = 1;</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nonblocking = 1;</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    WORD wVersionRequested;</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    WSADATA wsaData;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">bool</span> started=<span class="keyword">false</span>;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">if</span> (!started)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        wVersionRequested = MAKEWORD( 1, 1 );</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        iretn = WSAStartup( wVersionRequested, &amp;wsaData );</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        <span class="keywordflow">if</span> (iretn != 0)</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        {</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="group__error__defines.html#ga4320e7bb6d27968dfad8c556b4687df2">SOCKET_ERROR_OPEN</a>;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        started = <span class="keyword">true</span>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    }</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>)</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    {</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>:</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        {</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">if</span> ((channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = socket(AF_INET,SOCK_DGRAM,IPPROTO_IP)) &lt;0)</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;            {</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;            }</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa81d741a35dc8a42c885b7cc031afd17f">NetworkType::BROADCAST</a>:</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9">NetworkType::UDP</a>:</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;            <span class="keywordflow">if</span> ((channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = socket(AF_INET,SOCK_DGRAM,IPPROTO_UDP)) &lt;0)</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;            {</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;                <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;            }</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;        }</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763">NetworkType::TCP</a>:</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;            <span class="keywordflow">if</span> ((channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = socket(AF_INET,SOCK_STREAM,IPPROTO_TCP)) &lt;0)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            {</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;                <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;            }</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        }</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="group__error__defines.html#gaa45c05318f5acf769365533ba22be3cb">SOCKET_ERROR_PROTOCOL</a>);</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    }</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <span class="keywordflow">if</span> (blocking == <a class="code" href="group__socketlib__constants.html#ga4282c7371cda115a6cadfd89cf153a05">SOCKET_NONBLOCKING</a>)</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    {</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;        iretn = 0;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">if</span> (ioctlsocket(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, FIONBIO, &amp;nonblocking) != 0)</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        {</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;            iretn = -WSAGetLastError();</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;        }</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">if</span> (fcntl(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, F_SETFL,O_NONBLOCK) &lt; 0)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;        {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;            iretn = -errno;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">if</span> (iretn &lt; 0)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;        {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;            CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;            channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        }</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    }</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="comment">// this defines the wait time for a response from a request</span></div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">if</span> (usectimeo)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;        <span class="keywordtype">int</span> msectimeo = usectimeo/1000;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        iretn = setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,SOL_SOCKET,SO_RCVTIMEO,(<span class="keyword">const</span> <span class="keywordtype">char</span> *)&amp;msectimeo,<span class="keyword">sizeof</span>(msectimeo));</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        <span class="keyword">struct </span>timeval tv;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        tv.tv_sec = usectimeo/1000000;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        tv.tv_usec = usectimeo%1000000;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        iretn = setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,SOL_SOCKET,SO_RCVTIMEO,(<span class="keywordtype">char</span>*)&amp;tv,<span class="keyword">sizeof</span>(tv));</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    }</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    memset(&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>,0,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_family = AF_INET;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_port = htons(<a class="code" href="netperf__listen_8cpp.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>);</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    <span class="keywordflow">switch</span> (role)</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ga79ccaa6b292ff02f81a7144830bea4a2">SOCKET_LISTEN</a>:</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;<span class="preprocessor">#ifdef COSMOS_MAC_OS</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">if</span> (setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,SOL_SOCKET,SO_REUSEPORT,(<span class="keywordtype">char</span>*)&amp;on,<span class="keyword">sizeof</span>(on)) &lt; 0)</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;        <span class="keywordflow">if</span> (setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,SOL_SOCKET,SO_REUSEADDR,(<span class="keywordtype">char</span>*)&amp;on,<span class="keyword">sizeof</span>(on)) &lt; 0)</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        {</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        }</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>)</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        {</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>:</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;<span class="comment">//            {</span></div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;<span class="comment">//                channel-&gt;caddr.sin_addr.s_addr = htonl(INADDR_ANY);</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;<span class="comment">//                if (::bind(channel-&gt;cudp,(struct sockaddr *)&amp;channel-&gt;caddr, sizeof(struct sockaddr_in)) &lt; 0)</span></div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;<span class="comment">//                {</span></div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">//                    CLOSE_SOCKET(channel-&gt;cudp);</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment">//                    channel-&gt;cudp = -errno;</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment">//                    return (-errno);</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment">//                }</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment">//            }</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment">//            break;</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa81d741a35dc8a42c885b7cc031afd17f">NetworkType::BROADCAST</a>:</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9">NetworkType::UDP</a>:</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;            {</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr.s_addr = htonl(INADDR_ANY);</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                <span class="keywordflow">if</span> (::bind(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,(<span class="keyword">struct</span> sockaddr *)&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in)) &lt; 0)</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                {</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;                    CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;                }</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;            }</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763">NetworkType::TCP</a>:</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;            {</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr.s_addr = htonl(INADDR_ANY);</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_port = htons(<a class="code" href="netperf__listen_8cpp.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>);</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;                <span class="keywordflow">if</span> (::bind(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,(<span class="keyword">struct</span> sockaddr *)&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in)) &lt; 0)</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                {</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;                    CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;                    <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                }</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                <span class="keywordflow">if</span> (listen(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, 1) &lt; 0)</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                {</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;                    CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                    channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;                    <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                }</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            }</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="group__error__defines.html#gaa45c05318f5acf769365533ba22be3cb">SOCKET_ERROR_PROTOCOL</a>);</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        }</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a> == <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>)</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;            inet_pton(AF_INET,<a class="code" href="netperf__listen_8cpp.html#af3b7e39acd3b2652e57c54093e6beaef">address</a>,&amp;mreq.imr_multiaddr.s_addr);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="comment">//            inte_pton(AF_INET, , &amp;mreq.imr_interface.s_addr);</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;            <span class="comment">//          mreq.imr_multiaddr.s_addr = inet_addr(address);</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;                        mreq.imr_interface.s_addr = htonl(INADDR_ANY);</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;            <span class="keywordflow">if</span> (setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, IPPROTO_IP, IP_ADD_MEMBERSHIP, (<span class="keywordtype">char</span>*)&amp;mreq, <span class="keyword">sizeof</span>(mreq)) &lt; 0)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;            {</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;                channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;            }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        }</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ga9c66a2722aa27ee797dd90c48bbc72e7">SOCKET_JABBER</a>:</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>)</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        {</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa81d741a35dc8a42c885b7cc031afd17f">NetworkType::BROADCAST</a>:</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">if</span> ((iretn=setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,SOL_SOCKET,SO_BROADCAST,(<span class="keywordtype">char</span>*)&amp;on,<span class="keyword">sizeof</span>(on))) &lt; 0)</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;            {</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;            }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr.s_addr = 0xffffffff;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>:</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;            inet_pton(AF_INET,<a class="code" href="netperf__listen_8cpp.html#af3b7e39acd3b2652e57c54093e6beaef">address</a>,&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="group__error__defines.html#gaa45c05318f5acf769365533ba22be3cb">SOCKET_ERROR_PROTOCOL</a>);</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        }</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        channel-&gt;<a class="code" href="structsocket__channel.html#abc28641aa06af163ca74a0f66d11880c">cport</a> = <a class="code" href="netperf__listen_8cpp.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#gaff2b5308ceb89f1c50f2e8dcf079cf16">SOCKET_TALK</a>:</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        inet_pton(AF_INET,<a class="code" href="netperf__listen_8cpp.html#af3b7e39acd3b2652e57c54093e6beaef">address</a>,&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr);</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;        channel-&gt;<a class="code" href="structsocket__channel.html#abc28641aa06af163ca74a0f66d11880c">cport</a> = <a class="code" href="netperf__listen_8cpp.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a>;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a> == <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763">NetworkType::TCP</a>)</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;        {</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;            <span class="keywordflow">if</span> (connect(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>,(<span class="keyword">struct</span> sockaddr *)&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in)) &lt; 0 &amp;&amp; errno != EINPROGRESS)</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;            {</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;            }</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;        }</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="comment">// Find assigned port, place in cport, and set caddr to requested port</span></div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;    channel-&gt;<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a> = channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    channel-&gt;<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr.s_addr |= 0xff;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>)</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    {</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763">NetworkType::TCP</a>:</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        channel-&gt;<a class="code" href="structsocket__channel.html#abc28641aa06af163ca74a0f66d11880c">cport</a> = ntohs(channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_port);</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        iretn = sendto(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, (<span class="keyword">const</span> <span class="keywordtype">char</span> *)<span class="keyword">nullptr</span>, 0, 0, (<span class="keyword">struct</span> sockaddr *)&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>, <span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;        sockaddr_in taddr = channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        socklen_t namelen = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>sockaddr_in);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;        <span class="keywordflow">if</span> ((iretn = getsockname(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, (sockaddr*)&amp;channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, &amp;namelen)) == -1)</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;        {</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            CLOSE_SOCKET(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>);</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -errno;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">return</span> (-errno);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;        }</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        channel-&gt;<a class="code" href="structsocket__channel.html#abc28641aa06af163ca74a0f66d11880c">cport</a> = ntohs(channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_port);</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        channel-&gt;<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a> = taddr;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">if</span> (rcvbuf)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, SOL_SOCKET, SO_RCVBUF, (<span class="keywordtype">char</span> *)&amp;rcvbuf, 4);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;    <span class="keywordflow">if</span> (sndbuf)</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    {</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        setsockopt(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, SOL_SOCKET, SO_SNDBUF, (<span class="keywordtype">char</span> *)&amp;sndbuf, 4);</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    strncpy(channel-&gt;<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>,<a class="code" href="netperf__listen_8cpp.html#af3b7e39acd3b2652e57c54093e6beaef">address</a>,17);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    channel-&gt;<a class="code" href="structsocket__channel.html#addb1179eeaf45b16e3cb91eb02821826">type</a> = <a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;    channel-&gt;<a class="code" href="structsocket__channel.html#ac8d281058a9bb5c8ac7d12e00e800ba5">addrlen</a> = <span class="keyword">sizeof</span>(<span class="keyword">struct </span>sockaddr_in);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;}</div><div class="ttc" id="group__socketlib__constants_html_ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9"><div class="ttname"><a href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9">NetworkType::UDP</a></div><div class="ttdoc">Agent socket using Unicast UDP. </div></div>
<div class="ttc" id="group__socketlib__constants_html_ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763"><div class="ttname"><a href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfab136ef5f6a01d816991fe3cf7a6ac763">NetworkType::TCP</a></div><div class="ttdoc">Agent socket using Unicast TCP. </div></div>
<div class="ttc" id="group__error__defines_html_gaa45c05318f5acf769365533ba22be3cb"><div class="ttname"><a href="group__error__defines.html#gaa45c05318f5acf769365533ba22be3cb">SOCKET_ERROR_PROTOCOL</a></div><div class="ttdeci">#define SOCKET_ERROR_PROTOCOL</div><div class="ttdef"><b>Definition:</b> cosmos-errno.h:230</div></div>
<div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__error__defines_html_ga4320e7bb6d27968dfad8c556b4687df2"><div class="ttname"><a href="group__error__defines.html#ga4320e7bb6d27968dfad8c556b4687df2">SOCKET_ERROR_OPEN</a></div><div class="ttdeci">#define SOCKET_ERROR_OPEN</div><div class="ttdef"><b>Definition:</b> cosmos-errno.h:232</div></div>
<div class="ttc" id="structsocket__channel_html_a010577b917edde7e3d2780ddac8d6cd9"><div class="ttname"><a href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">socket_channel::baddr</a></div><div class="ttdeci">struct sockaddr_in baddr</div><div class="ttdef"><b>Definition:</b> socketlib.h:124</div></div>
<div class="ttc" id="structsocket__channel_html_a5fc746e018706be753d291638f7baddb"><div class="ttname"><a href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">socket_channel::address</a></div><div class="ttdeci">char address[17]</div><div class="ttdef"><b>Definition:</b> socketlib.h:134</div></div>
<div class="ttc" id="group__socketlib__constants_html_ga4282c7371cda115a6cadfd89cf153a05"><div class="ttname"><a href="group__socketlib__constants.html#ga4282c7371cda115a6cadfd89cf153a05">SOCKET_NONBLOCKING</a></div><div class="ttdeci">#define SOCKET_NONBLOCKING</div><div class="ttdoc">Non-blocking Agent. </div><div class="ttdef"><b>Definition:</b> socketlib.h:80</div></div>
<div class="ttc" id="group__socketlib__constants_html_gaff2b5308ceb89f1c50f2e8dcf079cf16"><div class="ttname"><a href="group__socketlib__constants.html#gaff2b5308ceb89f1c50f2e8dcf079cf16">SOCKET_TALK</a></div><div class="ttdeci">#define SOCKET_TALK</div><div class="ttdoc">Talk followed by optional listen (sendto address) </div><div class="ttdef"><b>Definition:</b> socketlib.h:82</div></div>
<div class="ttc" id="structsocket__channel_html_abc28641aa06af163ca74a0f66d11880c"><div class="ttname"><a href="structsocket__channel.html#abc28641aa06af163ca74a0f66d11880c">socket_channel::cport</a></div><div class="ttdeci">uint16_t cport</div><div class="ttdef"><b>Definition:</b> socketlib.h:130</div></div>
<div class="ttc" id="netperf__listen_8cpp_html_af3b7e39acd3b2652e57c54093e6beaef"><div class="ttname"><a href="netperf__listen_8cpp.html#af3b7e39acd3b2652e57c54093e6beaef">address</a></div><div class="ttdeci">char address[]</div><div class="ttdef"><b>Definition:</b> netperf_listen.cpp:69</div></div>
<div class="ttc" id="structsocket__channel_html_ab3e41f03ddf5695db099e8d7db507fd2"><div class="ttname"><a href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">socket_channel::cudp</a></div><div class="ttdeci">int32_t cudp</div><div class="ttdef"><b>Definition:</b> socketlib.h:120</div></div>
<div class="ttc" id="structsocket__channel_html_addb1179eeaf45b16e3cb91eb02821826"><div class="ttname"><a href="structsocket__channel.html#addb1179eeaf45b16e3cb91eb02821826">socket_channel::type</a></div><div class="ttdeci">NetworkType type</div><div class="ttdef"><b>Definition:</b> socketlib.h:118</div></div>
<div class="ttc" id="structsocket__channel_html_a8d2c39afd45c287064229be41dfea731"><div class="ttname"><a href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">socket_channel::caddr</a></div><div class="ttdeci">struct sockaddr_in caddr</div><div class="ttdef"><b>Definition:</b> socketlib.h:122</div></div>
<div class="ttc" id="structsocket__channel_html_ac8d281058a9bb5c8ac7d12e00e800ba5"><div class="ttname"><a href="structsocket__channel.html#ac8d281058a9bb5c8ac7d12e00e800ba5">socket_channel::addrlen</a></div><div class="ttdeci">int addrlen</div><div class="ttdef"><b>Definition:</b> socketlib.h:128</div></div>
<div class="ttc" id="group__socketlib__constants_html_ggac3df430da2e0e847835025092b9dfdcfa81d741a35dc8a42c885b7cc031afd17f"><div class="ttname"><a href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa81d741a35dc8a42c885b7cc031afd17f">NetworkType::BROADCAST</a></div><div class="ttdoc">Agent socket using Broadcast UDP. </div></div>
<div class="ttc" id="agent__node_8cpp_html_a8dadfa60d80a481745f0212f7caec1e7"><div class="ttname"><a href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a></div><div class="ttdeci">NetworkType ntype</div><div class="ttdef"><b>Definition:</b> agent_node.cpp:51</div></div>
<div class="ttc" id="group__socketlib__constants_html_ga79ccaa6b292ff02f81a7144830bea4a2"><div class="ttname"><a href="group__socketlib__constants.html#ga79ccaa6b292ff02f81a7144830bea4a2">SOCKET_LISTEN</a></div><div class="ttdeci">#define SOCKET_LISTEN</div><div class="ttdoc">Listen followed by optional talk (recvfrom INADDRANY) </div><div class="ttdef"><b>Definition:</b> socketlib.h:84</div></div>
<div class="ttc" id="group__socketlib__constants_html_ga9c66a2722aa27ee797dd90c48bbc72e7"><div class="ttname"><a href="group__socketlib__constants.html#ga9c66a2722aa27ee797dd90c48bbc72e7">SOCKET_JABBER</a></div><div class="ttdeci">#define SOCKET_JABBER</div><div class="ttdoc">Talk over multiple interfaces. </div><div class="ttdef"><b>Definition:</b> socketlib.h:88</div></div>
<div class="ttc" id="group__socketlib__constants_html_ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32"><div class="ttname"><a href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a></div><div class="ttdoc">Agent socket using Multicast UDP. </div></div>
<div class="ttc" id="netperf__listen_8cpp_html_a8e0798404bf2cf5dabb84c5ba9a4f236"><div class="ttname"><a href="netperf__listen_8cpp.html#a8e0798404bf2cf5dabb84c5ba9a4f236">port</a></div><div class="ttdeci">uint16_t port</div><div class="ttdef"><b>Definition:</b> netperf_listen.cpp:70</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadc9c28341847933fbd2cbe57c2b278cd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint16_t socket_calc_udp_checksum </td>
          <td>(</td>
          <td class="paramtype">vector&lt; uint8_t &gt;&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate UDP Checksum. </p>
<p>Calculate UDP Checksum, as detailed in RFC 768, based on the provided IP packet. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>IP packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Calculated checksum. </dd></dl>
<div class="fragment"><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;{</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="keyword">union</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    {</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        uint8_t* bytes;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;        uint16_t* ints;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;    } ;</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;    bytes = &amp;packet[0];</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;    uint32_t csum32;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;    csum32 = 0;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    <span class="comment">// Pseudo header</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="comment">// Source Address</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    csum32 += ints[6];</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;    csum32 += ints[7];</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;    <span class="comment">// Destination Address</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    csum32 += ints[8];</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    csum32 += ints[9];</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// Protocol byte</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    csum32 += bytes[<a class="code" href="group__socketlib__constants.html#ga312aefd6534620553e7a71acf14e50c1">SOCKET_IP_BYTE_PROTOCOL</a>]*256U;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="comment">// UDP Length</span></div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    csum32 += ints[12];</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    <span class="comment">// UDP header</span></div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    <span class="comment">// UDP Source Port</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    csum32 += ints[10];</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// UDP Destination Port</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    csum32 += ints[11];</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// UDP Length</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    csum32 += ints[12];</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// UDP Checksum</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    csum32 += ints[13];</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// Actual data bytes. Do any even number, then special treatment for any odd byte.</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    uint16_t udpl = (bytes[24]*256U + bytes[25]) - 8;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keywordflow">if</span> (udpl)</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    {</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">for</span> (uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;udpl/2; ++<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        {</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;            csum32 += ints[14+<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        }</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;        <span class="keywordflow">if</span> (2*(udpl/2) != udpl)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;            csum32 += bytes[27+udpl];</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        }</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="comment">// Perform end around carry</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;    <span class="keywordflow">while</span> (csum32 &gt; 0xffff)</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;    {</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        csum32 = (csum32 &amp; 0xffff) + (csum32 &gt;&gt; 16);</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;    }</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;    csum32 = ~csum32;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;    <span class="keywordflow">if</span> ((uint16_t)csum32 == 0)</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    {</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;        <span class="keywordflow">return</span> 0xffff;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;    }</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;        <span class="keywordflow">return</span> (uint16_t)csum32;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    }</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;}</div><div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__socketlib__constants_html_ga312aefd6534620553e7a71acf14e50c1"><div class="ttname"><a href="group__socketlib__constants.html#ga312aefd6534620553e7a71acf14e50c1">SOCKET_IP_BYTE_PROTOCOL</a></div><div class="ttdeci">#define SOCKET_IP_BYTE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> socketlib.h:97</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga44805df384d591e227045a2780ec0616"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_check_udp_checksum </td>
          <td>(</td>
          <td class="paramtype">vector&lt; uint8_t &gt;&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Check UDP checksum. </p>
<p>Calculate UDP checksum for provided UDP packet and return whether it is valid or not. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>UDP packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero or negative error. </dd></dl>
<div class="fragment"><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;{</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;    uint16_t csum = <a class="code" href="group__socketlib__functions.html#gadc9c28341847933fbd2cbe57c2b278cd">socket_calc_udp_checksum</a>(packet);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;    <span class="comment">//  if (csum == uint16from(&amp;packet[26], ByteOrder::NETWORK))</span></div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="keywordflow">if</span> (csum == 0xffff)</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    {</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    }</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    {</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__error__defines.html#gaf2091da236855735402762690ff03807">SOCKET_ERROR_CS</a>;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;}</div><div class="ttc" id="group__error__defines_html_gaf2091da236855735402762690ff03807"><div class="ttname"><a href="group__error__defines.html#gaf2091da236855735402762690ff03807">SOCKET_ERROR_CS</a></div><div class="ttdeci">#define SOCKET_ERROR_CS</div><div class="ttdef"><b>Definition:</b> cosmos-errno.h:229</div></div>
<div class="ttc" id="group__socketlib__functions_html_gadc9c28341847933fbd2cbe57c2b278cd"><div class="ttname"><a href="group__socketlib__functions.html#gadc9c28341847933fbd2cbe57c2b278cd">socket_calc_udp_checksum</a></div><div class="ttdeci">uint16_t socket_calc_udp_checksum(vector&lt; uint8_t &gt; packet)</div><div class="ttdoc">Calculate UDP Checksum. </div><div class="ttdef"><b>Definition:</b> socketlib.cpp:310</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga2bc088ec7864272341176ada2851ab5f"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_set_udp_checksum </td>
          <td>(</td>
          <td class="paramtype">vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>packet</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set UDP checksum. </p>
<p>Clear UDP checksum field, calculate UDP checksum, and set UDP checksum field in provided UDP packet. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">packet</td><td>UDP packet </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero or negative error. </dd></dl>
<div class="fragment"><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;{</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;    <span class="comment">// Check if this is UDP packet</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="keywordflow">if</span> (packet[<a class="code" href="group__socketlib__constants.html#ga312aefd6534620553e7a71acf14e50c1">SOCKET_IP_BYTE_PROTOCOL</a>] != 17)</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="group__error__defines.html#gaa45c05318f5acf769365533ba22be3cb">SOCKET_ERROR_PROTOCOL</a>;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    }</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="comment">// Set UDP checksum bytes to zero.</span></div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    packet[<a class="code" href="group__socketlib__constants.html#gac23b4b33b0f00f4707593b8acb6a4e0e">SOCKET_IP_BYTE_UDP_CS</a>] = packet[<a class="code" href="group__socketlib__constants.html#gac23b4b33b0f00f4707593b8acb6a4e0e">SOCKET_IP_BYTE_UDP_CS</a>+1] = 0;</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// Calculate checksum</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    uint16_t csum = <a class="code" href="group__socketlib__functions.html#gadc9c28341847933fbd2cbe57c2b278cd">socket_calc_udp_checksum</a>(packet);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    <span class="comment">// Place it in checksum bytes</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="group__mathlib__functions.html#ga09a57801d2b9f268789b4a51122161d7">uint16to</a>(csum, &amp;packet[<a class="code" href="group__socketlib__constants.html#gac23b4b33b0f00f4707593b8acb6a4e0e">SOCKET_IP_BYTE_UDP_CS</a>], <a class="code" href="group__mathlib__constants.html#gga1c781d3784e382d213a9c7938b154669a31db56e43932be3c660666099f7667bd">ByteOrder::LITTLEENDIAN</a>);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;}</div><div class="ttc" id="group__socketlib__constants_html_gac23b4b33b0f00f4707593b8acb6a4e0e"><div class="ttname"><a href="group__socketlib__constants.html#gac23b4b33b0f00f4707593b8acb6a4e0e">SOCKET_IP_BYTE_UDP_CS</a></div><div class="ttdeci">#define SOCKET_IP_BYTE_UDP_CS</div><div class="ttdef"><b>Definition:</b> socketlib.h:101</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga09a57801d2b9f268789b4a51122161d7"><div class="ttname"><a href="group__mathlib__functions.html#ga09a57801d2b9f268789b4a51122161d7">uint16to</a></div><div class="ttdeci">void uint16to(uint16_t value, uint8_t *pointer, ByteOrder order)</div><div class="ttdoc">16 bit unsigned integer to memory </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:613</div></div>
<div class="ttc" id="group__error__defines_html_gaa45c05318f5acf769365533ba22be3cb"><div class="ttname"><a href="group__error__defines.html#gaa45c05318f5acf769365533ba22be3cb">SOCKET_ERROR_PROTOCOL</a></div><div class="ttdeci">#define SOCKET_ERROR_PROTOCOL</div><div class="ttdef"><b>Definition:</b> cosmos-errno.h:230</div></div>
<div class="ttc" id="group__socketlib__constants_html_ga312aefd6534620553e7a71acf14e50c1"><div class="ttname"><a href="group__socketlib__constants.html#ga312aefd6534620553e7a71acf14e50c1">SOCKET_IP_BYTE_PROTOCOL</a></div><div class="ttdeci">#define SOCKET_IP_BYTE_PROTOCOL</div><div class="ttdef"><b>Definition:</b> socketlib.h:97</div></div>
<div class="ttc" id="group__mathlib__constants_html_gga1c781d3784e382d213a9c7938b154669a31db56e43932be3c660666099f7667bd"><div class="ttname"><a href="group__mathlib__constants.html#gga1c781d3784e382d213a9c7938b154669a31db56e43932be3c660666099f7667bd">ByteOrder::LITTLEENDIAN</a></div><div class="ttdoc">Little Endian byte order. </div></div>
<div class="ttc" id="group__socketlib__functions_html_gadc9c28341847933fbd2cbe57c2b278cd"><div class="ttname"><a href="group__socketlib__functions.html#gadc9c28341847933fbd2cbe57c2b278cd">socket_calc_udp_checksum</a></div><div class="ttdeci">uint16_t socket_calc_udp_checksum(vector&lt; uint8_t &gt; packet)</div><div class="ttdoc">Calculate UDP Checksum. </div><div class="ttdef"><b>Definition:</b> socketlib.cpp:310</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaa81a137bf0b76f9cbc78e7edc0a43135"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_blocking </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsocket__channel.html">socket_channel</a> *&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">bool&#160;</td>
          <td class="paramname"><em>blocking</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;{</div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="keywordflow">if</span> (blocking == <a class="code" href="group__socketlib__constants.html#ga4282c7371cda115a6cadfd89cf153a05">SOCKET_NONBLOCKING</a>)</div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    {</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;        iretn = 0;</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nonblocking = 1;</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;        <span class="keywordflow">if</span> (ioctlsocket(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, FIONBIO, &amp;nonblocking) != 0)</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        {</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            iretn = -WSAGetLastError();</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        }</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;        <span class="keywordflow">if</span> (fcntl(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, F_SETFL,O_NONBLOCK) &lt; 0)</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;            iretn = -errno;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;        }</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    }</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    {</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        iretn = 0;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nonblocking = 0;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <span class="keywordflow">if</span> (ioctlsocket(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, FIONBIO, &amp;nonblocking) != 0)</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;        {</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;            iretn = -WSAGetLastError();</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        }</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        <span class="keywordtype">int</span> oldfl;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="keywordflow">if</span> ((oldfl = fcntl(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, F_GETFL)) == -1)</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        {</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;            iretn = -errno;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;        }</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        {</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;            <span class="keywordflow">if</span> (fcntl(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, F_SETFL, oldfl &amp; ~O_NONBLOCK) &lt; 0)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;            {</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                iretn = -errno;</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;            }</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    }</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;}</div><div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__socketlib__constants_html_ga4282c7371cda115a6cadfd89cf153a05"><div class="ttname"><a href="group__socketlib__constants.html#ga4282c7371cda115a6cadfd89cf153a05">SOCKET_NONBLOCKING</a></div><div class="ttdeci">#define SOCKET_NONBLOCKING</div><div class="ttdoc">Non-blocking Agent. </div><div class="ttdef"><b>Definition:</b> socketlib.h:80</div></div>
<div class="ttc" id="structsocket__channel_html_ab3e41f03ddf5695db099e8d7db507fd2"><div class="ttname"><a href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">socket_channel::cudp</a></div><div class="ttdeci">int32_t cudp</div><div class="ttdef"><b>Definition:</b> socketlib.h:120</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga995ad21401aa032f11d701e040e88fde"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_close </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsocket__channel.html">socket_channel</a> *&#160;</td>
          <td class="paramname"><em>channel</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Close socket. </p>
<p>Close down open socket connectiom. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">channel</td><td>Pointer to <a class="el" href="structsocket__channel.html">socket_channel</a> holding final configuration. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Zero or negative error. </dd></dl>
<div class="fragment"><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;{</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a> = 0;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <span class="keywordflow">if</span> (channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> &gt;= 0)</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    {</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordflow">if</span> (closesocket(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>) &lt; 0)</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        {</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;            iretn = -WSAGetLastError();</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;        }</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="keywordflow">if</span> (close(channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>) &lt; 0)</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        {</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;            iretn = -errno;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <span class="comment">//    channel-&gt;address[0] = 0;</span></div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;        channel-&gt;<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a> = -1;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    }</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;}</div><div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structsocket__channel_html_ab3e41f03ddf5695db099e8d7db507fd2"><div class="ttname"><a href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">socket_channel::cudp</a></div><div class="ttdeci">int32_t cudp</div><div class="ttdef"><b>Definition:</b> socketlib.h:120</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad7703247267bf6c7e6a6262080778842"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_recvfrom </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsocket__channel.html">socket_channel</a> &amp;&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">size_t&#160;</td>
          <td class="paramname"><em>maxlen</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;{</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    int32_t nbytes;</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.resize(maxlen);</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;    <span class="keywordflow">if</span> ((nbytes = recvfrom(channel.<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, (<span class="keywordtype">char</span> *)<a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.data(), maxlen, flags, (<span class="keyword">struct </span>sockaddr *)&amp;channel.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, (socklen_t *)&amp;channel.<a class="code" href="structsocket__channel.html#ac8d281058a9bb5c8ac7d12e00e800ba5">addrlen</a>)) &gt; 0)</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    {</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        <a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.resize(nbytes);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        inet_ntop(channel.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_family, &amp;channel.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr, channel.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>, <span class="keyword">sizeof</span>(channel.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>));</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    {</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;        nbytes = -errno;</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    }</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;    <span class="keywordflow">return</span> nbytes;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;}</div><div class="ttc" id="structsocket__channel_html_a5fc746e018706be753d291638f7baddb"><div class="ttname"><a href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">socket_channel::address</a></div><div class="ttdeci">char address[17]</div><div class="ttdef"><b>Definition:</b> socketlib.h:134</div></div>
<div class="ttc" id="structsocket__channel_html_ab3e41f03ddf5695db099e8d7db507fd2"><div class="ttname"><a href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">socket_channel::cudp</a></div><div class="ttdeci">int32_t cudp</div><div class="ttdef"><b>Definition:</b> socketlib.h:120</div></div>
<div class="ttc" id="propagator__simple_8cpp_html_aefc66c7c76cac6590187a1f7afb99cd9"><div class="ttname"><a href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a></div><div class="ttdeci">char buffer[255]</div><div class="ttdef"><b>Definition:</b> propagator_simple.cpp:60</div></div>
<div class="ttc" id="structsocket__channel_html_a8d2c39afd45c287064229be41dfea731"><div class="ttname"><a href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">socket_channel::caddr</a></div><div class="ttdeci">struct sockaddr_in caddr</div><div class="ttdef"><b>Definition:</b> socketlib.h:122</div></div>
<div class="ttc" id="structsocket__channel_html_ac8d281058a9bb5c8ac7d12e00e800ba5"><div class="ttname"><a href="structsocket__channel.html#ac8d281058a9bb5c8ac7d12e00e800ba5">socket_channel::addrlen</a></div><div class="ttdeci">int addrlen</div><div class="ttdef"><b>Definition:</b> socketlib.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga328988b9045593830a259930727700ed"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_sendto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsocket__channel.html">socket_channel</a> &amp;&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;{</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    vector&lt;uint8_t&gt; data(<a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.begin(), <a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.end());</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="group__socketlib__functions.html#ga328988b9045593830a259930727700ed">socket_sendto</a>(channel, data, flags);</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;}</div><div class="ttc" id="group__socketlib__functions_html_ga328988b9045593830a259930727700ed"><div class="ttname"><a href="group__socketlib__functions.html#ga328988b9045593830a259930727700ed">socket_sendto</a></div><div class="ttdeci">int32_t socket_sendto(socket_channel &amp;channel, string buffer, int flags)</div><div class="ttdef"><b>Definition:</b> socketlib.cpp:683</div></div>
<div class="ttc" id="propagator__simple_8cpp_html_aefc66c7c76cac6590187a1f7afb99cd9"><div class="ttname"><a href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a></div><div class="ttdeci">char buffer[255]</div><div class="ttdef"><b>Definition:</b> propagator_simple.cpp:60</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8579796c053b5d1e80127989ff46cd80"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t socket_sendto </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsocket__channel.html">socket_channel</a> &amp;&#160;</td>
          <td class="paramname"><em>channel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; uint8_t &gt; &amp;&#160;</td>
          <td class="paramname"><em>buffer</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>flags</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;{</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    int32_t nbytes;</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <span class="keywordflow">if</span> ((nbytes = sendto(channel.<a class="code" href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">cudp</a>, (<span class="keywordtype">char</span> *)<a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.data(), <a class="code" href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a>.size(), flags, (<span class="keyword">struct </span>sockaddr *)&amp;channel.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, (socklen_t)channel.<a class="code" href="structsocket__channel.html#ac8d281058a9bb5c8ac7d12e00e800ba5">addrlen</a>)) &lt; 0)</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    {</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        nbytes = -errno;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    }</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">return</span> nbytes;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div><div class="ttc" id="structsocket__channel_html_ab3e41f03ddf5695db099e8d7db507fd2"><div class="ttname"><a href="structsocket__channel.html#ab3e41f03ddf5695db099e8d7db507fd2">socket_channel::cudp</a></div><div class="ttdeci">int32_t cudp</div><div class="ttdef"><b>Definition:</b> socketlib.h:120</div></div>
<div class="ttc" id="propagator__simple_8cpp_html_aefc66c7c76cac6590187a1f7afb99cd9"><div class="ttname"><a href="propagator__simple_8cpp.html#aefc66c7c76cac6590187a1f7afb99cd9">buffer</a></div><div class="ttdeci">char buffer[255]</div><div class="ttdef"><b>Definition:</b> propagator_simple.cpp:60</div></div>
<div class="ttc" id="structsocket__channel_html_a8d2c39afd45c287064229be41dfea731"><div class="ttname"><a href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">socket_channel::caddr</a></div><div class="ttdeci">struct sockaddr_in caddr</div><div class="ttdef"><b>Definition:</b> socketlib.h:122</div></div>
<div class="ttc" id="structsocket__channel_html_ac8d281058a9bb5c8ac7d12e00e800ba5"><div class="ttname"><a href="structsocket__channel.html#ac8d281058a9bb5c8ac7d12e00e800ba5">socket_channel::addrlen</a></div><div class="ttdeci">int addrlen</div><div class="ttdef"><b>Definition:</b> socketlib.h:128</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga9e02d25f0adbe973a9242387d362c531"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="structsocket__channel.html">socket_channel</a>&gt; socket_find_addresses </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="group__socketlib__constants.html#gac3df430da2e0e847835025092b9dfdcf">NetworkType</a>&#160;</td>
          <td class="paramname"><em>ntype</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Discover interfaces. </p>
<p>Return a vector of <a class="el" href="structsocket__channel.html">socket_channel</a> containing info on each valid interface. For IPV4 this will include the address and broadcast address, in both string sockaddr_in format. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">ntype</td><td>Type of network (Multicast, Broadcast UDP, CSP) </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Vector of interfaces </dd></dl>
<div class="fragment"><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;{</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    vector&lt;socket_channel&gt; iface;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="structsocket__channel.html">socket_channel</a> tiface;</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    INTERFACE_INFO ilist[20];</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">long</span> nbytes;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    uint32_t nif;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    uint32_t ip, net, bcast;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <span class="keyword">struct </span>ifconf confa;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <span class="keyword">struct </span>ifreq *ifra;</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordtype">char</span> data[512];</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;<span class="preprocessor">#endif // COSMOS_WIN_OS</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    <span class="keywordtype">int</span> on = 1;</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    int32_t cudp;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="keywordflow">switch</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>)</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    {</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>:</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="keywordflow">case</span> <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9">NetworkType::UDP</a>:</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;        {</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            <span class="keywordflow">if</span> ((cudp=socket(AF_INET,SOCK_DGRAM,0)) &lt; 0)</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;            {</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;                <span class="keywordflow">return</span> (iface);</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;            }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;            <span class="comment">// Use above socket to find available interfaces and establish</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;            <span class="comment">// publication on each.</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;<span class="preprocessor">#ifdef COSMOS_WIN_OS</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="keywordflow">if</span> (WSAIoctl(cudp, SIO_GET_INTERFACE_LIST, 0, 0, &amp;ilist,<span class="keyword">sizeof</span>(ilist), &amp;nbytes, 0, 0) == SOCKET_ERROR)</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;                CLOSE_SOCKET(cudp);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;                <span class="keywordflow">return</span> (iface);</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;            nif = nbytes / <span class="keyword">sizeof</span>(INTERFACE_INFO);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            PIP_ADAPTER_ADDRESSES pAddresses = NULL;</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            PIP_ADAPTER_ADDRESSES pCurrAddresses = NULL;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            pAddresses = (IP_ADAPTER_ADDRESSES *) calloc(<span class="keyword">sizeof</span>(IP_ADAPTER_ADDRESSES), 2*nif);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;            ULONG outBufLen = <span class="keyword">sizeof</span>(IP_ADAPTER_ADDRESSES) * 2 * nif;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            DWORD dwRetVal;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <span class="keywordflow">if</span> ((dwRetVal=GetAdaptersAddresses(AF_INET, GAA_FLAG_INCLUDE_PREFIX, NULL, pAddresses, &amp;outBufLen)) == ERROR_BUFFER_OVERFLOW)</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            {</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;                free(pAddresses);</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;                <span class="keywordflow">return</span> (iface);</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            }</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">for</span> (uint32_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;nif; <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>++)</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;                inet_ntop(ilist[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].iiAddress.AddressIn.sin_family,&amp;ilist[i].iiAddress.AddressIn.sin_addr,tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>,<span class="keyword">sizeof</span>(tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>));</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;                <span class="comment">//          strncpy(tiface.address, inet_ntoa(((struct sockaddr_in*)&amp;(ilist[i].iiAddress))-&gt;sin_addr), 17);</span></div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;                <span class="keywordflow">if</span> (!strcmp(tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>,<span class="stringliteral">&quot;127.0.0.1&quot;</span>))</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                {</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                    <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;                }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;                pCurrAddresses = pAddresses;</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;                <span class="keywordflow">while</span> (pAddresses)</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;                {</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;                    <span class="keywordflow">if</span> (((<span class="keyword">struct</span> sockaddr_in *)(pCurrAddresses-&gt;FirstUnicastAddress-&gt;Address.lpSockaddr))-&gt;sin_addr.s_addr == ((<span class="keyword">struct</span> sockaddr_in*)&amp;(ilist[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].iiAddress))-&gt;sin_addr.s_addr)</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                    {</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;                        strcpy(tiface.<a class="code" href="structsocket__channel.html#a836ae926c4f4de45aabbacade23f5642">name</a>, pCurrAddresses-&gt;AdapterName);</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                    }</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;                    pCurrAddresses = pCurrAddresses-&gt;Next;</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;                }</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;                memset(&amp;tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>,0,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;                memset(&amp;tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>,0,<span class="keyword">sizeof</span>(<span class="keyword">struct</span> sockaddr_in));</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;                tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_family = AF_INET;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;                tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_family = AF_INET;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a> == <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>)</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                {</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;                    inet_pton(AF_INET,(<span class="keywordtype">char</span> *)<a class="code" href="group__defs__node__type.html#ga34346fcf3728cdc93b3cbbbdfd9fc679">COSMOSMCAST</a>,&amp;tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                    inet_pton(AF_INET,(<span class="keywordtype">char</span> *)<a class="code" href="group__defs__node__type.html#ga34346fcf3728cdc93b3cbbbdfd9fc679">COSMOSMCAST</a>,&amp;tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;                    <span class="comment">//              struct sockaddr_storage ss;</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;                    <span class="comment">//              int sslen;</span></div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;                    <span class="comment">//              sslen = sizeof(ss);</span></div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;                    <span class="comment">//              WSAStringToAddressA((char *)COSMOSMCAST,AF_INET,NULL,(struct sockaddr*)&amp;ss,&amp;sslen);</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;                    <span class="comment">//              tiface.caddr.sin_addr = ((struct sockaddr_in *)&amp;ss)-&gt;sin_addr;</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;                    <span class="comment">//              tiface.baddr.sin_addr = ((struct sockaddr_in *)&amp;ss)-&gt;sin_addr;</span></div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                }</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;                {</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;                    <span class="keywordflow">if</span> ((iretn = setsockopt(cudp,SOL_SOCKET,SO_BROADCAST,(<span class="keywordtype">char</span>*)&amp;on,<span class="keyword">sizeof</span>(on))) &lt; 0)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;                    {</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;                    }</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;                    ip = ((<span class="keyword">struct </span>sockaddr_in*)&amp;(ilist[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].iiAddress))-&gt;sin_addr.S_un.S_addr;</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                    net = ((<span class="keyword">struct</span> sockaddr_in*)&amp;(ilist[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].iiNetmask))-&gt;sin_addr.S_un.S_addr;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                    bcast = ip | (~net);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                    tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr = ((<span class="keyword">struct </span>sockaddr_in *)&amp;ilist[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].iiAddress)-&gt;sin_addr;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                    tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr.S_un.S_addr = ip;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                    tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr = ((<span class="keyword">struct </span>sockaddr_in *)&amp;ilist[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].iiAddress)-&gt;sin_addr;</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                    tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr.S_un.S_addr = bcast;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                <span class="comment">//          struct sockaddr_storage ss;</span></div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;                <span class="comment">//          ((struct sockaddr_in *)&amp;ss)-&gt;sin_addr = tiface.caddr.sin_addr;</span></div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                <span class="comment">//          ssize = strlen(tiface.address);</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;                <span class="comment">//          WSAAddressToStringA((struct sockaddr *)&amp;tiface.caddr.sin_addr, sizeof(struct sockaddr_in), 0, tiface.address, (LPDWORD)&amp;ssize);</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;                inet_ntop(tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_family,&amp;tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr,tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>,<span class="keyword">sizeof</span>(tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>));</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;                <span class="comment">//          ssize = strlen(tiface.baddress);</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;                <span class="comment">//          WSAAddressToStringA((struct sockaddr *)&amp;tiface.baddr.sin_addr, sizeof(struct sockaddr_in), 0, tiface.baddress, (LPDWORD)&amp;ssize);</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;                inet_ntop(tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_family,&amp;tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr,tiface.<a class="code" href="structsocket__channel.html#a8beda6761b464bb7408c385b7f5213e7">baddress</a>,<span class="keyword">sizeof</span>(tiface.<a class="code" href="structsocket__channel.html#a8beda6761b464bb7408c385b7f5213e7">baddress</a>));</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                tiface.<a class="code" href="structsocket__channel.html#addb1179eeaf45b16e3cb91eb02821826">type</a> = <a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;                iface.push_back(tiface);</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;            confa.ifc_len = <span class="keyword">sizeof</span>(data);</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;            confa.ifc_buf = (caddr_t)data;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;            <span class="keywordflow">if</span> (ioctl(cudp,SIOCGIFCONF,&amp;confa) &lt; 0)</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            {</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;                CLOSE_SOCKET(cudp);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;                <span class="keywordflow">return</span> (iface);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;            }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;            <span class="comment">// Use result to discover interfaces.</span></div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;            ifra = confa.ifc_req;</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;            <span class="keywordflow">for</span> (int32_t n=confa.ifc_len/<span class="keyword">sizeof</span>(<span class="keyword">struct</span> ifreq); --n &gt;= 0; ifra++)</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;                <span class="keywordflow">if</span> (ifra-&gt;ifr_addr.sa_family != AF_INET) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;                inet_ntop(ifra-&gt;ifr_addr.sa_family,&amp;((<span class="keyword">struct</span> sockaddr_in*)&amp;ifra-&gt;ifr_addr)-&gt;sin_addr,tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>,<span class="keyword">sizeof</span>(tiface.<a class="code" href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">address</a>));</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="keywordflow">if</span> (ioctl(cudp,SIOCGIFFLAGS, (<span class="keywordtype">char</span> *)ifra) &lt; 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <span class="keywordflow">if</span> ((ifra-&gt;ifr_flags &amp; IFF_UP) == 0 || (ifra-&gt;ifr_flags &amp; IFF_LOOPBACK) || (ifra-&gt;ifr_flags &amp; (IFF_BROADCAST)) == 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="keywordflow">if</span> (<a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a> == <a class="code" href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a>)</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                {</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                    inet_pton(AF_INET,<a class="code" href="group__defs__node__type.html#ga34346fcf3728cdc93b3cbbbdfd9fc679">COSMOSMCAST</a>,&amp;tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>.sin_addr);\</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                    strncpy(tiface.<a class="code" href="structsocket__channel.html#a8beda6761b464bb7408c385b7f5213e7">baddress</a>, <a class="code" href="group__defs__node__type.html#ga34346fcf3728cdc93b3cbbbdfd9fc679">COSMOSMCAST</a>, 17);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                    inet_pton(AF_INET,<a class="code" href="group__defs__node__type.html#ga34346fcf3728cdc93b3cbbbdfd9fc679">COSMOSMCAST</a>,&amp;tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr);\</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;                    <span class="keywordflow">if</span> ((iretn = setsockopt(cudp,SOL_SOCKET,SO_BROADCAST,(<span class="keywordtype">char</span>*)&amp;on,<span class="keyword">sizeof</span>(on))) &lt; 0)</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;                    {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                        <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                    strncpy(tiface.<a class="code" href="structsocket__channel.html#a836ae926c4f4de45aabbacade23f5642">name</a>, ifra-&gt;ifr_name, <a class="code" href="group__defs__storage.html#ga2005202dc256c47dd66042b748fc4dd5">COSMOS_MAX_NAME</a>);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                    <span class="keywordflow">if</span> (ioctl(cudp,SIOCGIFBRDADDR,(<span class="keywordtype">char</span> *)ifra) &lt; 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                    memcpy((<span class="keywordtype">char</span> *)&amp;tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>, (<span class="keywordtype">char</span> *)&amp;ifra-&gt;ifr_broadaddr, <span class="keyword">sizeof</span>(ifra-&gt;ifr_broadaddr));</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                    <span class="keywordflow">if</span> (ioctl(cudp,SIOCGIFADDR,(<span class="keywordtype">char</span> *)ifra) &lt; 0) <span class="keywordflow">continue</span>;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                    memcpy((<span class="keywordtype">char</span> *)&amp;tiface.<a class="code" href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">caddr</a>, (<span class="keywordtype">char</span> *)&amp;ifra-&gt;ifr_addr, <span class="keyword">sizeof</span>(ifra-&gt;ifr_addr));</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                    inet_ntop(tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_family,&amp;tiface.<a class="code" href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">baddr</a>.sin_addr,tiface.<a class="code" href="structsocket__channel.html#a8beda6761b464bb7408c385b7f5213e7">baddress</a>,<span class="keyword">sizeof</span>(tiface.<a class="code" href="structsocket__channel.html#a8beda6761b464bb7408c385b7f5213e7">baddress</a>));</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;                }</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                tiface.<a class="code" href="structsocket__channel.html#addb1179eeaf45b16e3cb91eb02821826">type</a> = <a class="code" href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                iface.push_back(tiface);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;            }</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;<span class="preprocessor">#endif // COSMOS_WIN_OS</span></div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;        }</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    }</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    <span class="keywordflow">return</span> (iface);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;}</div><div class="ttc" id="group__socketlib__constants_html_ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9"><div class="ttname"><a href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfaf5ef036b4d8b630721e51fe23489fbc9">NetworkType::UDP</a></div><div class="ttdoc">Agent socket using Unicast UDP. </div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__defs__storage_html_ga2005202dc256c47dd66042b748fc4dd5"><div class="ttname"><a href="group__defs__storage.html#ga2005202dc256c47dd66042b748fc4dd5">COSMOS_MAX_NAME</a></div><div class="ttdeci">#define COSMOS_MAX_NAME</div><div class="ttdoc">Largest JSON name. </div><div class="ttdef"><b>Definition:</b> cosmos-defs.h:55</div></div>
<div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structsocket__channel_html_a010577b917edde7e3d2780ddac8d6cd9"><div class="ttname"><a href="structsocket__channel.html#a010577b917edde7e3d2780ddac8d6cd9">socket_channel::baddr</a></div><div class="ttdeci">struct sockaddr_in baddr</div><div class="ttdef"><b>Definition:</b> socketlib.h:124</div></div>
<div class="ttc" id="structsocket__channel_html_a5fc746e018706be753d291638f7baddb"><div class="ttname"><a href="structsocket__channel.html#a5fc746e018706be753d291638f7baddb">socket_channel::address</a></div><div class="ttdeci">char address[17]</div><div class="ttdef"><b>Definition:</b> socketlib.h:134</div></div>
<div class="ttc" id="structsocket__channel_html_a836ae926c4f4de45aabbacade23f5642"><div class="ttname"><a href="structsocket__channel.html#a836ae926c4f4de45aabbacade23f5642">socket_channel::name</a></div><div class="ttdeci">char name[COSMOS_MAX_NAME+1]</div><div class="ttdef"><b>Definition:</b> socketlib.h:138</div></div>
<div class="ttc" id="structsocket__channel_html_addb1179eeaf45b16e3cb91eb02821826"><div class="ttname"><a href="structsocket__channel.html#addb1179eeaf45b16e3cb91eb02821826">socket_channel::type</a></div><div class="ttdeci">NetworkType type</div><div class="ttdef"><b>Definition:</b> socketlib.h:118</div></div>
<div class="ttc" id="group__defs__node__type_html_ga34346fcf3728cdc93b3cbbbdfd9fc679"><div class="ttname"><a href="group__defs__node__type.html#ga34346fcf3728cdc93b3cbbbdfd9fc679">COSMOSMCAST</a></div><div class="ttdeci">#define COSMOSMCAST</div><div class="ttdoc">COSMOS heartbeat Multicast address. </div><div class="ttdef"><b>Definition:</b> cosmos-defs.h:253</div></div>
<div class="ttc" id="structsocket__channel_html"><div class="ttname"><a href="structsocket__channel.html">socket_channel</a></div><div class="ttdef"><b>Definition:</b> socketlib.h:115</div></div>
<div class="ttc" id="structsocket__channel_html_a8d2c39afd45c287064229be41dfea731"><div class="ttname"><a href="structsocket__channel.html#a8d2c39afd45c287064229be41dfea731">socket_channel::caddr</a></div><div class="ttdeci">struct sockaddr_in caddr</div><div class="ttdef"><b>Definition:</b> socketlib.h:122</div></div>
<div class="ttc" id="agent__node_8cpp_html_a8dadfa60d80a481745f0212f7caec1e7"><div class="ttname"><a href="agent__node_8cpp.html#a8dadfa60d80a481745f0212f7caec1e7">ntype</a></div><div class="ttdeci">NetworkType ntype</div><div class="ttdef"><b>Definition:</b> agent_node.cpp:51</div></div>
<div class="ttc" id="group__socketlib__constants_html_ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32"><div class="ttname"><a href="group__socketlib__constants.html#ggac3df430da2e0e847835025092b9dfdcfa8e919d17ef085bfa7f29765019241f32">NetworkType::MULTICAST</a></div><div class="ttdoc">Agent socket using Multicast UDP. </div></div>
<div class="ttc" id="structsocket__channel_html_a8beda6761b464bb7408c385b7f5213e7"><div class="ttname"><a href="structsocket__channel.html#a8beda6761b464bb7408c385b7f5213e7">socket_channel::baddress</a></div><div class="ttdeci">char baddress[17]</div><div class="ttdef"><b>Definition:</b> socketlib.h:136</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Oct 4 2020 00:17:39 for COSMOS core by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
