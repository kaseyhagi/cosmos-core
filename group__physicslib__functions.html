<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>COSMOS core: Physics Library functions</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="logo80.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">COSMOS core
   &#160;<span id="projectnumber">1.0.2 (beta)</span>
   </div>
   <div id="projectbrief">Comprehensive Open-architecture Solution for Mission Operations Systems</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li class="current"><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('group__physicslib__functions.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">Physics Library functions<div class="ingroups"><a class="el" href="group__libraries.html">API libraries</a> &raquo; <a class="el" href="group__support.html">Support Libraries</a> &raquo; <a class="el" href="group__physicslib.html">Physics Simulation Library</a></div></div>  </div>
</div><!--header-->
<div class="contents">
<div class="dynheader">
Collaboration diagram for Physics Library functions:</div>
<div class="dyncontent">
<center><table><tr><td><div class="center"><iframe scrolling="no" frameborder="0" src="group__physicslib__functions.svg" width="363" height="52"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
</td></tr></table></center>
</div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ga259deeced13ac50d8a42178d6bd5e91c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga259deeced13ac50d8a42178d6bd5e91c">pleph_</a> (double[], long *, long *, double[])</td></tr>
<tr class="separator:ga259deeced13ac50d8a42178d6bd5e91c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaf67fdd1cb4bdcedc283f9286816e2ac0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gaf67fdd1cb4bdcedc283f9286816e2ac0">dpleph_</a> (double[], long *, long *, double[])</td></tr>
<tr class="separator:gaf67fdd1cb4bdcedc283f9286816e2ac0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga0cc6928ba95a9d3f1fede0e6f2b45bc7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrvector.html">rvector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga0cc6928ba95a9d3f1fede0e6f2b45bc7">gravity_vector</a> (<a class="el" href="structsvector.html">svector</a> pos, int model, uint32_t degree)</td></tr>
<tr class="separator:ga0cc6928ba95a9d3f1fede0e6f2b45bc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga22eaa0a9f09761feefcfcbbc6ca4b907"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a> (double lon, double lat, double r, int model, uint32_t degree)</td></tr>
<tr class="separator:ga22eaa0a9f09761feefcfcbbc6ca4b907"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5331c107173baab1128d6db147e4e03d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrvector.html">rvector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga5331c107173baab1128d6db147e4e03d">gravity_accel</a> (<a class="el" href="structposstruc.html">posstruc</a> pos, int model, uint32_t degree)</td></tr>
<tr class="memdesc:ga5331c107173baab1128d6db147e4e03d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates geocentric acceleration vector from chosen model.  <a href="#ga5331c107173baab1128d6db147e4e03d">More...</a><br /></td></tr>
<tr class="separator:ga5331c107173baab1128d6db147e4e03d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad544fb0f9ecc7292d98efb86e8bd32ce"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structrvector.html">rvector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gad544fb0f9ecc7292d98efb86e8bd32ce">gravity_accel2</a> (<a class="el" href="structposstruc.html">posstruc</a> pos, int model, uint32_t degree)</td></tr>
<tr class="memdesc:gad544fb0f9ecc7292d98efb86e8bd32ce"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates geocentric acceleration vector from chosen model.  <a href="#gad544fb0f9ecc7292d98efb86e8bd32ce">More...</a><br /></td></tr>
<tr class="separator:gad544fb0f9ecc7292d98efb86e8bd32ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gadd6b74fb8263d68cf1ec4aca7991c039"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gadd6b74fb8263d68cf1ec4aca7991c039">gravity</a> (double radius, double colat, double elon, int model, uint32_t degree)</td></tr>
<tr class="memdesc:gadd6b74fb8263d68cf1ec4aca7991c039"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculates geocentric acceleration magnitude from chosen model.  <a href="#gadd6b74fb8263d68cf1ec4aca7991c039">More...</a><br /></td></tr>
<tr class="separator:gadd6b74fb8263d68cf1ec4aca7991c039"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gade5dfa05435c7c4171a8b73c5381f9d3"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a> (int model)</td></tr>
<tr class="memdesc:gade5dfa05435c7c4171a8b73c5381f9d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Gravitational model parameters.  <a href="#gade5dfa05435c7c4171a8b73c5381f9d3">More...</a><br /></td></tr>
<tr class="separator:gade5dfa05435c7c4171a8b73c5381f9d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaacf81e9dec5c0bde6fa3323c99aeb852"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gaacf81e9dec5c0bde6fa3323c99aeb852">nplgndr</a> (uint32_t l, uint32_t m, double x)</td></tr>
<tr class="memdesc:gaacf81e9dec5c0bde6fa3323c99aeb852"><td class="mdescLeft">&#160;</td><td class="mdescRight">Legendre polynomial.  <a href="#gaacf81e9dec5c0bde6fa3323c99aeb852">More...</a><br /></td></tr>
<tr class="separator:gaacf81e9dec5c0bde6fa3323c99aeb852"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga843a27228432f03296504441b64c680d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structsvector.html">svector</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga843a27228432f03296504441b64c680d">groundstation</a> (<a class="el" href="structlocstruc.html">locstruc</a> &amp;satellite, <a class="el" href="structlocstruc.html">locstruc</a> &amp;groundstation)</td></tr>
<tr class="memdesc:ga843a27228432f03296504441b64c680d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Ground station values.  <a href="#ga843a27228432f03296504441b64c680d">More...</a><br /></td></tr>
<tr class="separator:ga843a27228432f03296504441b64c680d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga78900b5c1c6d8ec1e0b248ff715ef968"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga78900b5c1c6d8ec1e0b248ff715ef968">simulate_hardware</a> (<a class="el" href="structcosmosstruc.html">cosmosstruc</a> *cinfo, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:ga78900b5c1c6d8ec1e0b248ff715ef968"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate all devices.  <a href="#ga78900b5c1c6d8ec1e0b248ff715ef968">More...</a><br /></td></tr>
<tr class="separator:ga78900b5c1c6d8ec1e0b248ff715ef968"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga75bef089c2786545431fb3033bbbc8b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a> (<a class="el" href="structcosmosstruc.html">cosmosstruc</a> *cinfo, vector&lt; <a class="el" href="structlocstruc.html">locstruc</a> &gt; &amp;locvec)</td></tr>
<tr class="memdesc:ga75bef089c2786545431fb3033bbbc8b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulate Hardware data - multiple.  <a href="#ga75bef089c2786545431fb3033bbbc8b1">More...</a><br /></td></tr>
<tr class="separator:ga75bef089c2786545431fb3033bbbc8b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga1922b090d2c47d135b29ca7d91de0030"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga1922b090d2c47d135b29ca7d91de0030">initialize_imu</a> (uint16_t index, <a class="el" href="structdevspecstruc.html">devspecstruc</a> &amp;devspec, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:ga1922b090d2c47d135b29ca7d91de0030"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize IMU simulation.  <a href="#ga1922b090d2c47d135b29ca7d91de0030">More...</a><br /></td></tr>
<tr class="separator:ga1922b090d2c47d135b29ca7d91de0030"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga5ba53cb5cf49f51c402a5418fd83405d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga5ba53cb5cf49f51c402a5418fd83405d">simulate_imu</a> (int index, <a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:ga5ba53cb5cf49f51c402a5418fd83405d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Simulated IMU values.  <a href="#ga5ba53cb5cf49f51c402a5418fd83405d">More...</a><br /></td></tr>
<tr class="separator:ga5ba53cb5cf49f51c402a5418fd83405d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga94983544dca7cd6b87c05c769ce62921"><td class="memItemLeft" align="right" valign="top">int32_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a> (<a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:ga94983544dca7cd6b87c05c769ce62921"><td class="mdescLeft">&#160;</td><td class="mdescRight">Acceleration.  <a href="#ga94983544dca7cd6b87c05c769ce62921">More...</a><br /></td></tr>
<tr class="separator:ga94983544dca7cd6b87c05c769ce62921"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae062777be16aa6b1810950abd2bccfef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a> (<a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:gae062777be16aa6b1810950abd2bccfef"><td class="mdescLeft">&#160;</td><td class="mdescRight">Torque.  <a href="#gae062777be16aa6b1810950abd2bccfef">More...</a><br /></td></tr>
<tr class="separator:gae062777be16aa6b1810950abd2bccfef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae6c163707315970f6172130774af2128"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gae6c163707315970f6172130774af2128">geod2icrf</a> (<a class="el" href="structposstruc.html">posstruc</a> *pos)</td></tr>
<tr class="memdesc:gae6c163707315970f6172130774af2128"><td class="mdescLeft">&#160;</td><td class="mdescRight">Geodetic to Heliocentric.  <a href="#gae6c163707315970f6172130774af2128">More...</a><br /></td></tr>
<tr class="separator:gae6c163707315970f6172130774af2128"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3834eb96d67f08087f079641924b1c50"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga3834eb96d67f08087f079641924b1c50">msis86_density</a> (<a class="el" href="structposstruc.html">posstruc</a> pos, float f107avg, float f107, float magidx)</td></tr>
<tr class="separator:ga3834eb96d67f08087f079641924b1c50"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaeb733b60ffc30cd2e2df172a398e59d3"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gaeb733b60ffc30cd2e2df172a398e59d3">msis00_density</a> (<a class="el" href="structposstruc.html">posstruc</a> pos, float f107avg, float f107, float magidx)</td></tr>
<tr class="memdesc:gaeb733b60ffc30cd2e2df172a398e59d3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate atmospheric density.  <a href="#gaeb733b60ffc30cd2e2df172a398e59d3">More...</a><br /></td></tr>
<tr class="separator:gaeb733b60ffc30cd2e2df172a398e59d3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga906fb239ba711fa8af6e8b6ea0e8a883"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga906fb239ba711fa8af6e8b6ea0e8a883">orbit_init_tle</a> (int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, <a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root)</td></tr>
<tr class="separator:ga906fb239ba711fa8af6e8b6ea0e8a883"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4be21934f3c809f9c40cc7afea6b8c7e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga4be21934f3c809f9c40cc7afea6b8c7e">orbit_init_eci</a> (int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, <a class="el" href="structcartpos.html">cartpos</a> ipos, <a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root)</td></tr>
<tr class="separator:ga4be21934f3c809f9c40cc7afea6b8c7e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad0f3968a46e0bf6bedfbc1cc59c9cceb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gad0f3968a46e0bf6bedfbc1cc59c9cceb">orbit_init_shape</a> (int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, double altitude, double angle, double hour, <a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root)</td></tr>
<tr class="separator:gad0f3968a46e0bf6bedfbc1cc59c9cceb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga45bb7ae9e9ec69a8f8bb1712445f479b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga45bb7ae9e9ec69a8f8bb1712445f479b">propagate</a> (<a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>)</td></tr>
<tr class="separator:ga45bb7ae9e9ec69a8f8bb1712445f479b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gaec4745d437b9d02cae7d4eb2708392b0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gaec4745d437b9d02cae7d4eb2708392b0">rearth</a> (double lat)</td></tr>
<tr class="separator:gaec4745d437b9d02cae7d4eb2708392b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga956263bca754093679747bc3d12b733d"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga956263bca754093679747bc3d12b733d">update_eci</a> (<a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root, double utc, <a class="el" href="structcartpos.html">cartpos</a> pos)</td></tr>
<tr class="separator:ga956263bca754093679747bc3d12b733d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga076acc0ac689c3de1a49720ec3fc5f76"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a> (<a class="el" href="structcosmosstruc.html">cosmosstruc</a> *cinfo, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:ga076acc0ac689c3de1a49720ec3fc5f76"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Hardware.  <a href="#ga076acc0ac689c3de1a49720ec3fc5f76">More...</a><br /></td></tr>
<tr class="separator:ga076acc0ac689c3de1a49720ec3fc5f76"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga8678ece24649523ac1139bc6072e28bd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, uint32_t order, double utc, double &amp;<a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>)</td></tr>
<tr class="memdesc:ga8678ece24649523ac1139bc6072e28bd"><td class="mdescLeft">&#160;</td><td class="mdescRight">Prepare for Gauss-Jackson integration.  <a href="#ga8678ece24649523ac1139bc6072e28bd">More...</a><br /></td></tr>
<tr class="separator:ga8678ece24649523ac1139bc6072e28bd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga33b927b611e398ea2f1a033df736eb3b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga33b927b611e398ea2f1a033df736eb3b">gauss_jackson_init_tle</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, uint32_t order, int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, <a class="el" href="structcosmosstruc.html">cosmosstruc</a> *cinfo)</td></tr>
<tr class="separator:ga33b927b611e398ea2f1a033df736eb3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga3ce1f727eca8b17340829870f3265f07"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga3ce1f727eca8b17340829870f3265f07">gauss_jackson_init_eci</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, uint32_t order, int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, <a class="el" href="structcartpos.html">cartpos</a> ipos, <a class="el" href="structqatt.html">qatt</a> iatt, <a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="memdesc:ga3ce1f727eca8b17340829870f3265f07"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize Gauss-Jackson orbit using ECI state vector.  <a href="#ga3ce1f727eca8b17340829870f3265f07">More...</a><br /></td></tr>
<tr class="separator:ga3ce1f727eca8b17340829870f3265f07"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gad4f9a6f69d513aacac201759e7ee33ad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gad4f9a6f69d513aacac201759e7ee33ad">gauss_jackson_init_stk</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, uint32_t order, int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, <a class="el" href="structstkstruc.html">stkstruc</a> &amp;<a class="el" href="testengine_8cpp.html#a035e9d7ab3c2ce9dfcce39629962c75b">stk</a>, <a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="separator:gad4f9a6f69d513aacac201759e7ee33ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:gae301914bfb352281d8bd8a0252e716db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#gae301914bfb352281d8bd8a0252e716db">gauss_jackson_init</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, uint32_t order, int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, double altitude, double angle, double hour, <a class="el" href="structlocstruc.html">locstruc</a> &amp;iloc, <a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc)</td></tr>
<tr class="separator:gae301914bfb352281d8bd8a0252e716db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga117e8280d2377a657c3648bc8c217967"><td class="memItemLeft" align="right" valign="top"><a class="el" href="structlocstruc.html">locstruc</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga117e8280d2377a657c3648bc8c217967">gauss_jackson_converge_orbit</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, <a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics)</td></tr>
<tr class="separator:ga117e8280d2377a657c3648bc8c217967"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga798e201a0205dabc1a938fb8ff09c496"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga798e201a0205dabc1a938fb8ff09c496">gauss_jackson_converge_hardware</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, <a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics)</td></tr>
<tr class="separator:ga798e201a0205dabc1a938fb8ff09c496"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga73a5d12a8fff794baaca9ee7e507719e"><td class="memItemLeft" align="right" valign="top">vector&lt; <a class="el" href="structlocstruc.html">locstruc</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga73a5d12a8fff794baaca9ee7e507719e">gauss_jackson_propagate</a> (<a class="el" href="structgj__handle.html">gj_handle</a> &amp;<a class="el" href="propagator_8cpp.html#a62ac77cebbf85451538d13fdd1e196cf">gjh</a>, <a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;physics, <a class="el" href="structlocstruc.html">locstruc</a> &amp;loc, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>)</td></tr>
<tr class="separator:ga73a5d12a8fff794baaca9ee7e507719e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga90c1cff517710673c6b13a284cb714ac"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga90c1cff517710673c6b13a284cb714ac">orbit_propagate</a> (<a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>)</td></tr>
<tr class="memdesc:ga90c1cff517710673c6b13a284cb714ac"><td class="mdescLeft">&#160;</td><td class="mdescRight">Load TLE's from file.  <a href="#ga90c1cff517710673c6b13a284cb714ac">More...</a><br /></td></tr>
<tr class="separator:ga90c1cff517710673c6b13a284cb714ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ga4a729180343719d08b86825e9b0dd0ee"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="group__physicslib__functions.html#ga4a729180343719d08b86825e9b0dd0ee">orbit_init</a> (int32_t mode, double <a class="el" href="agent__file4_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>, double <a class="el" href="udp__send_8cpp.html#ae2d93652b653a9f6c130719fe7693d66">mjd</a>, string ofile, <a class="el" href="structcosmosstruc.html">cosmosstruc</a> *root)</td></tr>
<tr class="memdesc:ga4a729180343719d08b86825e9b0dd0ee"><td class="mdescLeft">&#160;</td><td class="mdescRight">Initialize orbit from orbital data.  <a href="#ga4a729180343719d08b86825e9b0dd0ee">More...</a><br /></td></tr>
<tr class="separator:ga4a729180343719d08b86825e9b0dd0ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="ga259deeced13ac50d8a42178d6bd5e91c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void pleph_ </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gaf67fdd1cb4bdcedc283f9286816e2ac0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void dpleph_ </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">long *&#160;</td>
          <td class="paramname">, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname">[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga0cc6928ba95a9d3f1fede0e6f2b45bc7"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrvector.html">rvector</a> gravity_vector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structsvector.html">svector</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>degree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;{</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keywordtype">double</span> gp, <a class="code" href="nrlmsise-00_8cpp.html#adb43b07f5b513c1fc160ad8e49e91468">g0</a>, gm;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> tloc;</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <a class="code" href="structrvector.html">rvector</a> gvec;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="comment">// Calculate potential and geocentric equivalent of position</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    g0 = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(pos.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,pos.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,pos.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a> = pos;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga4fc0fe983080d25f5baec2a88ad0bfab">pos_geos2geoc</a>(&amp;tloc);</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    gvec = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;</div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// Difference in X direction</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] -= .5;</div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a>(&amp;tloc);</div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    gm = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += 1.;</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a>(&amp;tloc);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    gp = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    gvec.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = (gp-gm);</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] -= .5;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="comment">// Difference in Y direction</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] -= .5;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a>(&amp;tloc);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    gm = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += 1.;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a>(&amp;tloc);</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    gp = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;    gvec.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = (gp-gm);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] -= .5;</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    <span class="comment">// Difference in Z direction</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] -= .5;</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a>(&amp;tloc);</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;    gm = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += 1.;</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a>(&amp;tloc);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;    gp = <a class="code" href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a>(tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,model,degree);</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;    gvec.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] = (gp-gm);</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] -= .5;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;    gvec = <a class="code" href="group__mathlib__functions.html#ga96fa91f1abd117f5be88a54d1104822a">rv_normal</a>(gvec);</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;    gvec = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(g0,gvec);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    <span class="keywordflow">return</span> (gvec);</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;}</div><div class="ttc" id="structspherpos_html_ad2978f8e060c698806bb76a9185e55f4"><div class="ttname"><a href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">spherpos::s</a></div><div class="ttdeci">svector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:218</div></div>
<div class="ttc" id="structsvector_html_ae4bb8de86cd498d896a3a50c76d34041"><div class="ttname"><a href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">svector::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">E/W in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:97</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structposstruc_html_ab9915207eb8422ed2853bc16f0914c50"><div class="ttname"><a href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">posstruc::geos</a></div><div class="ttdeci">spherpos geos</div><div class="ttdef"><b>Definition:</b> convertdef.h:402</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="nrlmsise-00_8cpp_html_adb43b07f5b513c1fc160ad8e49e91468"><div class="ttname"><a href="nrlmsise-00_8cpp.html#adb43b07f5b513c1fc160ad8e49e91468">g0</a></div><div class="ttdeci">__inline_double g0(double a, double *p)</div><div class="ttdef"><b>Definition:</b> nrlmsise-00.cpp:613</div></div>
<div class="ttc" id="structsvector_html_ad0d07f026eebc5248d4404a2d56aab15"><div class="ttname"><a href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">svector::phi</a></div><div class="ttdeci">double phi</div><div class="ttdoc">N/S in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:95</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga96fa91f1abd117f5be88a54d1104822a"><div class="ttname"><a href="group__mathlib__functions.html#ga96fa91f1abd117f5be88a54d1104822a">rv_normal</a></div><div class="ttdeci">rvector rv_normal(rvector v)</div><div class="ttdoc">Normalize row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:212</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4fc0fe983080d25f5baec2a88ad0bfab"><div class="ttname"><a href="group__convertlib__functions.html#ga4fc0fe983080d25f5baec2a88ad0bfab">pos_geos2geoc</a></div><div class="ttdeci">int32_t pos_geos2geoc(locstruc *loc)</div><div class="ttdoc">Convert GEOS to GEOC. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1036</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga22eaa0a9f09761feefcfcbbc6ca4b907"><div class="ttname"><a href="group__physicslib__functions.html#ga22eaa0a9f09761feefcfcbbc6ca4b907">gravity_potential</a></div><div class="ttdeci">double gravity_potential(double lambda, double phi, double r, int model, uint32_t degree)</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:605</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8846d240e716b8e6cc6364674daaf540"><div class="ttname"><a href="group__convertlib__functions.html#ga8846d240e716b8e6cc6364674daaf540">pos_geoc2geos</a></div><div class="ttdeci">int32_t pos_geoc2geos(locstruc *loc)</div><div class="ttdoc">Convert GEOC to GEOS. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:972</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="structsvector_html_acb2e6b4694745ef3cf790e806b7217fa"><div class="ttname"><a href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">svector::r</a></div><div class="ttdeci">double r</div><div class="ttdoc">Radius in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:99</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga22eaa0a9f09761feefcfcbbc6ca4b907"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gravity_potential </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>r</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>degree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;{</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keyword">register</span> uint32_t il, im;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <span class="keywordtype">double</span> slat;</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordtype">double</span> v, v1, v2, vm, <a class="code" href="nrlmsise-00_8cpp.html#ae88729d6c4d0930c73a130b2a9b9407c">plg</a>, ilon;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;    <span class="keywordtype">double</span> clon[<a class="code" href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a>+1], slon[<a class="code" href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a>+1];</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="comment">// Load Params</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a>(model);</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;    <span class="keywordflow">if</span> (lambda &lt; 0.)</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        lambda += <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;    v = v1 = v2 = 0.;</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;    slat = sin(phi);</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;    ilon = 0.;</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;    <span class="keywordflow">for</span> (im=0; im&lt;=degree; im++)</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    {</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        clon[im] = cos(ilon);</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        slon[im] = sin(ilon);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        ilon += lambda;</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">if</span> (ilon &gt;= <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            ilon -= <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    }</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <span class="keywordflow">for</span> (il=2; il&lt;=degree; il++)</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    {</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;        vm = 0.;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;        <span class="keywordflow">for</span> (im=0; im&lt;=il; im++)</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;            plg = <a class="code" href="group__physicslib__functions.html#gaacf81e9dec5c0bde6fa3323c99aeb852">nplgndr</a>(il,im,slat);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            vm += (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0]*clon[im] + <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1]*slon[im]) * plg;</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        }</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        v += (il+1) * vm * pow((<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>/(r)),(<span class="keywordtype">double</span>)il);</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    }</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    v += 1;</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;    v *= -<a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a> / (r*r);</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <span class="keywordflow">return</span> (v);</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;}</div><div class="ttc" id="group__physicslib__functions_html_gaacf81e9dec5c0bde6fa3323c99aeb852"><div class="ttname"><a href="group__physicslib__functions.html#gaacf81e9dec5c0bde6fa3323c99aeb852">nplgndr</a></div><div class="ttdeci">double nplgndr(uint32_t l, uint32_t m, double x)</div><div class="ttdoc">Legendre polynomial. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:791</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga225f033481a4247d0a2853d327cc6f65"><div class="ttname"><a href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a></div><div class="ttdeci">#define GM</div><div class="ttdoc">SI Mass * Gravitational Constant for Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:79</div></div>
<div class="ttc" id="physicslib_8cpp_html_a28de1fdb662726490fbc07bcf561d9bd"><div class="ttname"><a href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a></div><div class="ttdeci">static double coef[360+1][360+1][2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:39</div></div>
<div class="ttc" id="nrlmsise-00_8cpp_html_ae88729d6c4d0930c73a130b2a9b9407c"><div class="ttname"><a href="nrlmsise-00_8cpp.html#ae88729d6c4d0930c73a130b2a9b9407c">plg</a></div><div class="ttdeci">static double plg[4][9]</div><div class="ttdef"><b>Definition:</b> nrlmsise-00.cpp:99</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="physicslib_8cpp_html_ab5cb235739ef02cfcc5755c92758b625"><div class="ttname"><a href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a></div><div class="ttdeci">#define MAXDEGREE</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:34</div></div>
<div class="ttc" id="group__physicslib__functions_html_gade5dfa05435c7c4171a8b73c5381f9d3"><div class="ttname"><a href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a></div><div class="ttdeci">int32_t gravity_params(int model)</div><div class="ttdoc">Gravitational model parameters. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:699</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5331c107173baab1128d6db147e4e03d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrvector.html">rvector</a> gravity_accel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structposstruc.html">posstruc</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>degree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates geocentric acceleration vector from chosen model. </p>
<p>Calculates geocentric acceleration vector from chosen model.</p>
<p>Calculates a spherical harmonic expansion of the chosen model of indicated order and degree for the requested position. The result is returned as a geocentric vector calculated at the epoch. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>a <a class="el" href="structposstruc.html">posstruc</a> providing the position at the epoch </td></tr>
    <tr><td class="paramname">model</td><td>Model to use for coefficients </td></tr>
    <tr><td class="paramname">degree</td><td>Order and degree to calculate </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>A <a class="el" href="structrvector.html" title="3 element generic row vector ">rvector</a> pointing toward the earth </dd></dl>
<dl class="section see"><dt>See also</dt><dd>pgm2000a_coef.txt </dd></dl>
<div class="fragment"><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;{</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    <span class="keyword">register</span> uint32_t il, im;</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="comment">//  double dlat, dlon;</span></div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <span class="keywordtype">double</span> tmult;</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <span class="comment">//double ratio, rratio, xratio, yratio, zratio, vc[MAXDEGREE+1][MAXDEGREE+1], wc[MAXDEGREE+1][MAXDEGREE+1];</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;    <span class="keywordtype">double</span> ratio, rratio, xratio, yratio, zratio;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    <a class="code" href="structrvector.html">rvector</a> accel;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;    <span class="keywordtype">double</span> fr;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">//double dc[5][4], ds[5][4];</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="comment">//static double co[5][4][2] = {{{-9999.}}};</span></div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;    <span class="comment">// Zero out vc and wc</span></div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    memset(<a class="code" href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a>));</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    memset(<a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>,0,<span class="keyword">sizeof</span>(<a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>));</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;    <span class="comment">// Load Params</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;    <a class="code" href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a>(model);</div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment">if (co[0][0][0] == -9999.)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;<span class="comment">    {</span></div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;<span class="comment">    for (il=0; il&lt;5; il++)</span></div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;<span class="comment">        {</span></div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;<span class="comment">        for (im=0; im&lt;4; im++)</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;<span class="comment">            {</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;<span class="comment">            co[il][im][0] = coef[il][im][0];</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;<span class="comment">            co[il][im][1] = coef[il][im][1];</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;<span class="comment">            }</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;<span class="comment">SolidTide(pos,dc,ds);</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="comment">for (il=0; il&lt;5; il++)</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">    {</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;<span class="comment">    for (im=0; im&lt;4; im++)</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;<span class="comment">        {</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="comment">        coef[il][im][0] = co[il][im][0] + dc[il][im];</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="comment">        coef[il][im][1] = co[il][im][1] + ds[il][im];</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;<span class="comment">        }</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">    }</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;    <span class="comment">// Calculate cartesian Legendre terms</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;    <a class="code" href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a>[0][0] = <a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>/pos.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[0][0] = 0.;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;    ratio = <a class="code" href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a>[0][0] / pos.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    rratio = <a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a> * ratio;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    xratio = pos.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] * ratio;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    yratio = pos.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] * ratio;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    zratio = pos.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] * ratio;</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a>[1][0] = zratio * <a class="code" href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a>[0][0];</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[1][0] = 0.;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;    <span class="keywordflow">for</span> (il=2; il&lt;=degree+1; il++)</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    {</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        vc[il][0] = (2*il-1)*zratio * vc[il-1][0] / il - (il-1) * rratio * vc[il-2][0] / il;</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[il][0] = 0.;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;    <span class="keywordflow">for</span> (im=1; im&lt;=degree+1; im++)</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    {</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        vc[im][im] = (2*im-1) * (xratio * vc[im-1][im-1] - yratio * <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[im-1][im-1]);</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[im][im] = (2*im-1) * (xratio * <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[im-1][im-1] + yratio * vc[im-1][im-1]);</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;        <span class="keywordflow">if</span> (im &lt;= degree)</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;        {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;            vc[im+1][im] = (2*im+1) * zratio * vc[im][im];</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;            <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[im+1][im] = (2*im+1) * zratio * <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[im][im];</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;        }</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">for</span> (il=im+2; il&lt;=degree+1; il++)</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        {</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;            vc[il][im] = (2*il-1) * zratio * vc[il-1][im] / (il-im) - (il+im-1) * rratio * vc[il-2][im] / (il-im);</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;            <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[il][im] = (2*il-1) * zratio * <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[il-1][im] / (il-im) - (il+im-1) * rratio * <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[il-2][im] / (il-im);</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        }</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    }</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">//  dr = dlon = dlat = 0.;</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    accel = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    <span class="keywordflow">for</span> (im=0; im&lt;=degree; im++)</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    {</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">for</span> (il=im; il&lt;=degree; il++)</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        {</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;            <span class="keywordflow">if</span> (im == 0)</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;            {</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] -= <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][0][0] * vc[il+1][1];</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;                accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] -= <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][0][0] * <a class="code" href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a>[il+1][1];</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] -= (il+1) * (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][0][0] * vc[il+1][0]);</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            }</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;            {</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                fr = <a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il-im+2] / <a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il-im];</div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] -= .5 * (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] * vc[il+1][im+1] + <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] * wc[il+1][im+1] - fr * (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] * vc[il+1][im-1] + <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] * wc[il+1][im-1]));</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] -= .5 * (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] * wc[il+1][im+1] - <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] * vc[il+1][im+1] + fr * (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] * wc[il+1][im-1] - <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] * vc[il+1][im-1]));</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] -= (il-im+1) * (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] * vc[il+1][im] + <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] * wc[il+1][im]);</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;            }</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;        }</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    }</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    tmult = <a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a> / (<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>*<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>);</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] *= tmult;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] *= tmult;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    accel.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] *= tmult;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <span class="keywordflow">return</span> (accel);</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;}</div><div class="ttc" id="structspherpos_html_ad2978f8e060c698806bb76a9185e55f4"><div class="ttname"><a href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">spherpos::s</a></div><div class="ttdeci">svector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:218</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa4123f65395b64643df676b28117f987"><div class="ttname"><a href="physicslib_8cpp.html#aa4123f65395b64643df676b28117f987">wc</a></div><div class="ttdeci">static double wc[360+1][360+1]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:52</div></div>
<div class="ttc" id="physicslib_8cpp_html_a6c50dd2a0963b2215bdf8ff9b776141a"><div class="ttname"><a href="physicslib_8cpp.html#a6c50dd2a0963b2215bdf8ff9b776141a">vc</a></div><div class="ttdeci">static double vc[360+1][360+1]</div><div class="ttdoc">Data structures for spherical harmonic expansion. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:52</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structposstruc_html_ab9915207eb8422ed2853bc16f0914c50"><div class="ttname"><a href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">posstruc::geos</a></div><div class="ttdeci">spherpos geos</div><div class="ttdef"><b>Definition:</b> convertdef.h:402</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga225f033481a4247d0a2853d327cc6f65"><div class="ttname"><a href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a></div><div class="ttdeci">#define GM</div><div class="ttdoc">SI Mass * Gravitational Constant for Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:79</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="physicslib_8cpp_html_a28de1fdb662726490fbc07bcf561d9bd"><div class="ttname"><a href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a></div><div class="ttdeci">static double coef[360+1][360+1][2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:39</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="structsvector_html_acb2e6b4694745ef3cf790e806b7217fa"><div class="ttname"><a href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">svector::r</a></div><div class="ttdeci">double r</div><div class="ttdoc">Radius in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:99</div></div>
<div class="ttc" id="group__physicslib__functions_html_gade5dfa05435c7c4171a8b73c5381f9d3"><div class="ttname"><a href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a></div><div class="ttdeci">int32_t gravity_params(int model)</div><div class="ttdoc">Gravitational model parameters. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:699</div></div>
<div class="ttc" id="physicslib_8cpp_html_a11f077d297fe211d9775f139a97c501d"><div class="ttname"><a href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a></div><div class="ttdeci">static double ftl[2 *360+1]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad544fb0f9ecc7292d98efb86e8bd32ce"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structrvector.html">rvector</a> gravity_accel2 </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structposstruc.html">posstruc</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>degree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates geocentric acceleration vector from chosen model. </p>
<div class="fragment"><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;{</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    <span class="keyword">register</span> uint32_t il, im;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordtype">double</span> slat;</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">double</span> v, v1, v2, vm, <a class="code" href="nrlmsise-00_8cpp.html#ae88729d6c4d0930c73a130b2a9b9407c">plg</a>, ilon;</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;    <span class="keywordtype">double</span> clon[<a class="code" href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a>+1], slon[<a class="code" href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a>+1];</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordtype">double</span> radius, colat, elon;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <a class="code" href="structrvector.html">rvector</a> accel1;</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>;</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="comment">// Load Params</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;    <a class="code" href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a>(model);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    radius = pos.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>;</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;    colat = pos.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    colat = pos.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    elon = pos.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a>;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    elon = pos.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a>;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">if</span> (elon &lt; 0.)</div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        elon += <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;    v = v1 = v2 = 0.;</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;    slat = sin(colat);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    ilon = 0.;</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    <span class="keywordflow">for</span> (im=0; im&lt;=degree; im++)</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        clon[im] = cos(ilon);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        slon[im] = sin(ilon);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        ilon += elon;</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;        <span class="keywordflow">if</span> (ilon &gt;= <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>)</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            ilon -= <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;    }</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;    <span class="keywordflow">for</span> (il=2; il&lt;=degree; il++)</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;        vm = 0.;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;        <span class="keywordflow">for</span> (im=0; im&lt;=il; im++)</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;        {</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            plg = <a class="code" href="group__physicslib__functions.html#gaacf81e9dec5c0bde6fa3323c99aeb852">nplgndr</a>(il,im,slat);</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;            vm += (<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0]*clon[im] + <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1]*slon[im]) * plg;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;        }</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;        v += (il+1) * vm * pow((<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>/(radius)),(<span class="keywordtype">double</span>)il);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    v += 1;</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    v *= -<a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a> / (radius*radius);</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;    sloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a> = pos;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    sloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> += .4448*(sloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> - sloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a>);</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga430f8894cf763422f41a8e057ed32c96">pos_geod2geoc</a>(&amp;sloc);</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    accel1 = sloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>;</div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;    <a class="code" href="group__mathlib__functions.html#ga806bbb4856e4ba2fed2cfcf81bf9650d">normalize_rv</a>(accel1);</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    accel1 = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(v,accel1);</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;    <span class="keywordflow">return</span> (accel1);</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div><div class="ttc" id="structspherpos_html_ad2978f8e060c698806bb76a9185e55f4"><div class="ttname"><a href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">spherpos::s</a></div><div class="ttdeci">svector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:218</div></div>
<div class="ttc" id="structsvector_html_ae4bb8de86cd498d896a3a50c76d34041"><div class="ttname"><a href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">svector::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">E/W in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:97</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structposstruc_html_ab9915207eb8422ed2853bc16f0914c50"><div class="ttname"><a href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">posstruc::geos</a></div><div class="ttdeci">spherpos geos</div><div class="ttdef"><b>Definition:</b> convertdef.h:402</div></div>
<div class="ttc" id="group__physicslib__functions_html_gaacf81e9dec5c0bde6fa3323c99aeb852"><div class="ttname"><a href="group__physicslib__functions.html#gaacf81e9dec5c0bde6fa3323c99aeb852">nplgndr</a></div><div class="ttdeci">double nplgndr(uint32_t l, uint32_t m, double x)</div><div class="ttdoc">Legendre polynomial. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:791</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga806bbb4856e4ba2fed2cfcf81bf9650d"><div class="ttname"><a href="group__mathlib__functions.html#ga806bbb4856e4ba2fed2cfcf81bf9650d">normalize_rv</a></div><div class="ttdeci">void normalize_rv(rvector &amp;v)</div><div class="ttdoc">Normalize row order vector in place. </div><div class="ttdef"><b>Definition:</b> vector.cpp:222</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga225f033481a4247d0a2853d327cc6f65"><div class="ttname"><a href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a></div><div class="ttdeci">#define GM</div><div class="ttdoc">SI Mass * Gravitational Constant for Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:79</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="structsvector_html_ad0d07f026eebc5248d4404a2d56aab15"><div class="ttname"><a href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">svector::phi</a></div><div class="ttdeci">double phi</div><div class="ttdoc">N/S in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:95</div></div>
<div class="ttc" id="physicslib_8cpp_html_a28de1fdb662726490fbc07bcf561d9bd"><div class="ttname"><a href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a></div><div class="ttdeci">static double coef[360+1][360+1][2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:39</div></div>
<div class="ttc" id="structgvector_html_a0bfcf58a2e1347b2acf503e503f1c93d"><div class="ttname"><a href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">gvector::lon</a></div><div class="ttdeci">double lon</div><div class="ttdoc">Longitude in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:114</div></div>
<div class="ttc" id="nrlmsise-00_8cpp_html_ae88729d6c4d0930c73a130b2a9b9407c"><div class="ttname"><a href="nrlmsise-00_8cpp.html#ae88729d6c4d0930c73a130b2a9b9407c">plg</a></div><div class="ttdeci">static double plg[4][9]</div><div class="ttdef"><b>Definition:</b> nrlmsise-00.cpp:99</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga430f8894cf763422f41a8e057ed32c96"><div class="ttname"><a href="group__convertlib__functions.html#ga430f8894cf763422f41a8e057ed32c96">pos_geod2geoc</a></div><div class="ttdeci">int32_t pos_geod2geoc(locstruc *loc)</div><div class="ttdoc">Update GEOD to GEOC in locstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1234</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa6e2765f7d85e40f4ef5c960fb04572c"><div class="ttname"><a href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a></div><div class="ttdeci">static locstruc sloc[MAXGJORDER+2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:47</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="structgeoidpos_html_a58eea1d79a7ffc82af4a43840852b8a1"><div class="ttname"><a href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">geoidpos::s</a></div><div class="ttdeci">gvector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:198</div></div>
<div class="ttc" id="structgvector_html_a76ed76078ce8f825c8c1e783b0a3b7c2"><div class="ttname"><a href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">gvector::lat</a></div><div class="ttdeci">double lat</div><div class="ttdoc">Latitude in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:112</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="structposstruc_html_a906e802c4aa1f6ac5ad34f5b3a728f6c"><div class="ttname"><a href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">posstruc::geod</a></div><div class="ttdeci">geoidpos geod</div><div class="ttdef"><b>Definition:</b> convertdef.h:400</div></div>
<div class="ttc" id="structsvector_html_acb2e6b4694745ef3cf790e806b7217fa"><div class="ttname"><a href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">svector::r</a></div><div class="ttdeci">double r</div><div class="ttdoc">Radius in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:99</div></div>
<div class="ttc" id="physicslib_8cpp_html_ab5cb235739ef02cfcc5755c92758b625"><div class="ttname"><a href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a></div><div class="ttdeci">#define MAXDEGREE</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:34</div></div>
<div class="ttc" id="group__physicslib__functions_html_gade5dfa05435c7c4171a8b73c5381f9d3"><div class="ttname"><a href="group__physicslib__functions.html#gade5dfa05435c7c4171a8b73c5381f9d3">gravity_params</a></div><div class="ttdeci">int32_t gravity_params(int model)</div><div class="ttdoc">Gravitational model parameters. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:699</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gadd6b74fb8263d68cf1ec4aca7991c039"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double gravity </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>radius</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>colat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>elon</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>degree</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculates geocentric acceleration magnitude from chosen model. </p>

</div>
</div>
<a class="anchor" id="gade5dfa05435c7c4171a8b73c5381f9d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t gravity_params </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>model</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Gravitational model parameters. </p>
<div class="fragment"><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;{</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keyword">register</span> uint32_t il, im;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordtype">double</span> norm;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    uint32_t dil, dim;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">double</span> dummy1, dummy2;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// Calculate factorial</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[0] == 0.)</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        <a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[0] = 1.;</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        <span class="keywordflow">for</span> (il=1; il&lt;2*<a class="code" href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a>+1; il++)</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;        {</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;            <a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il] = il * <a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il-1];</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;        }</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    }</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="comment">// Load Coefficients</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="physicslib_8cpp.html#aa7c5b68acc223ab72bdd1aff7234e4ba">cmodel</a> != model)</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[0][0][0] = 1.;</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[0][0][1] = 0.;</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[1][0][0] = <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[1][0][1] = 0.;</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[1][1][0] = <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[1][1][1] = 0.;</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;        <span class="keywordtype">string</span> <a class="code" href="geomag_8cpp.html#a93c18874ed825813c7e988569f84afb9">fname</a>;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;        FILE *fi;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;        <span class="keywordflow">switch</span> (model)</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;        {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__physicslib__constants.html#ga7da70fea95d6f81a2e3171cf5cfd729f">GRAVITY_EGM2008</a>:</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__physicslib__constants.html#gae2ae382fb1f7f7db16abd965e7eef950">GRAVITY_EGM2008_NORM</a>:</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            iretn = <a class="code" href="group__datalib__functions.html#ga0ab0e5e717aa450e8d6cdc71958910aa">get_cosmosresources</a>(fname);</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <span class="keywordflow">if</span> (iretn &lt; 0)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            {</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            }</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            fname += <span class="stringliteral">&quot;/general/egm2008_coef.txt&quot;</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            fi = fopen(fname.c_str(),<span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            <span class="keywordflow">if</span> (fi==NULL)</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;            {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                cout &lt;&lt; <span class="stringliteral">&quot;could not load file &quot;</span> &lt;&lt; fname &lt;&lt; endl;</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;            }</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;            <span class="keywordflow">for</span> (il=2; il&lt;101; il++)</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;            {</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;                <span class="keywordflow">for</span> (im=0; im&lt;= il; im++)</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;                {</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;                    iretn = fscanf(fi,<span class="stringliteral">&quot;%u %u %lf %lf\n&quot;</span>,&amp;dil,&amp;dim,&amp;<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0],&amp;<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1]);</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;                    <span class="keywordflow">if</span> (iretn &amp;&amp; model == <a class="code" href="group__physicslib__constants.html#gae2ae382fb1f7f7db16abd965e7eef950">GRAVITY_EGM2008_NORM</a>)</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;                    {</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;                        norm = sqrt(<a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il+im]/((2-(im==0?1:0))*(2*il+1)*<a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il-im]));</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;                        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] /= norm;</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;                        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] /= norm;</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                    }</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;                }</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;            }</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;            fclose(fi);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;            <a class="code" href="physicslib_8cpp.html#aa7c5b68acc223ab72bdd1aff7234e4ba">cmodel</a> = model;</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__physicslib__constants.html#gaf39660bd00e8e2ef7af645c6bbf043ee">GRAVITY_PGM2000A</a>:</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__physicslib__constants.html#ga52c487a5f736589d7746426ac125a921">GRAVITY_PGM2000A_NORM</a>:</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            iretn = <a class="code" href="group__datalib__functions.html#ga0ab0e5e717aa450e8d6cdc71958910aa">get_cosmosresources</a>(fname);</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="keywordflow">if</span> (iretn &lt; 0)</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            {</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;                <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;            }</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;            fname += <span class="stringliteral">&quot;/general/pgm2000a_coef.txt&quot;</span>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;            fi = fopen(fname.c_str(),<span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;            <span class="keywordflow">for</span> (il=2; il&lt;361; il++)</div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;            {</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;                <span class="keywordflow">for</span> (im=0; im&lt;= il; im++)</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                {</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;                    iretn = fscanf(fi,<span class="stringliteral">&quot;%u %u %lf %lf %lf %lf\n&quot;</span>,&amp;dil,&amp;dim,&amp;<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0],&amp;<a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1],&amp;dummy1,&amp;dummy2);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;                    <span class="keywordflow">if</span> (iretn &amp;&amp; model == <a class="code" href="group__physicslib__constants.html#ga52c487a5f736589d7746426ac125a921">GRAVITY_PGM2000A_NORM</a>)</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                    {</div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;                        norm = sqrt(<a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il+im]/((2-(il==im?1:0))*(2*il+1)*<a class="code" href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a>[il-im]));</div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;                        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][0] /= norm;</div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;                        <a class="code" href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a>[il][im][1] /= norm;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;                    }</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                }</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;            }</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;            fclose(fi);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;            <a class="code" href="physicslib_8cpp.html#aa7c5b68acc223ab72bdd1aff7234e4ba">cmodel</a> = model;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;        }</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;    }</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;}</div><div class="ttc" id="group__physicslib__constants_html_gae2ae382fb1f7f7db16abd965e7eef950"><div class="ttname"><a href="group__physicslib__constants.html#gae2ae382fb1f7f7db16abd965e7eef950">GRAVITY_EGM2008_NORM</a></div><div class="ttdeci">#define GRAVITY_EGM2008_NORM</div><div class="ttdef"><b>Definition:</b> physicsdef.h:70</div></div>
<div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__physicslib__constants_html_ga52c487a5f736589d7746426ac125a921"><div class="ttname"><a href="group__physicslib__constants.html#ga52c487a5f736589d7746426ac125a921">GRAVITY_PGM2000A_NORM</a></div><div class="ttdeci">#define GRAVITY_PGM2000A_NORM</div><div class="ttdef"><b>Definition:</b> physicsdef.h:69</div></div>
<div class="ttc" id="group__datalib__functions_html_ga0ab0e5e717aa450e8d6cdc71958910aa"><div class="ttname"><a href="group__datalib__functions.html#ga0ab0e5e717aa450e8d6cdc71958910aa">get_cosmosresources</a></div><div class="ttdeci">string get_cosmosresources(bool create_flag)</div><div class="ttdoc">Return COSMOS Resources Directory. </div><div class="ttdef"><b>Definition:</b> datalib.cpp:1337</div></div>
<div class="ttc" id="group__physicslib__constants_html_ga7da70fea95d6f81a2e3171cf5cfd729f"><div class="ttname"><a href="group__physicslib__constants.html#ga7da70fea95d6f81a2e3171cf5cfd729f">GRAVITY_EGM2008</a></div><div class="ttdeci">#define GRAVITY_EGM2008</div><div class="ttdef"><b>Definition:</b> physicsdef.h:68</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa7c5b68acc223ab72bdd1aff7234e4ba"><div class="ttname"><a href="physicslib_8cpp.html#aa7c5b68acc223ab72bdd1aff7234e4ba">cmodel</a></div><div class="ttdeci">static int cmodel</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:38</div></div>
<div class="ttc" id="geomag_8cpp_html_a93c18874ed825813c7e988569f84afb9"><div class="ttname"><a href="geomag_8cpp.html#a93c18874ed825813c7e988569f84afb9">fname</a></div><div class="ttdeci">static char fname[100]</div><div class="ttdef"><b>Definition:</b> geomag.cpp:89</div></div>
<div class="ttc" id="physicslib_8cpp_html_a28de1fdb662726490fbc07bcf561d9bd"><div class="ttname"><a href="physicslib_8cpp.html#a28de1fdb662726490fbc07bcf561d9bd">coef</a></div><div class="ttdeci">static double coef[360+1][360+1][2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:39</div></div>
<div class="ttc" id="group__physicslib__constants_html_gaf39660bd00e8e2ef7af645c6bbf043ee"><div class="ttname"><a href="group__physicslib__constants.html#gaf39660bd00e8e2ef7af645c6bbf043ee">GRAVITY_PGM2000A</a></div><div class="ttdeci">#define GRAVITY_PGM2000A</div><div class="ttdef"><b>Definition:</b> physicsdef.h:67</div></div>
<div class="ttc" id="physicslib_8cpp_html_ab5cb235739ef02cfcc5755c92758b625"><div class="ttname"><a href="physicslib_8cpp.html#ab5cb235739ef02cfcc5755c92758b625">MAXDEGREE</a></div><div class="ttdeci">#define MAXDEGREE</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:34</div></div>
<div class="ttc" id="physicslib_8cpp_html_a11f077d297fe211d9775f139a97c501d"><div class="ttname"><a href="physicslib_8cpp.html#a11f077d297fe211d9775f139a97c501d">ftl</a></div><div class="ttdeci">static double ftl[2 *360+1]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:37</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaacf81e9dec5c0bde6fa3323c99aeb852"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double nplgndr </td>
          <td>(</td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>l</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>m</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>x</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Legendre polynomial. </p>
<div class="fragment"><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;{</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordtype">double</span> fact,pll,pmm,pmmp1,omx2, oldfact;</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;    <span class="keyword">register</span> uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, ll, <a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa9b2d7688fc6394a3f52163b317043936">mm</a>;</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;    pll = 0.;</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="physicslib_8cpp.html#ab43acc9fa34df35614954a8112e01ef8">lastm</a> == 65535 || m &gt; <a class="code" href="physicslib_8cpp.html#ab43acc9fa34df35614954a8112e01ef8">lastm</a> || <a class="code" href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">x</a> != <a class="code" href="physicslib_8cpp.html#a8d1cffc725548ba8b07443ca10756557">lastx</a>)</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    {</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        <a class="code" href="physicslib_8cpp.html#a8d1cffc725548ba8b07443ca10756557">lastx</a> = <a class="code" href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">x</a>;</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        <a class="code" href="physicslib_8cpp.html#ab43acc9fa34df35614954a8112e01ef8">lastm</a> = m;</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;        mm = m;</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;        <span class="comment">//  for (mm=0; mm&lt;=MAXDEGREE; mm++)</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;        <span class="comment">//      {</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;        pmm=1.0;</div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (mm &gt; 0)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;        {</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            omx2=((1.0-<a class="code" href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">x</a>)*(1.0+<a class="code" href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">x</a>));</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;            fact=1.0;</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <span class="keywordflow">for</span> (i=1;i&lt;=<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa9b2d7688fc6394a3f52163b317043936">mm</a>;i++)</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;            {</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;                pmm *= fact*omx2/(fact+1.);</div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                fact += 2.0;</div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            }</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;        }</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;        pmm = sqrt((2.*m+1.)*pmm);</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        <span class="keywordflow">if</span> (mm%2 == 1)</div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;            pmm = - pmm;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        <a class="code" href="physicslib_8cpp.html#a9fdaa63bbe81485f6d243f2f68a7eb7b">spmm</a>[<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa9b2d7688fc6394a3f52163b317043936">mm</a>] = pmm;</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        <span class="comment">//      }</span></div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    }</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    pmm = <a class="code" href="physicslib_8cpp.html#a9fdaa63bbe81485f6d243f2f68a7eb7b">spmm</a>[m];</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    <span class="keywordflow">if</span> (l == m)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        <span class="keywordflow">return</span> pmm;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    <span class="keywordflow">else</span> {</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;        pmmp1=<a class="code" href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">x</a>*sqrt(2.*m+3.)*pmm;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        <span class="keywordflow">if</span> (l == (m+1))</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;            <span class="keywordflow">return</span> pmmp1;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;        <span class="keywordflow">else</span> {</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            oldfact = sqrt(2.*m+3.);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;            <span class="keywordflow">for</span> (ll=m+2;ll&lt;=l;ll++)</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            {</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;                fact = sqrt((4.*ll*ll-1.)/(ll*ll-m*m));</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;                pll=(<a class="code" href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">x</a>*pmmp1-pmm/oldfact)*fact;</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;                oldfact = fact;</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;                pmm=pmmp1;</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                pmmp1=pll;</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;            }</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;            <span class="keywordflow">return</span> pll;</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;        }</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;    }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;}</div><div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="namespaceinputfile_html_a0917c0e1c5a23f2341dc5dae0da96a51"><div class="ttname"><a href="namespaceinputfile.html#a0917c0e1c5a23f2341dc5dae0da96a51">inputfile.x</a></div><div class="ttdeci">x</div><div class="ttdef"><b>Definition:</b> inputfile.py:6</div></div>
<div class="ttc" id="physicslib_8cpp_html_ab43acc9fa34df35614954a8112e01ef8"><div class="ttname"><a href="physicslib_8cpp.html#ab43acc9fa34df35614954a8112e01ef8">lastm</a></div><div class="ttdeci">static uint16_t lastm</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:42</div></div>
<div class="ttc" id="eci2kep__test_8cpp_html_aa94081298ab2dfd0f261cce6c203d9aaa9b2d7688fc6394a3f52163b317043936"><div class="ttname"><a href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa9b2d7688fc6394a3f52163b317043936">mm</a></div><div class="ttdef"><b>Definition:</b> eci2kep_test.cpp:33</div></div>
<div class="ttc" id="physicslib_8cpp_html_a9fdaa63bbe81485f6d243f2f68a7eb7b"><div class="ttname"><a href="physicslib_8cpp.html#a9fdaa63bbe81485f6d243f2f68a7eb7b">spmm</a></div><div class="ttdeci">static double spmm[360+1]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:40</div></div>
<div class="ttc" id="physicslib_8cpp_html_a8d1cffc725548ba8b07443ca10756557"><div class="ttname"><a href="physicslib_8cpp.html#a8d1cffc725548ba8b07443ca10756557">lastx</a></div><div class="ttdeci">static double lastx</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:41</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga843a27228432f03296504441b64c680d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structsvector.html">svector</a> groundstation </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>satellite</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>groundstation</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Ground station values. </p>
<p>Ground station values.</p>
<p>Calculates aziumth and elevation for each gound station in the list of ground stations for a satellite at the indicated position. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">satellite</td><td>pointer to a <a class="el" href="structlocstruc.html">locstruc</a> specifying satellite position </td></tr>
    <tr><td class="paramname">groundstation</td><td>pointer to a <a class="el" href="structlocstruc.html">locstruc</a> specifying groundstation to be targeted </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><a class="el" href="structsvector.html" title="3 element spherical vector ">svector</a> containing azimuth in lambda, elevation in phi and slant range in r. </dd></dl>
<dl class="section see"><dt>See also</dt><dd><a class="el" href="group__convertlib__functions.html#ga5a8c36f2a318321899b7b37ca5faae45" title="Geocentric to Topocentric. ">geoc2topo</a> </dd>
<dd>
<a class="el" href="group__convertlib__functions.html#ga9ce5754454cbfa67bf23f6c1f378b76d">topo2azel</a> </dd></dl>
<div class="fragment"><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;{</div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <a class="code" href="structrvector.html">rvector</a> topo;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <a class="code" href="structsvector.html">svector</a> azel = {0.,0.,0.};</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="keywordtype">float</span> lambda, phi;</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga9459f1e69bf1c96e0bb58676faa9f8c0">pos_icrf2eci</a>(&amp;satellite);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8cdd6821b23a178d39b82a5c1e2080d3">pos_eci2geoc</a>(&amp;satellite);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga5a8c36f2a318321899b7b37ca5faae45">geoc2topo</a>(groundstation.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>,satellite.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>,topo);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga06d3f600e1214ab057bf436e127084b7">topo2azel</a>(topo, lambda, phi);</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;    azel.<a class="code" href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">lambda</a> = lambda;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    azel.<a class="code" href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">phi</a> = phi;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    azel.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a> = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(topo);</div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;    <span class="keywordflow">return</span> (azel);</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;}</div><div class="ttc" id="structsvector_html_ae4bb8de86cd498d896a3a50c76d34041"><div class="ttname"><a href="structsvector.html#ae4bb8de86cd498d896a3a50c76d34041">svector::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">E/W in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:97</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="group__mathlib__functions_html_gac6a350c8823f5ad93e80299ab777f602"><div class="ttname"><a href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a></div><div class="ttdeci">double length_rv(rvector v)</div><div class="ttdoc">Length of row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:748</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga5a8c36f2a318321899b7b37ca5faae45"><div class="ttname"><a href="group__convertlib__functions.html#ga5a8c36f2a318321899b7b37ca5faae45">geoc2topo</a></div><div class="ttdeci">void geoc2topo(gvector source, rvector targetgeoc, rvector &amp;topo)</div><div class="ttdoc">Geocentric to Topocentric. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2962</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="structsvector_html_ad0d07f026eebc5248d4404a2d56aab15"><div class="ttname"><a href="structsvector.html#ad0d07f026eebc5248d4404a2d56aab15">svector::phi</a></div><div class="ttdeci">double phi</div><div class="ttdoc">N/S in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:95</div></div>
<div class="ttc" id="structsvector_html"><div class="ttname"><a href="structsvector.html">svector</a></div><div class="ttdoc">3 element spherical vector </div><div class="ttdef"><b>Definition:</b> vector.h:92</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8cdd6821b23a178d39b82a5c1e2080d3"><div class="ttname"><a href="group__convertlib__functions.html#ga8cdd6821b23a178d39b82a5c1e2080d3">pos_eci2geoc</a></div><div class="ttdeci">int32_t pos_eci2geoc(locstruc *loc)</div><div class="ttdoc">Convert ECI to GEOC. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:825</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structgeoidpos_html_a58eea1d79a7ffc82af4a43840852b8a1"><div class="ttname"><a href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">geoidpos::s</a></div><div class="ttdeci">gvector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:198</div></div>
<div class="ttc" id="structposstruc_html_a906e802c4aa1f6ac5ad34f5b3a728f6c"><div class="ttname"><a href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">posstruc::geod</a></div><div class="ttdeci">geoidpos geod</div><div class="ttdef"><b>Definition:</b> convertdef.h:400</div></div>
<div class="ttc" id="structsvector_html_acb2e6b4694745ef3cf790e806b7217fa"><div class="ttname"><a href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">svector::r</a></div><div class="ttdeci">double r</div><div class="ttdoc">Radius in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:99</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga9459f1e69bf1c96e0bb58676faa9f8c0"><div class="ttname"><a href="group__convertlib__functions.html#ga9459f1e69bf1c96e0bb58676faa9f8c0">pos_icrf2eci</a></div><div class="ttdeci">int32_t pos_icrf2eci(locstruc *loc)</div><div class="ttdoc">Convert Barycentric to ECI. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:615</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga06d3f600e1214ab057bf436e127084b7"><div class="ttname"><a href="group__convertlib__functions.html#ga06d3f600e1214ab057bf436e127084b7">topo2azel</a></div><div class="ttdeci">void topo2azel(rvector tpos, float &amp;az, float &amp;el)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3049</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga78900b5c1c6d8ec1e0b248ff715ef968"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simulate_hardware </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>cinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate all devices. </p>
<p>Simulate all devices.</p>
<p>Simulate the behavior of all the hardware in the indicated satellite, at the indicated location, assuming a timestep of dt. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cinfo</td><td>Reference to <a class="el" href="structcosmosstruc.html" title="JSON Name Space structure. ">cosmosstruc</a> to use. </td></tr>
    <tr><td class="paramname">loc</td><td>Structure specifying location </td></tr>
  </table>
  </dd>
</dl>
<p>Calculate change in Angular Momentum and therefore Acceleration</p>
<p>Accelerate Reaction Wheel and calculate Component currents.</p>
<p>Component currents for each MTR </p>
<div class="fragment"><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;{</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="netperf__send_8cpp.html#a7f7e4724cf57d59513b39c5ecc81adc8">speed</a>, density, sattemp;</div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <a class="code" href="structrvector.html">rvector</a> vbody, vplanet;</div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    <span class="keywordtype">double</span> adrag, edot, sdot, vdot, ddrag;</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordtype">double</span> energy, efficiency, energyd, dcharge, dheat;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;    <span class="keywordtype">double</span> sdheat;</div><div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160;    <a class="code" href="structrvector.html">rvector</a> geov, vec;</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;<span class="comment">//    rvector unitv, units, unite, dtorque, da;</span></div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;    <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a> unitv, units, unite, dtorque, da;</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j, index;</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <a class="code" href="structrmatrix.html">rmatrix</a> mom;</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;    <span class="comment">//  rmatrix tskew;</span></div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <a class="code" href="structrvector.html">rvector</a> mag_moment;</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;    <a class="code" href="structrvector.html">rvector</a> mtorque, wtorque, wmomentum;</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="structrvector.html">rvector</a> bearth;</div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;    <span class="keywordtype">double</span> tcexp, dalp, domg, dmom;</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;    <a class="code" href="structquaternion.html">quaternion</a> tq;</div><div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;</div><div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;</div><div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;    <span class="comment">// Atmospheric and solar drag</span></div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;<span class="comment">//    unitv = loc.pos.geoc.v;</span></div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;<span class="comment">//    normalize_rv(unitv);</span></div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;<span class="comment">//    unitv = irotate((loc.att.geoc.s),unitv);</span></div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    unitv = <a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html">Quaternion</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html#a989a3cc529b15d205d7dcc183cc1cbf4">irotate</a>(<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>).<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">normalize</a>());</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;<span class="comment">//    units = rv_smult(-1.,loc.pos.icrf.s);</span></div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;<span class="comment">//    normalize_rv(units);</span></div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;<span class="comment">//    units = irotate((loc.att.icrf.s),units);</span></div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    units = <a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html">Quaternion</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html#a989a3cc529b15d205d7dcc183cc1cbf4">irotate</a>(<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">normalize</a>());</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;<span class="comment">//    unite = rv_smult(-1.,loc.pos.eci.s);</span></div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;<span class="comment">//    normalize_rv(unite);</span></div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;<span class="comment">//    unite = irotate((loc.att.icrf.s),unite);</span></div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    unite = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">normalize</a>(-1.);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;    unite = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">normalize</a>(-1.);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    unite = <a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html">Quaternion</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html#a989a3cc529b15d205d7dcc183cc1cbf4">irotate</a>(<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">normalize</a>(-1.));</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    geov = loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>;</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;    speed = geov.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]*geov.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]+geov.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]*geov.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]+geov.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]*geov.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2];</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <span class="keywordflow">if</span> (loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> &lt; 10000. || std::isnan(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a>))</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;        density = 1.225;</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;        density = 1000. * <a class="code" href="group__physicslib__functions.html#gaeb733b60ffc30cd2e2df172a398e59d3">msis00_density</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>,150.,150.,3.);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="comment">//  density = 0.;</span></div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    adrag = density * 1.1 * <a class="code" href="netperf__send_8cpp.html#a7f7e4724cf57d59513b39c5ecc81adc8">speed</a>;</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#aa6157eb9c6f849b0282c74396c95745c">powgen</a> = 0.;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#add87b4c17b7d13aba0cc863b10649412">atorque</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#acb39d11a05f11e6abe0d4698d8c486ce">rtorque</a> = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>();</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a789b490c787fd0e03e55f824ca49b3e6">adrag</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ae7eecf12ac3fd14b64c970481128d2ff">rdrag</a> = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>();</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    sdheat = 0;</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    sattemp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#adb74fc438f8df74993f2e713d09a4f98">heat</a> / (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">mass</a> * cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a99e6baefefa16247440ee1f2ebd79c0b">hcap</a>);</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>.size(); i++)</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;    {</div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].mass * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].temp * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].hcap;</div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;        energyd = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> * <a class="code" href="group__convertlib__constants.html#gab899f53048f1f06a224b5eb1fa369750">SIGMA</a> * pow(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].temp,4);</div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;        dheat = (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].temp-sattemp)/100000.*cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].heat;</div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].heat -= dheat;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;        sdheat += dheat;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;        dheat = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].emi*cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].area * energyd;</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].heat -= dheat;</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;        sdheat += dheat;</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;        if (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].face_cnt == 1)</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;        {</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat -= dheat;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;<span class="comment">//            vdot = dot_rv(unitv,cinfo-&gt;pieces[i].normal);</span></div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;            vdot = unitv.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a84afd34f46efe526f5ec3a9ac46985f7">dot</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">faces</a>[abs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].face_idx[0])].normal);</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;            <span class="keywordflow">if</span> (vdot &gt; 0)</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;            {</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;                <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">mass</a>)</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;                {</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;                    ddrag = adrag*vdot/cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">mass</a>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;                }</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                {</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;                    ddrag = 0.;</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                }</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;                dtorque = ddrag * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].twist;</div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#add87b4c17b7d13aba0cc863b10649412">atorque</a> += dtorque;</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;                da = ddrag * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].shove;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a789b490c787fd0e03e55f824ca49b3e6">adrag</a> += da;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;            }</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;            sdot = units.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a84afd34f46efe526f5ec3a9ac46985f7">dot</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">faces</a>[abs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].face_idx[0])].normal);</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;            <span class="keywordflow">if</span> (loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ac7a1d01cc0d16045dfd7e687f97d6d45">sunradiance</a> &amp;&amp; sdot &gt; 0)</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;            {</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;                ddrag = loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ac7a1d01cc0d16045dfd7e687f97d6d45">sunradiance</a> * sdot / (3e8*cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">mass</a>);</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;                dtorque = ddrag * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].twist;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#acb39d11a05f11e6abe0d4698d8c486ce">rtorque</a> += dtorque;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;                da = ddrag * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].shove;</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ae7eecf12ac3fd14b64c970481128d2ff">rdrag</a> += da;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].insol = loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ac7a1d01cc0d16045dfd7e687f97d6d45">sunradiance</a> * sdot / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">faces</a>[abs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].face_idx[0])].normal.norm();</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;                energyd =  cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].insol * cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].area * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].abs * energyd;</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;                <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].cidx&lt;(uint16_t)<a class="code" href="group__defs__comp__type.html#gga2966578899236a5f13460ff58d11885bab50339a10e1de285ac99d4c3990b8693">DeviceType::NONE</a> &amp;&amp; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].cidx].all.type == (uint16_t)<a class="code" href="group__defs__comp__type.html#gga2966578899236a5f13460ff58d11885ba8a54a2c642d79f30fb170e340c68d058">DeviceType::PVSTRG</a>)</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;                {</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                    j = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].cidx].all.didx;</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;                    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.effbase &gt; 0.)</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;                    {</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;                        efficiency = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.effbase + cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.effslope * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].temp;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.power = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].area*efficiency*cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].insol;</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.volt = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.nvolt;</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.amp = -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.power / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.volt;</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#aa6157eb9c6f849b0282c74396c95745c">powgen</a> += .4 * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.power;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat += (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].abs * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].area * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].insol - cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.power) * cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].heat -= cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].emi * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].area * energyd;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;                    }</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;                }</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;            }</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;            {</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                <span class="keywordflow">for</span> (j=0; j&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4e7889fdd230fc046d4b7765a1937257">pvstrg_cnt</a>; j++)</div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                {</div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.pidx == i)</div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;                    {</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.power = 0.;</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.volt = 0.;</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.amp = 0.;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;                        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat -= cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].emi * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].area * energyd;</div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;                    }</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;                }</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;            }</div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;            edot = acos(unite.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a84afd34f46efe526f5ec3a9ac46985f7">dot</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">faces</a>[abs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].face_idx[0])].normal) / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">faces</a>[abs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].face_idx[0])].normal.norm()) - <a class="code" href="group__mathlib__constants.html#ga3fbc03e1df13128b9117e3a24fc6f8b9">RADOF</a>(5.);</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;            <span class="keywordflow">if</span> (edot &lt; 0.)</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;                edot = 1.;</div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;                edot = cos(edot);</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;            <span class="keywordflow">if</span> (edot &gt; 0)</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;            {</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;                energyd = edot * cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> * <a class="code" href="group__convertlib__constants.html#gab899f53048f1f06a224b5eb1fa369750">SIGMA</a> * pow(290.,4);</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].abs*cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].area * energyd;</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;                <span class="keywordflow">for</span> (j=0; j&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4e7889fdd230fc046d4b7765a1937257">pvstrg_cnt</a>; j++)</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                {</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;                    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">pvstrg</a>[j]].pvstrg.pidx == i)</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;                    {</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;                        energy += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].abs * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].area * energyd;</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;                    }</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;                }</div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;            }</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;        }</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;    }</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="comment">// Simulate devices</span></div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">ctorque</a> = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>();</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ac80d8a50b7bdb77ff2ca8338ce10e9f6">hmomentum</a> = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>();</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">ctorque</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a729474b703b213c723c98937382c673c">ftorque</a>;</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <span class="comment">// Start with Reaction Wheel Torque</span></div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a982244f15316677590502f08b93a5cde">rw_cnt</a>; i++)</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    {</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;        <span class="comment">// Moments of Reaction Wheel in Device frame</span></div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        mom = <a class="code" href="group__mathlib__functions.html#ga9889205b84117e85ee849fea0e1cdcc6">rm_diag</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.mom);</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        <span class="comment">// Torque and Momentum from reaction wheel</span></div><div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;</div><div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="comment">// Calculate Momentum in Body frame and transform to ICRF</span></div><div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <span class="comment">//tskew = rm_skew(loc.att.icrf.v);</span></div><div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        wmomentum = <a class="code" href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a>(mom,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.omg,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>()));</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;        wmomentum = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.align,wmomentum);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;<span class="comment">//        cinfo-&gt;physics.hmomentum = rv_add(cinfo-&gt;physics.hmomentum,wmomentum);</span></div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ac80d8a50b7bdb77ff2ca8338ce10e9f6">hmomentum</a> += <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(wmomentum);</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;        <span class="comment">// Calculate Torque in Body frame and transform to ICRF</span></div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        wtorque = <a class="code" href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a>(mom,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.alp,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>()));</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;        wtorque = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.align,wtorque);</div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;<span class="comment">//        cinfo-&gt;physics.ctorque = rv_sub(cinfo-&gt;physics.ctorque,wtorque);</span></div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">ctorque</a> += <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(wtorque);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;        <span class="comment">// Term for exponential change</span></div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;        tcexp = exp(-cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.tc);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;</div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;        <span class="comment">// Keep alpha within allowed limits</span></div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.ralp &gt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.mxalp)</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.mxalp;</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.ralp &lt; -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.mxalp)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp = -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.mxalp;</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="comment">// Set alpha to zero if accelerating past limit</span></div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.omg &lt; -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.mxomg)</div><div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;        {</div><div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.ralp &lt; 0.)</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp = 0.;</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;        }</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.omg &gt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.mxomg)</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;        {</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.ralp &gt; 0.)</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp = 0.;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;        }</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;        <span class="comment">// Calculate change in acceleration effects</span></div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.ralp != cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.alp)</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        {</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;            dalp = tcexp * (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.alp - cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp);</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.alp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp + dalp;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;            domg = -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.tc * dalp;</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        }</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;            domg = 0.;</div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.omg += cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.alp + domg;</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.cidx].all.amp = .054 * fabs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.omg)/400. + .093 * fabs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[i]].rw.alp) / 30.;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;    }</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;    <span class="comment">// Determine magtorquer moments in body frame</span></div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    <span class="comment">// Magtorquer Torque is Cross Product of B field and Moments</span></div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;    mtorque = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;    mag_moment = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ace81b493dad7e9971a06c2df2d159a8e">mtr_cnt</a>; i++)</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;    {</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="comment">// Magnetic Moments in Body frame</span></div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;        mag_moment = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(mag_moment,<a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.align,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.mom,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>())));</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;        tcexp = exp(-cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.tc);</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;        <span class="comment">// Keep field within allowed limits</span></div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.rmom &gt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.mxmom)</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.rmom = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mxmom;</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.rmom &lt; -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.mxmom)</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.rmom = -cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mxmom;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.rmom != cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.mom)</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;        {</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;            dmom = tcexp * (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom - cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.rmom);</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.rmom + dmom;</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;        }</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[i]].mtr.rmom &lt; 0.)</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;        {</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.cidx].all.amp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom * (3.6519e-3 - cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom * 8.6439e-5);</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;        }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;        {</div><div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.cidx].all.amp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom * (3.6519e-3 + cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom * 8.6439e-5);</div><div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;        }</div><div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;        <span class="comment">//  cinfo-&gt;device[cinfo-&gt;devspec.mtr[i]].mtr.mom = cinfo-&gt;device[cinfo-&gt;device[cinfo-&gt;devspec.mtr[i]].mtr.cidx].all.amp*(229.43-cinfo-&gt;device[cinfo-&gt;device[cinfo-&gt;devspec.mtr[i]].mtr.cidx].all.amp*382.65);</span></div><div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    }</div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    <span class="comment">// Get magnetic field in body frame</span></div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    bearth = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>,loc.<a class="code" href="structlocstruc.html#a5ec93a47e93676058e69d4b95a6fb8b0">bearth</a>);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;    mtorque = <a class="code" href="group__mathlib__functions.html#ga87872977600612c97f2ccd895a18c1a4">rv_cross</a>(mag_moment,bearth);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <span class="comment">//  mtorque = irotate(q_conjugate(loc.att.icrf.s),mtorque);</span></div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;<span class="comment">//    cinfo-&gt;physics.ctorque = rv_add(cinfo-&gt;physics.ctorque,mtorque);</span></div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">ctorque</a> += <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(mtorque);</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="comment">// Star Trackers</span></div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa16d7419633cb5ba20f81ec2e2d6b2e7">stt_cnt</a>; i++)</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        tq = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[i]].stt.align),loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>);</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.att = tq;</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.omega = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(tq,loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>);</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    }</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    <span class="comment">// Inertial Measurement Units</span></div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">imu_cnt</a>; i++)</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    {</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;        <span class="comment">// convert attitude from ICRF to sensor body frame</span></div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;        <span class="comment">// att.s = 0th order derivative (quaternion)</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;        <span class="comment">// embbed into a function</span></div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        <span class="comment">// &#39;updates&#39; cinfo-&gt;devspec.imu[i] with noise modified data</span></div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga5ba53cb5cf49f51c402a5418fd83405d">simulate_imu</a>(i, cinfo, loc);</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].imu.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;    }</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aaaa6c3838618861239d161d3905c9317">gps_cnt</a>; i++)</div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;    {</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9f3e34cb12480d4ddf4e0faccb6621a">gps</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].gps.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9f3e34cb12480d4ddf4e0faccb6621a">gps</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].gps.geocs = loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9f3e34cb12480d4ddf4e0faccb6621a">gps</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].gps.dgeocs = <a class="code" href="group__mathlib__functions.html#ga0a71da93d7c3d9274716ed570440328e">rv_one</a>(5., 5., 5.);</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9f3e34cb12480d4ddf4e0faccb6621a">gps</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].gps.geocv = loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9f3e34cb12480d4ddf4e0faccb6621a">gps</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].gps.dgeocv = <a class="code" href="group__mathlib__functions.html#ga0a71da93d7c3d9274716ed570440328e">rv_one</a>();</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    }</div><div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a538a4c499c15299b0d170d49b9741cef">ssen_cnt</a>; i++)</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    {</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="comment">// Get sun vector in body frame</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        vec = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>));</div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;        <span class="comment">// Rotate into sun sensor frame</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        vec = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.align),vec);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;        <span class="comment">// Convert this to az and el</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga06d3f600e1214ab057bf436e127084b7">topo2azel</a>(vec, cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.azimuth, cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.azimuth &lt; 0.)</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;        {</div><div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.azimuth += <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;        }</div><div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qva = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvb = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvc = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvd = 0.;</div><div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation &gt; <a class="code" href="group__mathlib__constants.html#ga3fbc03e1df13128b9117e3a24fc6f8b9">RADOF</a>(70.))</div><div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        {</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qva = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvb = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvc = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvd = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        }</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        {</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation &gt; <a class="code" href="group__mathlib__constants.html#ga3fbc03e1df13128b9117e3a24fc6f8b9">RADOF</a>(30.))</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;            {</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;                <span class="keywordflow">switch</span> ((<span class="keywordtype">int</span>)(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.azimuth/(<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>/4.)+.5))</div><div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;                {</div><div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;                <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qva = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;                <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qva = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvb = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;                <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvb = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvb = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvc = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;                <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvc = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;                <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvc = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvd = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;                <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvd = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;                <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qvd = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.qva = sin(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[i]].ssen.elevation);</div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;                    <span class="keywordflow">break</span>;</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;                }</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;            }</div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;        }</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">ssen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].ssen.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    }</div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;    <span class="comment">// Simulate thsters</span></div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a10e23c7959230d72a01c1a2a7a1d247e">thst_cnt</a>; i++)</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;    {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;<span class="comment">//        cinfo-&gt;device[cinfo-&gt;devspec.thst[i]].thst.flw = (length_rv(cinfo-&gt;physics.thrust) / cinfo-&gt;devspec.thst_cnt) / cinfo-&gt;device[cinfo-&gt;devspec.thst[i]].thst.isp;</span></div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">thst</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].thst.flw = (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#aa41fdb408a64cc53683853bfa8629d32">thrust</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a7d103319a682017f7c4f927510089561">norm</a>() / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a10e23c7959230d72a01c1a2a7a1d247e">thst_cnt</a>) / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">thst</a>[i]].thst.isp;</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        if (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">thst</a>[i]].thst.flw &lt; .002)</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">thst</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].thst.flw = 0.;</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a96d65ef0a7fa0bd0978bc4476d05c8c3">prop</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].prop.lev -= cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">thst</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].thst.flw;</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">thst</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].thst.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;    <span class="comment">// Simulate drive motors</span></div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;    vbody = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a99657d9052526f80dc042f3432c3c77e">motr_cnt</a>; i++)</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;    {</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a48470baf58c32e956e91a5358432cb68">motr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].motr.cidx].all.amp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a48470baf58c32e956e91a5358432cb68">motr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].motr.spd;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        vbody = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(vbody,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a48470baf58c32e956e91a5358432cb68">motr</a>[i]].motr.spd*cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a48470baf58c32e956e91a5358432cb68">motr</a>[i]].motr.rat,<a class="code" href="group__mathlib__functions.html#gacd0bd1cf5e88440f2912f37c9a5e2c4b">rv_unitx</a>()));</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;        <span class="keywordflow">if</span> (i == cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a99657d9052526f80dc042f3432c3c77e">motr_cnt</a>-1)</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;        {</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;            <span class="keywordflow">switch</span> (loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a595ae21e2f82365e5d631420f1babfcb">closest</a>)</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;            {</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>:</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;                vplanet = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>),vbody);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>,vplanet);</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>:</div><div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;                vplanet = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#af07b0ae5546abe7a6743c7045237a824">selc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>),vbody);</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;                loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a347dce35d5c096ec7c881d1da060e9bb">selc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a347dce35d5c096ec7c881d1da060e9bb">selc</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>,vplanet);</div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;            }</div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;        }</div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a48470baf58c32e956e91a5358432cb68">motr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].motr.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    }</div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;</div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="comment">// Disk drive details</span></div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a16a48dfbb7b6c9ac8598d5644e9c4cf7">pload_cnt</a>; i++)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;    {</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9152b789bf6f8ba8ba5864c7f762f76">pload</a>[i]].pload.flag&amp;<a class="code" href="group__defs__comp__flag.html#gab1319b2a66d48c7d92123f970c082a44">DEVICE_FLAG_ON</a> &amp;&amp; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9152b789bf6f8ba8ba5864c7f762f76">pload</a>[i]].pload.drate != 0.)</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;        {</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a83cd4f079f5b30a00a58391eacc109aa">disk</a>[0]].disk.gib += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ac9152b789bf6f8ba8ba5864c7f762f76">pload</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].pload.drate;</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;        }</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;    }</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;</div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;    <span class="comment">// Power details</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae2c2cdb514b4189f6042f9ea434e45d0">powuse</a> = 0.;</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a6014a57b42b32586ac97d89aa4d05f55">bus_cnt</a>; i++)</div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;    {</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].bus.amp = 0.;</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;    }</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a5a97e190638c0b54a0cde6acae1e205d">device_cnt</a>; i++)</div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    {</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;        index = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.bidx;</div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;        <span class="keywordflow">if</span> (index &gt;= cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a6014a57b42b32586ac97d89aa4d05f55">bus_cnt</a>)</div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;        {</div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            index = 0;</div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;        }</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a6014a57b42b32586ac97d89aa4d05f55">bus_cnt</a> &amp;&amp; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[i].all.flag&amp;<a class="code" href="group__defs__comp__flag.html#gab1319b2a66d48c7d92123f970c082a44">DEVICE_FLAG_ON</a> &amp;&amp; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[index]].bus.flag&amp;<a class="code" href="group__defs__comp__flag.html#gab1319b2a66d48c7d92123f970c082a44">DEVICE_FLAG_ON</a>)</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;        {</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.power = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.amp * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.volt;</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[index]].bus.amp += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.amp;</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[i].all.volt &gt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[index]].bus.volt)</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            {</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[index]].bus.volt = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.volt;</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;            }</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[i].all.power &lt;= 0.)</div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[i].all.pidx &lt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a8ed28ec7bf425716d77bba95340bbf09">piece_cnt</a>)</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;            {</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.pidx].heat += .8 * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.power * cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>;</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;            }</div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[i].all.type != (uint16_t)<a class="code" href="group__defs__comp__type.html#gga2966578899236a5f13460ff58d11885ba0e0c9d888d1093cb2dfa6b25cbce19d8">DeviceType::BUS</a>)</div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;            {</div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae2c2cdb514b4189f6042f9ea434e45d0">powuse</a> += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.power;</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;            }</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        }</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;        {</div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].all.power = 0.;</div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;        }</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;    }</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;    <span class="comment">// Heat details</span></div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#adb74fc438f8df74993f2e713d09a4f98">heat</a> = 0.;</div><div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>.size(); i++)</div><div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;    {</div><div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">mass</a>)</div><div class="line"><a name="l01383"></a><span class="lineno"> 1383</span>&#160;        {</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat += sdheat*cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].mass/cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">mass</a>;</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;            <span class="comment">//  cinfo-&gt;pieces[i].heat += sdheat/cinfo-&gt;pieces.size();</span></div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#adb74fc438f8df74993f2e713d09a4f98">heat</a> += cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].temp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].heat / (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].mass * cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].hcap);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;            <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[i].cidx &lt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>.size())</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;            {</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;                cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].cidx].all.temp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].temp;</div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;            }</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;        }</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;        {</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].temp = 0.;</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;        }</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    }</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a31d43f01258509ccbc4ec80f25a8b64c">tsen_cnt</a>; i++)</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    {</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a15d0534697b3c897807c8ca05893da06">tsen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].tsen.temp = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a15d0534697b3c897807c8ca05893da06">tsen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].tsen.cidx].all.pidx].temp;</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a15d0534697b3c897807c8ca05893da06">tsen</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].tsen.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    }</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;    <span class="comment">// More Power details</span></div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0fb0ccc4b1e155bb17595a4255a1ee41">batt_cnt</a>)</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    {</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;        dcharge = (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/3600.) * ((cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#aa6157eb9c6f849b0282c74396c95745c">powgen</a>-cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae2c2cdb514b4189f6042f9ea434e45d0">powuse</a>) / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[0]].batt.volt) / cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0fb0ccc4b1e155bb17595a4255a1ee41">batt_cnt</a>;</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    }</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    {</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;        dcharge = 0.;</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    }</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a0fb0ccc4b1e155bb17595a4255a1ee41">batt_cnt</a>; i++)</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;    {</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].batt.charge += dcharge;</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae73de1d542958decfcc7f6b890ad745b">battlev</a> += dcharge;</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[i]].batt.charge &gt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[i]].batt.capacity)</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].batt.charge = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].batt.capacity;</div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[i]].batt.charge &lt; 0.)</div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].batt.charge = 0.;</div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">batt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].batt.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    }</div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#aa6157eb9c6f849b0282c74396c95745c">powgen</a> &gt; cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae2c2cdb514b4189f6042f9ea434e45d0">powuse</a>)</div><div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#afd91711089a1f0832c75f0b5c10ac7f3">flags</a> |= <a class="code" href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a>;</div><div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#afd91711089a1f0832c75f0b5c10ac7f3">flags</a> &amp;= ~<a class="code" href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a>;</div><div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae73de1d542958decfcc7f6b890ad745b">battlev</a> &lt; 0.)</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae73de1d542958decfcc7f6b890ad745b">battlev</a> = 0.;</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae73de1d542958decfcc7f6b890ad745b">battlev</a> &gt;= cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ac887ddcb1fa9ef00f3d26e341c37aa19">battcap</a>)</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;    {</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#afd91711089a1f0832c75f0b5c10ac7f3">flags</a> &amp;= ~<a class="code" href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a>;</div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ae73de1d542958decfcc7f6b890ad745b">battlev</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#ac887ddcb1fa9ef00f3d26e341c37aa19">battcap</a>;</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;    }</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#abdcf31199a01354992ee8b3f6677c9cd">timestamp</a> = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;}</div><div class="ttc" id="structcosmosstruc_html_abdcf31199a01354992ee8b3f6677c9cd"><div class="ttname"><a href="structcosmosstruc.html#abdcf31199a01354992ee8b3f6677c9cd">cosmosstruc::timestamp</a></div><div class="ttdeci">double timestamp</div><div class="ttdoc">Timestamp for last change to data. </div><div class="ttdef"><b>Definition:</b> jsondef.h:1998</div></div>
<div class="ttc" id="structdevspecstruc_html_a8fa600fe999ea5fe82360f12d3a4c918"><div class="ttname"><a href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">devspecstruc::imu_cnt</a></div><div class="ttdeci">uint16_t imu_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1827</div></div>
<div class="ttc" id="structdevspecstruc_html_adc2df0836d9c6ba7f393dddfce2a87e5"><div class="ttname"><a href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">devspecstruc::mtr</a></div><div class="ttdeci">vector&lt; uint16_t &gt; mtr</div><div class="ttdef"><b>Definition:</b> jsondef.h:1863</div></div>
<div class="ttc" id="structcosmosstruc_html_a8955419ef9cc9e850608091159cfb316"><div class="ttname"><a href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">cosmosstruc::faces</a></div><div class="ttdeci">vector&lt; facestruc &gt; faces</div><div class="ttdoc">Vector of all faces in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2020</div></div>
<div class="ttc" id="structdevspecstruc_html_aad89fb4f77fb5e1b06cca79cf1f134f1"><div class="ttname"><a href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">devspecstruc::stt</a></div><div class="ttdeci">vector&lt; uint16_t &gt; stt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1872</div></div>
<div class="ttc" id="structcosmosstruc_html_af66e63a63cc00533144a1e422f75ff6e"><div class="ttname"><a href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">cosmosstruc::physics</a></div><div class="ttdeci">physicsstruc physics</div><div class="ttdoc">Structure for physics modelling. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2032</div></div>
<div class="ttc" id="structnodestruc_html_a5a97e190638c0b54a0cde6acae1e205d"><div class="ttname"><a href="structnodestruc.html#a5a97e190638c0b54a0cde6acae1e205d">nodestruc::device_cnt</a></div><div class="ttdeci">uint16_t device_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1732</div></div>
<div class="ttc" id="structattstruc_html_a7fa9276c6dcd5ac70c1519721956e3a1"><div class="ttname"><a href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">attstruc::geoc</a></div><div class="ttdeci">qatt geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:418</div></div>
<div class="ttc" id="structdevspecstruc_html_a96d65ef0a7fa0bd0978bc4476d05c8c3"><div class="ttname"><a href="structdevspecstruc.html#a96d65ef0a7fa0bd0978bc4476d05c8c3">devspecstruc::prop</a></div><div class="ttdeci">vector&lt; uint16_t &gt; prop</div><div class="ttdef"><b>Definition:</b> jsondef.h:1865</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a84afd34f46efe526f5ec3a9ac46985f7"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a84afd34f46efe526f5ec3a9ac46985f7">Cosmos::Math::Vectors::Vector::dot</a></div><div class="ttdeci">double dot(Vector b)</div><div class="ttdoc">Dot product. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1684</div></div>
<div class="ttc" id="group__mathlib__functions_html_gad3d78ceb8af40ce126896a854dc2bb22"><div class="ttname"><a href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a></div><div class="ttdeci">rvector rv_add(rvector a, rvector b)</div><div class="ttdoc">Add two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:299</div></div>
<div class="ttc" id="group__defs__node__flag_html_gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368"><div class="ttname"><a href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a></div><div class="ttdef"><b>Definition:</b> cosmos-defs.h:114</div></div>
<div class="ttc" id="structnodestruc_html_ae2c2cdb514b4189f6042f9ea434e45d0"><div class="ttname"><a href="structnodestruc.html#ae2c2cdb514b4189f6042f9ea434e45d0">nodestruc::powuse</a></div><div class="ttdeci">float powuse</div><div class="ttdef"><b>Definition:</b> jsondef.h:1752</div></div>
<div class="ttc" id="structdevspecstruc_html_a5216197281736e4b38a5b330894233e8"><div class="ttname"><a href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">devspecstruc::bus</a></div><div class="ttdeci">vector&lt; uint16_t &gt; bus</div><div class="ttdef"><b>Definition:</b> jsondef.h:1854</div></div>
<div class="ttc" id="structphysicsstruc_html_a789b490c787fd0e03e55f824ca49b3e6"><div class="ttname"><a href="structphysicsstruc.html#a789b490c787fd0e03e55f824ca49b3e6">physicsstruc::adrag</a></div><div class="ttdeci">Vector adrag</div><div class="ttdef"><b>Definition:</b> physicsdef.h:161</div></div>
<div class="ttc" id="structdevspecstruc_html_ac9f3e34cb12480d4ddf4e0faccb6621a"><div class="ttname"><a href="structdevspecstruc.html#ac9f3e34cb12480d4ddf4e0faccb6621a">devspecstruc::gps</a></div><div class="ttdeci">vector&lt; uint16_t &gt; gps</div><div class="ttdef"><b>Definition:</b> jsondef.h:1858</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a7d103319a682017f7c4f927510089561"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a7d103319a682017f7c4f927510089561">Cosmos::Math::Vectors::Vector::norm</a></div><div class="ttdeci">double norm()</div><div class="ttdoc">Norm. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1722</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structdevspecstruc_html_a31d43f01258509ccbc4ec80f25a8b64c"><div class="ttname"><a href="structdevspecstruc.html#a31d43f01258509ccbc4ec80f25a8b64c">devspecstruc::tsen_cnt</a></div><div class="ttdeci">uint16_t tsen_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1847</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structphysicsstruc_html_aa41fdb408a64cc53683853bfa8629d32"><div class="ttname"><a href="structphysicsstruc.html#aa41fdb408a64cc53683853bfa8629d32">physicsstruc::thrust</a></div><div class="ttdeci">Vector thrust</div><div class="ttdef"><b>Definition:</b> physicsdef.h:163</div></div>
<div class="ttc" id="structposstruc_html_a347dce35d5c096ec7c881d1da060e9bb"><div class="ttname"><a href="structposstruc.html#a347dce35d5c096ec7c881d1da060e9bb">posstruc::selc</a></div><div class="ttdeci">cartpos selc</div><div class="ttdef"><b>Definition:</b> convertdef.h:399</div></div>
<div class="ttc" id="structdevspecstruc_html_a99657d9052526f80dc042f3432c3c77e"><div class="ttname"><a href="structdevspecstruc.html#a99657d9052526f80dc042f3432c3c77e">devspecstruc::motr_cnt</a></div><div class="ttdeci">uint16_t motr_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1829</div></div>
<div class="ttc" id="structdevspecstruc_html_a538a4c499c15299b0d170d49b9741cef"><div class="ttname"><a href="structdevspecstruc.html#a538a4c499c15299b0d170d49b9741cef">devspecstruc::ssen_cnt</a></div><div class="ttdeci">uint16_t ssen_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1838</div></div>
<div class="ttc" id="structquaternion_html"><div class="ttname"><a href="structquaternion.html">quaternion</a></div><div class="ttdoc">Quaternion, scalar last, using x, y, z. </div><div class="ttdef"><b>Definition:</b> vector.h:213</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="structnodestruc_html_a8ed28ec7bf425716d77bba95340bbf09"><div class="ttname"><a href="structnodestruc.html#a8ed28ec7bf425716d77bba95340bbf09">nodestruc::piece_cnt</a></div><div class="ttdeci">uint16_t piece_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1731</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="structphysicsstruc_html_a729474b703b213c723c98937382c673c"><div class="ttname"><a href="structphysicsstruc.html#a729474b703b213c723c98937382c673c">physicsstruc::ftorque</a></div><div class="ttdeci">Vector ftorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:153</div></div>
<div class="ttc" id="structdevspecstruc_html_a607780e080ad5d8230125bc6314be7e0"><div class="ttname"><a href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">devspecstruc::imu</a></div><div class="ttdeci">vector&lt; uint16_t &gt; imu</div><div class="ttdef"><b>Definition:</b> jsondef.h:1860</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="structdevspecstruc_html_aa79561f078de9958e50f6ab644d7b18a"><div class="ttname"><a href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">devspecstruc::rw</a></div><div class="ttdeci">vector&lt; uint16_t &gt; rw</div><div class="ttdef"><b>Definition:</b> jsondef.h:1869</div></div>
<div class="ttc" id="group__defs__comp__flag_html_gab1319b2a66d48c7d92123f970c082a44"><div class="ttname"><a href="group__defs__comp__flag.html#gab1319b2a66d48c7d92123f970c082a44">DEVICE_FLAG_ON</a></div><div class="ttdeci">#define DEVICE_FLAG_ON</div><div class="ttdef"><b>Definition:</b> jsondef.h:683</div></div>
<div class="ttc" id="structdevspecstruc_html_a16a48dfbb7b6c9ac8598d5644e9c4cf7"><div class="ttname"><a href="structdevspecstruc.html#a16a48dfbb7b6c9ac8598d5644e9c4cf7">devspecstruc::pload_cnt</a></div><div class="ttdeci">uint16_t pload_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1831</div></div>
<div class="ttc" id="structposstruc_html_ac7a1d01cc0d16045dfd7e687f97d6d45"><div class="ttname"><a href="structposstruc.html#ac7a1d01cc0d16045dfd7e687f97d6d45">posstruc::sunradiance</a></div><div class="ttdeci">float sunradiance</div><div class="ttdef"><b>Definition:</b> convertdef.h:407</div></div>
<div class="ttc" id="structnodestruc_html_aa6157eb9c6f849b0282c74396c95745c"><div class="ttname"><a href="structnodestruc.html#aa6157eb9c6f849b0282c74396c95745c">nodestruc::powgen</a></div><div class="ttdeci">float powgen</div><div class="ttdef"><b>Definition:</b> jsondef.h:1751</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga0a71da93d7c3d9274716ed570440328e"><div class="ttname"><a href="group__mathlib__functions.html#ga0a71da93d7c3d9274716ed570440328e">rv_one</a></div><div class="ttdeci">rvector rv_one()</div><div class="ttdoc">Row vector of ones. </div><div class="ttdef"><b>Definition:</b> vector.cpp:151</div></div>
<div class="ttc" id="structextrapos_html_a595ae21e2f82365e5d631420f1babfcb"><div class="ttname"><a href="structextrapos.html#a595ae21e2f82365e5d631420f1babfcb">extrapos::closest</a></div><div class="ttdeci">uint16_t closest</div><div class="ttdef"><b>Definition:</b> convertdef.h:372</div></div>
<div class="ttc" id="structnodestruc_html_ae73de1d542958decfcc7f6b890ad745b"><div class="ttname"><a href="structnodestruc.html#ae73de1d542958decfcc7f6b890ad745b">nodestruc::battlev</a></div><div class="ttdeci">float battlev</div><div class="ttdef"><b>Definition:</b> jsondef.h:1753</div></div>
<div class="ttc" id="structdevspecstruc_html_ac9152b789bf6f8ba8ba5864c7f762f76"><div class="ttname"><a href="structdevspecstruc.html#ac9152b789bf6f8ba8ba5864c7f762f76">devspecstruc::pload</a></div><div class="ttdeci">vector&lt; uint16_t &gt; pload</div><div class="ttdef"><b>Definition:</b> jsondef.h:1864</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="structnodestruc_html_afd91711089a1f0832c75f0b5c10ac7f3"><div class="ttname"><a href="structnodestruc.html#afd91711089a1f0832c75f0b5c10ac7f3">nodestruc::flags</a></div><div class="ttdeci">uint16_t flags</div><div class="ttdef"><b>Definition:</b> jsondef.h:1740</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="structcosmosstruc_html_a84fcbf5d6772b8c6e1512dd041b3009d"><div class="ttname"><a href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">cosmosstruc::device</a></div><div class="ttdeci">vector&lt; devicestruc &gt; device</div><div class="ttdoc">Vector of all general (common) information for devices (components) in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2026</div></div>
<div class="ttc" id="structcosmosstruc_html_af4e942210d74ec7b18eed16914c366ce"><div class="ttname"><a href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">cosmosstruc::node</a></div><div class="ttdeci">nodestruc node</div><div class="ttdoc">Structure for summary information in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2014</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="structphysicsstruc_html_a99e6baefefa16247440ee1f2ebd79c0b"><div class="ttname"><a href="structphysicsstruc.html#a99e6baefefa16247440ee1f2ebd79c0b">physicsstruc::hcap</a></div><div class="ttdeci">float hcap</div><div class="ttdef"><b>Definition:</b> physicsdef.h:166</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="structdevspecstruc_html_a4e7889fdd230fc046d4b7765a1937257"><div class="ttname"><a href="structdevspecstruc.html#a4e7889fdd230fc046d4b7765a1937257">devspecstruc::pvstrg_cnt</a></div><div class="ttdeci">uint16_t pvstrg_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1839</div></div>
<div class="ttc" id="structdevspecstruc_html_aaaa6c3838618861239d161d3905c9317"><div class="ttname"><a href="structdevspecstruc.html#aaaa6c3838618861239d161d3905c9317">devspecstruc::gps_cnt</a></div><div class="ttdeci">uint16_t gps_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1825</div></div>
<div class="ttc" id="structdevspecstruc_html_a0fb0ccc4b1e155bb17595a4255a1ee41"><div class="ttname"><a href="structdevspecstruc.html#a0fb0ccc4b1e155bb17595a4255a1ee41">devspecstruc::batt_cnt</a></div><div class="ttdeci">uint16_t batt_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1820</div></div>
<div class="ttc" id="structattstruc_html_af07b0ae5546abe7a6743c7045237a824"><div class="ttname"><a href="structattstruc.html#af07b0ae5546abe7a6743c7045237a824">attstruc::selc</a></div><div class="ttdeci">qatt selc</div><div class="ttdef"><b>Definition:</b> convertdef.h:419</div></div>
<div class="ttc" id="structrmatrix_html"><div class="ttname"><a href="structrmatrix.html">rmatrix</a></div><div class="ttdoc">3x3 element generic matrix </div><div class="ttdef"><b>Definition:</b> matrix.h:41</div></div>
<div class="ttc" id="structdevspecstruc_html_a83cd4f079f5b30a00a58391eacc109aa"><div class="ttname"><a href="structdevspecstruc.html#a83cd4f079f5b30a00a58391eacc109aa">devspecstruc::disk</a></div><div class="ttdeci">vector&lt; uint16_t &gt; disk</div><div class="ttdef"><b>Definition:</b> jsondef.h:1857</div></div>
<div class="ttc" id="structphysicsstruc_html_acb39d11a05f11e6abe0d4698d8c486ce"><div class="ttname"><a href="structphysicsstruc.html#acb39d11a05f11e6abe0d4698d8c486ce">physicsstruc::rtorque</a></div><div class="ttdeci">Vector rtorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:155</div></div>
<div class="ttc" id="structdevspecstruc_html_a48470baf58c32e956e91a5358432cb68"><div class="ttname"><a href="structdevspecstruc.html#a48470baf58c32e956e91a5358432cb68">devspecstruc::motr</a></div><div class="ttdeci">vector&lt; uint16_t &gt; motr</div><div class="ttdef"><b>Definition:</b> jsondef.h:1862</div></div>
<div class="ttc" id="structdevspecstruc_html_a6014a57b42b32586ac97d89aa4d05f55"><div class="ttname"><a href="structdevspecstruc.html#a6014a57b42b32586ac97d89aa4d05f55">devspecstruc::bus_cnt</a></div><div class="ttdeci">uint16_t bus_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1821</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga9889205b84117e85ee849fea0e1cdcc6"><div class="ttname"><a href="group__mathlib__functions.html#ga9889205b84117e85ee849fea0e1cdcc6">rm_diag</a></div><div class="ttdeci">rmatrix rm_diag(rvector a)</div><div class="ttdoc">Diagonal rmatrix Creates an rmatrix whose diagonal is filled with the supplied rvector. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:97</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="structphysicsstruc_html_ae7eecf12ac3fd14b64c970481128d2ff"><div class="ttname"><a href="structphysicsstruc.html#ae7eecf12ac3fd14b64c970481128d2ff">physicsstruc::rdrag</a></div><div class="ttdeci">Vector rdrag</div><div class="ttdef"><b>Definition:</b> physicsdef.h:162</div></div>
<div class="ttc" id="structdevspecstruc_html_a9445e703bb377eb1d8e6ed8ebcedca07"><div class="ttname"><a href="structdevspecstruc.html#a9445e703bb377eb1d8e6ed8ebcedca07">devspecstruc::thst</a></div><div class="ttdeci">vector&lt; uint16_t &gt; thst</div><div class="ttdef"><b>Definition:</b> jsondef.h:1878</div></div>
<div class="ttc" id="structgvector_html_a682173234f20766ce6fc83b8723758e7"><div class="ttname"><a href="structgvector.html#a682173234f20766ce6fc83b8723758e7">gvector::h</a></div><div class="ttdeci">double h</div><div class="ttdoc">Height in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:116</div></div>
<div class="ttc" id="structphysicsstruc_html_a456cb90c106b568e095506546ca8661c"><div class="ttname"><a href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">physicsstruc::ctorque</a></div><div class="ttdeci">Vector ctorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:159</div></div>
<div class="ttc" id="structposstruc_html_a418c92f8b4a6046521b66c6c5e0bcda9"><div class="ttname"><a href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">posstruc::extra</a></div><div class="ttdeci">extrapos extra</div><div class="ttdef"><b>Definition:</b> convertdef.h:403</div></div>
<div class="ttc" id="structphysicsstruc_html_add87b4c17b7d13aba0cc863b10649412"><div class="ttname"><a href="structphysicsstruc.html#add87b4c17b7d13aba0cc863b10649412">physicsstruc::atorque</a></div><div class="ttdeci">Vector atorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:154</div></div>
<div class="ttc" id="structphysicsstruc_html_ac80d8a50b7bdb77ff2ca8338ce10e9f6"><div class="ttname"><a href="structphysicsstruc.html#ac80d8a50b7bdb77ff2ca8338ce10e9f6">physicsstruc::hmomentum</a></div><div class="ttdeci">Vector hmomentum</div><div class="ttdef"><b>Definition:</b> physicsdef.h:158</div></div>
<div class="ttc" id="structlocstruc_html_a5ec93a47e93676058e69d4b95a6fb8b0"><div class="ttname"><a href="structlocstruc.html#a5ec93a47e93676058e69d4b95a6fb8b0">locstruc::bearth</a></div><div class="ttdeci">rvector bearth</div><div class="ttdoc">Earth magnetic vector in ITRS for this time and location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:436</div></div>
<div class="ttc" id="group__mathlib__functions_html_gab90467a79da270c024863945d0cea778"><div class="ttname"><a href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a></div><div class="ttdeci">rvector rv_unitz(double scale)</div><div class="ttdoc">Scaled z row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:140</div></div>
<div class="ttc" id="structdevspecstruc_html_a982244f15316677590502f08b93a5cde"><div class="ttname"><a href="structdevspecstruc.html#a982244f15316677590502f08b93a5cde">devspecstruc::rw_cnt</a></div><div class="ttdeci">uint16_t rw_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1836</div></div>
<div class="ttc" id="structdevspecstruc_html_a15d0534697b3c897807c8ca05893da06"><div class="ttname"><a href="structdevspecstruc.html#a15d0534697b3c897807c8ca05893da06">devspecstruc::tsen</a></div><div class="ttdeci">vector&lt; uint16_t &gt; tsen</div><div class="ttdef"><b>Definition:</b> jsondef.h:1880</div></div>
<div class="ttc" id="group__defs__comp__type_html_gga2966578899236a5f13460ff58d11885ba0e0c9d888d1093cb2dfa6b25cbce19d8"><div class="ttname"><a href="group__defs__comp__type.html#gga2966578899236a5f13460ff58d11885ba0e0c9d888d1093cb2dfa6b25cbce19d8">DeviceType::BUS</a></div><div class="ttdoc">Power Bus. </div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__demlib__planets_html_gaea348e6fd7b22620d80ab0f5643b7fbe"><div class="ttname"><a href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a></div><div class="ttdeci">#define COSMOS_MOON</div><div class="ttdef"><b>Definition:</b> convertdef.h:144</div></div>
<div class="ttc" id="group__demlib__planets_html_ga953a753d5b76c9871e10a848b6a264f0"><div class="ttname"><a href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a></div><div class="ttdeci">#define COSMOS_EARTH</div><div class="ttdef"><b>Definition:</b> convertdef.h:137</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structphysicsstruc_html_adb74fc438f8df74993f2e713d09a4f98"><div class="ttname"><a href="structphysicsstruc.html#adb74fc438f8df74993f2e713d09a4f98">physicsstruc::heat</a></div><div class="ttdeci">float heat</div><div class="ttdef"><b>Definition:</b> physicsdef.h:152</div></div>
<div class="ttc" id="structgeoidpos_html_a58eea1d79a7ffc82af4a43840852b8a1"><div class="ttname"><a href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">geoidpos::s</a></div><div class="ttdeci">gvector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:198</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a1a3ecda68cd4eb9616fdfab5e1c86121"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">Cosmos::Math::Vectors::Vector::normalize</a></div><div class="ttdeci">Vector &amp; normalize(double size=1.)</div><div class="ttdoc">Normalize. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1693</div></div>
<div class="ttc" id="structphysicsstruc_html_a8376eee907f57d5770d848e74b7db5d0"><div class="ttname"><a href="structphysicsstruc.html#a8376eee907f57d5770d848e74b7db5d0">physicsstruc::mass</a></div><div class="ttdeci">float mass</div><div class="ttdef"><b>Definition:</b> physicsdef.h:167</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="group__physicslib__functions_html_gaeb733b60ffc30cd2e2df172a398e59d3"><div class="ttname"><a href="group__physicslib__functions.html#gaeb733b60ffc30cd2e2df172a398e59d3">msis00_density</a></div><div class="ttdeci">double msis00_density(posstruc pos, float f107avg, float f107, float magidx)</div><div class="ttdoc">Calculate atmospheric density. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1664</div></div>
<div class="ttc" id="structcosmosstruc_html_a581d83a1e99811accb5d74efab9877f6"><div class="ttname"><a href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">cosmosstruc::pieces</a></div><div class="ttdeci">vector&lt; piecestruc &gt; pieces</div><div class="ttdoc">Vector of all pieces in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2022</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion_html"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html">Cosmos::Math::Quaternions::Quaternion</a></div><div class="ttdef"><b>Definition:</b> vector.h:471</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="netperf__send_8cpp_html_a7f7e4724cf57d59513b39c5ecc81adc8"><div class="ttname"><a href="netperf__send_8cpp.html#a7f7e4724cf57d59513b39c5ecc81adc8">speed</a></div><div class="ttdeci">float speed</div><div class="ttdef"><b>Definition:</b> netperf_send.cpp:40</div></div>
<div class="ttc" id="structphysicsstruc_html_ad34bd2ae633ea1bdbf01e2f38bf35a36"><div class="ttname"><a href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">physicsstruc::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Time step in seconds. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:141</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="structnodestruc_html_ac887ddcb1fa9ef00f3d26e341c37aa19"><div class="ttname"><a href="structnodestruc.html#ac887ddcb1fa9ef00f3d26e341c37aa19">nodestruc::battcap</a></div><div class="ttdeci">float battcap</div><div class="ttdef"><b>Definition:</b> jsondef.h:1750</div></div>
<div class="ttc" id="structdevspecstruc_html_a10e23c7959230d72a01c1a2a7a1d247e"><div class="ttname"><a href="structdevspecstruc.html#a10e23c7959230d72a01c1a2a7a1d247e">devspecstruc::thst_cnt</a></div><div class="ttdeci">uint16_t thst_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1846</div></div>
<div class="ttc" id="structposstruc_html_a906e802c4aa1f6ac5ad34f5b3a728f6c"><div class="ttname"><a href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">posstruc::geod</a></div><div class="ttdeci">geoidpos geod</div><div class="ttdef"><b>Definition:</b> convertdef.h:400</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga5ba53cb5cf49f51c402a5418fd83405d"><div class="ttname"><a href="group__physicslib__functions.html#ga5ba53cb5cf49f51c402a5418fd83405d">simulate_imu</a></div><div class="ttdeci">void simulate_imu(int index, cosmosstruc *cinfo, locstruc &amp;loc)</div><div class="ttdoc">Simulate IMU. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1467</div></div>
<div class="ttc" id="structcosmosstruc_html_a5b88004fd97b785dbce7c03b8d5d714d"><div class="ttname"><a href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">cosmosstruc::devspec</a></div><div class="ttdeci">devspecstruc devspec</div><div class="ttdoc">Structure for devices (components) special data in node, by type. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2028</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Cosmos::Math::Vectors::Vector</a></div><div class="ttdoc">Vector Class. </div><div class="ttdef"><b>Definition:</b> vector.h:329</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="group__convertlib__constants_html_gab899f53048f1f06a224b5eb1fa369750"><div class="ttname"><a href="group__convertlib__constants.html#gab899f53048f1f06a224b5eb1fa369750">SIGMA</a></div><div class="ttdeci">#define SIGMA</div><div class="ttdoc">SI Stefan-Boltzmann constant. </div><div class="ttdef"><b>Definition:</b> convertdef.h:51</div></div>
<div class="ttc" id="structposstruc_html_acd31426d000874db136ca434f3f62b14"><div class="ttname"><a href="structposstruc.html#acd31426d000874db136ca434f3f62b14">posstruc::icrf</a></div><div class="ttdeci">cartpos icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:395</div></div>
<div class="ttc" id="structdevspecstruc_html_ace81b493dad7e9971a06c2df2d159a8e"><div class="ttname"><a href="structdevspecstruc.html#ace81b493dad7e9971a06c2df2d159a8e">devspecstruc::mtr_cnt</a></div><div class="ttdeci">uint16_t mtr_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1830</div></div>
<div class="ttc" id="group__defs__comp__type_html_gga2966578899236a5f13460ff58d11885bab50339a10e1de285ac99d4c3990b8693"><div class="ttname"><a href="group__defs__comp__type.html#gga2966578899236a5f13460ff58d11885bab50339a10e1de285ac99d4c3990b8693">DeviceType::NONE</a></div><div class="ttdoc">Not a Component. </div></div>
<div class="ttc" id="group__mathlib__functions_html_gacd0bd1cf5e88440f2912f37c9a5e2c4b"><div class="ttname"><a href="group__mathlib__functions.html#gacd0bd1cf5e88440f2912f37c9a5e2c4b">rv_unitx</a></div><div class="ttdeci">rvector rv_unitx(double scale)</div><div class="ttdoc">Scaled x row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:118</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga545ffb5c256d92be8b4f3a60b3b39738"><div class="ttname"><a href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a></div><div class="ttdeci">rvector rv_mmult(rmatrix m, rvector v)</div><div class="ttdoc">Multiply rmatrix by rvector. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:41</div></div>
<div class="ttc" id="structdevspecstruc_html_a4ecea7b999b68dbb9761cdc27c510c2e"><div class="ttname"><a href="structdevspecstruc.html#a4ecea7b999b68dbb9761cdc27c510c2e">devspecstruc::batt</a></div><div class="ttdeci">vector&lt; uint16_t &gt; batt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1852</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga87872977600612c97f2ccd895a18c1a4"><div class="ttname"><a href="group__mathlib__functions.html#ga87872977600612c97f2ccd895a18c1a4">rv_cross</a></div><div class="ttdeci">rvector rv_cross(rvector a, rvector b)</div><div class="ttdoc">Take cross product of two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:363</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion_html_a989a3cc529b15d205d7dcc183cc1cbf4"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html#a989a3cc529b15d205d7dcc183cc1cbf4">Cosmos::Math::Quaternions::Quaternion::irotate</a></div><div class="ttdeci">Vector irotate(const Vector &amp;v)</div><div class="ttdoc">Indirectly rotate a ::Vector using a ::Quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:2460</div></div>
<div class="ttc" id="group__defs__comp__type_html_gga2966578899236a5f13460ff58d11885ba8a54a2c642d79f30fb170e340c68d058"><div class="ttname"><a href="group__defs__comp__type.html#gga2966578899236a5f13460ff58d11885ba8a54a2c642d79f30fb170e340c68d058">DeviceType::PVSTRG</a></div><div class="ttdoc">Photo Voltaic String. </div></div>
<div class="ttc" id="structdevspecstruc_html_ac3e8e19bd76c58933d39e21d0e6c61d2"><div class="ttname"><a href="structdevspecstruc.html#ac3e8e19bd76c58933d39e21d0e6c61d2">devspecstruc::pvstrg</a></div><div class="ttdeci">vector&lt; uint16_t &gt; pvstrg</div><div class="ttdef"><b>Definition:</b> jsondef.h:1867</div></div>
<div class="ttc" id="structcartpos_html_a338924c9e05f128797aedf28a79388f6"><div class="ttname"><a href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">cartpos::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">Velocity. </div><div class="ttdef"><b>Definition:</b> convertdef.h:165</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga06d3f600e1214ab057bf436e127084b7"><div class="ttname"><a href="group__convertlib__functions.html#ga06d3f600e1214ab057bf436e127084b7">topo2azel</a></div><div class="ttdeci">void topo2azel(rvector tpos, float &amp;az, float &amp;el)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3049</div></div>
<div class="ttc" id="structdevspecstruc_html_aa16d7419633cb5ba20f81ec2e2d6b2e7"><div class="ttname"><a href="structdevspecstruc.html#aa16d7419633cb5ba20f81ec2e2d6b2e7">devspecstruc::stt_cnt</a></div><div class="ttdeci">uint16_t stt_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1840</div></div>
<div class="ttc" id="structdevspecstruc_html_a0a1ad1d72c3cfa56e4c0675607d2fddf"><div class="ttname"><a href="structdevspecstruc.html#a0a1ad1d72c3cfa56e4c0675607d2fddf">devspecstruc::ssen</a></div><div class="ttdeci">vector&lt; uint16_t &gt; ssen</div><div class="ttdef"><b>Definition:</b> jsondef.h:1871</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga3fbc03e1df13128b9117e3a24fc6f8b9"><div class="ttname"><a href="group__mathlib__constants.html#ga3fbc03e1df13128b9117e3a24fc6f8b9">RADOF</a></div><div class="ttdeci">#define RADOF(deg)</div><div class="ttdoc">Radians of a Degree value. </div><div class="ttdef"><b>Definition:</b> math/constants.h:29</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga75bef089c2786545431fb3033bbbc8b1"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simulate_hardware </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>cinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">vector&lt; <a class="el" href="structlocstruc.html">locstruc</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>locvec</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulate Hardware data - multiple. </p>
<p>Simulate the behavior of all the hardware in the indicated satellite, for each indicated location in the array. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">cinfo</td><td>Reference to <a class="el" href="structcosmosstruc.html" title="JSON Name Space structure. ">cosmosstruc</a> to use. </td></tr>
    <tr><td class="paramname">locvec</td><td>Array of <a class="el" href="structlocstruc.html">locstruc</a> specifying locations. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;{</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;locvec.size(); ++<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;    {</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, locvec[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;    }</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;}</div><div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga75bef089c2786545431fb3033bbbc8b1"><div class="ttname"><a href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a></div><div class="ttdeci">void simulate_hardware(cosmosstruc *cinfo, vector&lt; locstruc &gt; &amp;locvec)</div><div class="ttdoc">Simulate Hardware data - multiple. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:937</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga1922b090d2c47d135b29ca7d91de0030"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initialize_imu </td>
          <td>(</td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structdevspecstruc.html">devspecstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>devspec</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize IMU simulation. </p>
<p>Initialize IMU simulation.</p>
<p>Set the indicated IMU to a base attitude and position. Use the logic that the current attitude and position are equivalent to the origin of the position frame and the identity attitude. Set all velocities and accelerations to zero. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Index of desired IMU. </td></tr>
    <tr><td class="paramname">devspec</td><td>Pointer to structure holding specs on imu. </td></tr>
    <tr><td class="paramname">loc</td><td>Structure specifying location </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;{</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <span class="keywordflow">if</span> (index &gt;= devspec.<a class="code" href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">imu_cnt</a>)</div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;}</div><div class="ttc" id="structdevspecstruc_html_a8fa600fe999ea5fe82360f12d3a4c918"><div class="ttname"><a href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">devspecstruc::imu_cnt</a></div><div class="ttdeci">uint16_t imu_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1827</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga5ba53cb5cf49f51c402a5418fd83405d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void simulate_imu </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>cinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Simulated IMU values. </p>
<p>Simulated IMU values.</p>
<p>Turn the current attitude into likely values for the indicated IMU. Inject any likely noise due to the nature of the IMU. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">index</td><td>Which IMU to use. </td></tr>
    <tr><td class="paramname">cinfo</td><td>Reference to <a class="el" href="structcosmosstruc.html" title="JSON Name Space structure. ">cosmosstruc</a> to use. </td></tr>
    <tr><td class="paramname">loc</td><td>Structure specifying location </td></tr>
    <tr><td class="paramname">index</td><td>Index of desired IMU. </td></tr>
  </table>
  </dd>
</dl>
<p>Set time of reading</p>
<p>Set raw values for accelerometer and gyros</p>
<p>Set magnetic field in IMU frame </p>
<div class="fragment"><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;{</div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="structquaternion.html">quaternion</a> toimu;</div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;    <span class="keywordflow">if</span> (index &gt;= cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">imu_cnt</a>)</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    toimu = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[index]].imu.align),loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>);</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[index]].imu.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[index]].imu.accel = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(toimu,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[index]].imu.omega = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(toimu,loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[index]].imu.mag = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[index]].imu.align),<a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>,loc.<a class="code" href="structlocstruc.html#a5ec93a47e93676058e69d4b95a6fb8b0">bearth</a>));</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#abdcf31199a01354992ee8b3f6677c9cd">timestamp</a> = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;}</div><div class="ttc" id="structcosmosstruc_html_abdcf31199a01354992ee8b3f6677c9cd"><div class="ttname"><a href="structcosmosstruc.html#abdcf31199a01354992ee8b3f6677c9cd">cosmosstruc::timestamp</a></div><div class="ttdeci">double timestamp</div><div class="ttdoc">Timestamp for last change to data. </div><div class="ttdef"><b>Definition:</b> jsondef.h:1998</div></div>
<div class="ttc" id="structdevspecstruc_html_a8fa600fe999ea5fe82360f12d3a4c918"><div class="ttname"><a href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">devspecstruc::imu_cnt</a></div><div class="ttdeci">uint16_t imu_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1827</div></div>
<div class="ttc" id="structattstruc_html_a7fa9276c6dcd5ac70c1519721956e3a1"><div class="ttname"><a href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">attstruc::geoc</a></div><div class="ttdeci">qatt geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:418</div></div>
<div class="ttc" id="structcartpos_html_a2cfac3e4e3f929074ad589ec7f7b4ef2"><div class="ttname"><a href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">cartpos::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">Acceleration. </div><div class="ttdef"><b>Definition:</b> convertdef.h:167</div></div>
<div class="ttc" id="structquaternion_html"><div class="ttname"><a href="structquaternion.html">quaternion</a></div><div class="ttdoc">Quaternion, scalar last, using x, y, z. </div><div class="ttdef"><b>Definition:</b> vector.h:213</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="structdevspecstruc_html_a607780e080ad5d8230125bc6314be7e0"><div class="ttname"><a href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">devspecstruc::imu</a></div><div class="ttdeci">vector&lt; uint16_t &gt; imu</div><div class="ttdef"><b>Definition:</b> jsondef.h:1860</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="structcosmosstruc_html_a84fcbf5d6772b8c6e1512dd041b3009d"><div class="ttname"><a href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">cosmosstruc::device</a></div><div class="ttdeci">vector&lt; devicestruc &gt; device</div><div class="ttdoc">Vector of all general (common) information for devices (components) in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2026</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="structlocstruc_html_a5ec93a47e93676058e69d4b95a6fb8b0"><div class="ttname"><a href="structlocstruc.html#a5ec93a47e93676058e69d4b95a6fb8b0">locstruc::bearth</a></div><div class="ttdeci">rvector bearth</div><div class="ttdoc">Earth magnetic vector in ITRS for this time and location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:436</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structcosmosstruc_html_a5b88004fd97b785dbce7c03b8d5d714d"><div class="ttname"><a href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">cosmosstruc::devspec</a></div><div class="ttdeci">devspecstruc devspec</div><div class="ttdoc">Structure for devices (components) special data in node, by type. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2028</div></div>
<div class="ttc" id="structposstruc_html_acd31426d000874db136ca434f3f62b14"><div class="ttname"><a href="structposstruc.html#acd31426d000874db136ca434f3f62b14">posstruc::icrf</a></div><div class="ttdeci">cartpos icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:395</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga94983544dca7cd6b87c05c769ce62921"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int32_t pos_accel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Acceleration. </p>
<p>Acceleration.</p>
<p>Calculate the linear forces on the specified sattelite at the specified location/ </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">physics</td><td>Pointer to structure specifying satellite. </td></tr>
    <tr><td class="paramname">loc</td><td>Structure specifying location. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;{</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;    <span class="keywordtype">double</span> radius;</div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <a class="code" href="structrvector.html">rvector</a> ctpos, da, tda;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;    <a class="code" href="structcartpos.html">cartpos</a> <a class="code" href="structbodypos.html">bodypos</a>;</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    radius = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;</div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="comment">// Earth gravity</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;    <span class="comment">// Calculate Geocentric acceleration vector</span></div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;    <span class="keywordflow">if</span> (radius &gt; <a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>)</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;    {</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;        <span class="comment">// Start with gravity vector in ITRS</span></div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;        da = <a class="code" href="group__physicslib__functions.html#ga5331c107173baab1128d6db147e4e03d">gravity_accel</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>,<a class="code" href="group__physicslib__constants.html#gae2ae382fb1f7f7db16abd965e7eef950">GRAVITY_EGM2008_NORM</a>,12);</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="comment">// Correct for earth rotation, polar motion, precession, nutation</span></div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        da = <a class="code" href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a83d75b661ea8d1acdbecc3422781b022">e2j</a>,da);</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    }</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;    {</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;        <span class="comment">// Simple 2 body</span></div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;        da = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-<a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a>/(radius*radius*radius),loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    }</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <span class="comment">// Sun gravity</span></div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <span class="comment">// Calculate Satellite to Sun vector</span></div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;    ctpos = <a class="code" href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a>(<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#ae783d7e26c12307622e0c35799c474a8">sun2earth</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>),loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    radius = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(ctpos);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;    da = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(<a class="code" href="group__convertlib__constants.html#ga160138dddfa826f1cf30dd564993ada0">GSUN</a>/(radius*radius*radius),ctpos);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="comment">// Adjust for acceleration of frame</span></div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;    radius = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#ae783d7e26c12307622e0c35799c474a8">sun2earth</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;    da = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(<a class="code" href="group__convertlib__constants.html#ga160138dddfa826f1cf30dd564993ada0">GSUN</a>/(radius*radius*radius),loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#ae783d7e26c12307622e0c35799c474a8">sun2earth</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    tda = da;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;    <span class="comment">// Moon gravity</span></div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <span class="comment">// Calculate Satellite to Moon vector</span></div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;    bodypos.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a> = <a class="code" href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#ae783d7e26c12307622e0c35799c474a8">sun2earth</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#afc26f73e609f67fa861774e05e26646d">sun2moon</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;    ctpos = <a class="code" href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a>(bodypos.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    radius = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(ctpos);</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;    da = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(<a class="code" href="group__convertlib__constants.html#ga650719c52573a8c964ea7fc571312f7a">GMOON</a>/(radius*radius*radius),ctpos);</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;</div><div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;    <span class="comment">// Adjust for acceleration of frame due to moon</span></div><div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;    radius = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(bodypos.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    da = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(<a class="code" href="group__convertlib__constants.html#ga650719c52573a8c964ea7fc571312f7a">GMOON</a>/(radius*radius*radius),bodypos.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>);</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;    tda = <a class="code" href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a>(tda,da);</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;    <span class="comment">/*</span></div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;<span class="comment">// Jupiter gravity</span></div><div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;<span class="comment">// Calculate Satellite to Jupiter vector</span></div><div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;<span class="comment">jplpos(JPL_EARTH,JPL_JUPITER,loc.pos.extra.tt,(cartpos *)&amp;bodypos);</span></div><div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160;<span class="comment">ctpos = rv_sub(bodypos.s,loc.pos.eci.s);</span></div><div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;<span class="comment">radius = length_rv(ctpos);</span></div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;<span class="comment"></span></div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;<span class="comment">// Calculate acceleration</span></div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;<span class="comment">da = rv_smult(GJUPITER/(radius*radius*radius),ctpos);</span></div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;<span class="comment">//loc.pos.eci.a = rv_add(loc.pos.eci.a,da);</span></div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;<span class="comment">*/</span></div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;    <span class="comment">// Atmospheric drag</span></div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(physics.<a class="code" href="structphysicsstruc.html#a789b490c787fd0e03e55f824ca49b3e6">adrag</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>()))</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;    {</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;        da = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>),physics.<a class="code" href="structphysicsstruc.html#a789b490c787fd0e03e55f824ca49b3e6">adrag</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;    }</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    <span class="comment">// Solar drag</span></div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(physics.<a class="code" href="structphysicsstruc.html#ae7eecf12ac3fd14b64c970481128d2ff">rdrag</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>()))</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;    {</div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;        da = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>),physics.<a class="code" href="structphysicsstruc.html#ae7eecf12ac3fd14b64c970481128d2ff">rdrag</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;        loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;    }</div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    <span class="comment">// Fictitious drag</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(physics.<a class="code" href="structphysicsstruc.html#a10abedb559b220cf505f535298534934">fdrag</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>()))</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    {</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;        da = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>),physics.<a class="code" href="structphysicsstruc.html#a10abedb559b220cf505f535298534934">fdrag</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;        loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a> = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>,da);</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    }</div><div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;</div><div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    iretn = <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;loc);</div><div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    <span class="keywordflow">if</span> (iretn &lt; 0)</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    {</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    }</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">if</span> (std::isnan(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]))</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;    {</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;        loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = 0.;</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160;}</div><div class="ttc" id="structphysicsstruc_html_a10abedb559b220cf505f535298534934"><div class="ttname"><a href="structphysicsstruc.html#a10abedb559b220cf505f535298534934">physicsstruc::fdrag</a></div><div class="ttdeci">Vector fdrag</div><div class="ttdef"><b>Definition:</b> physicsdef.h:160</div></div>
<div class="ttc" id="group__physicslib__constants_html_gae2ae382fb1f7f7db16abd965e7eef950"><div class="ttname"><a href="group__physicslib__constants.html#gae2ae382fb1f7f7db16abd965e7eef950">GRAVITY_EGM2008_NORM</a></div><div class="ttdeci">#define GRAVITY_EGM2008_NORM</div><div class="ttdef"><b>Definition:</b> physicsdef.h:70</div></div>
<div class="ttc" id="structextrapos_html_ae783d7e26c12307622e0c35799c474a8"><div class="ttname"><a href="structextrapos.html#ae783d7e26c12307622e0c35799c474a8">extrapos::sun2earth</a></div><div class="ttdeci">cartpos sun2earth</div><div class="ttdef"><b>Definition:</b> convertdef.h:370</div></div>
<div class="ttc" id="group__mathlib__functions_html_gad3d78ceb8af40ce126896a854dc2bb22"><div class="ttname"><a href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a></div><div class="ttdeci">rvector rv_add(rvector a, rvector b)</div><div class="ttdoc">Add two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:299</div></div>
<div class="ttc" id="structphysicsstruc_html_a789b490c787fd0e03e55f824ca49b3e6"><div class="ttname"><a href="structphysicsstruc.html#a789b490c787fd0e03e55f824ca49b3e6">physicsstruc::adrag</a></div><div class="ttdeci">Vector adrag</div><div class="ttdef"><b>Definition:</b> physicsdef.h:161</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structcartpos_html_a2cfac3e4e3f929074ad589ec7f7b4ef2"><div class="ttname"><a href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">cartpos::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">Acceleration. </div><div class="ttdef"><b>Definition:</b> convertdef.h:167</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="structcartpos_html"><div class="ttname"><a href="structcartpos.html">cartpos</a></div><div class="ttdoc">Cartesian full position structure. </div><div class="ttdef"><b>Definition:</b> convertdef.h:158</div></div>
<div class="ttc" id="group__mathlib__functions_html_gac6a350c8823f5ad93e80299ab777f602"><div class="ttname"><a href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a></div><div class="ttdeci">double length_rv(rvector v)</div><div class="ttdoc">Length of row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:748</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a74bd3149cec03a4abcbbca0103e6e634"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">Cosmos::Math::Vectors::Vector::to_rv</a></div><div class="ttdeci">rvector to_rv()</div><div class="ttdoc">Convert from cvector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1638</div></div>
<div class="ttc" id="structextrapos_html_afc26f73e609f67fa861774e05e26646d"><div class="ttname"><a href="structextrapos.html#afc26f73e609f67fa861774e05e26646d">extrapos::sun2moon</a></div><div class="ttdeci">cartpos sun2moon</div><div class="ttdef"><b>Definition:</b> convertdef.h:371</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga5331c107173baab1128d6db147e4e03d"><div class="ttname"><a href="group__physicslib__functions.html#ga5331c107173baab1128d6db147e4e03d">gravity_accel</a></div><div class="ttdeci">rvector gravity_accel(posstruc pos, int model, uint32_t degree)</div><div class="ttdoc">Spherical harmonic gravitational vector. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:65</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga225f033481a4247d0a2853d327cc6f65"><div class="ttname"><a href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a></div><div class="ttdeci">#define GM</div><div class="ttdoc">SI Mass * Gravitational Constant for Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:79</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="structbodypos_html"><div class="ttname"><a href="structbodypos.html">bodypos</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:333</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="structphysicsstruc_html_ae7eecf12ac3fd14b64c970481128d2ff"><div class="ttname"><a href="structphysicsstruc.html#ae7eecf12ac3fd14b64c970481128d2ff">physicsstruc::rdrag</a></div><div class="ttdeci">Vector rdrag</div><div class="ttdef"><b>Definition:</b> physicsdef.h:162</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="structposstruc_html_a418c92f8b4a6046521b66c6c5e0bcda9"><div class="ttname"><a href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">posstruc::extra</a></div><div class="ttdeci">extrapos extra</div><div class="ttdef"><b>Definition:</b> convertdef.h:403</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga650719c52573a8c964ea7fc571312f7a"><div class="ttname"><a href="group__convertlib__constants.html#ga650719c52573a8c964ea7fc571312f7a">GMOON</a></div><div class="ttdeci">#define GMOON</div><div class="ttdoc">SI Mass * Gravitational Constant for Moon. </div><div class="ttdef"><b>Definition:</b> convertdef.h:81</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="structextrapos_html_a83d75b661ea8d1acdbecc3422781b022"><div class="ttname"><a href="structextrapos.html#a83d75b661ea8d1acdbecc3422781b022">extrapos::e2j</a></div><div class="ttdeci">rmatrix e2j</div><div class="ttdoc">Transform from Geocentric to ICRF. </div><div class="ttdef"><b>Definition:</b> convertdef.h:359</div></div>
<div class="ttc" id="group__mathlib__functions_html_gac195169be6c06261b9d49bac80a003d2"><div class="ttname"><a href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a></div><div class="ttdeci">rvector rv_sub(rvector a, rvector b)</div><div class="ttdoc">Subtract two vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:315</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga545ffb5c256d92be8b4f3a60b3b39738"><div class="ttname"><a href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a></div><div class="ttdeci">rvector rv_mmult(rmatrix m, rvector v)</div><div class="ttdoc">Multiply rmatrix by rvector. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:41</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga160138dddfa826f1cf30dd564993ada0"><div class="ttname"><a href="group__convertlib__constants.html#ga160138dddfa826f1cf30dd564993ada0">GSUN</a></div><div class="ttdeci">#define GSUN</div><div class="ttdoc">SI Mass * Gravitational Constant for Sun. </div><div class="ttdef"><b>Definition:</b> convertdef.h:83</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae062777be16aa6b1810950abd2bccfef"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void att_accel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Torque. </p>
<p>Torque.</p>
<p>Calculate the torque forces on the specified satellite at the specified location/ </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">physics</td><td>Pointer to structure specifying satellite. </td></tr>
    <tr><td class="paramname">loc</td><td>Structure specifying location. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;{</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;<span class="comment">//    rvector ue, ta, tv;</span></div><div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;<span class="comment">//    rvector ttorque;</span></div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a> ue, <a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa35367b61876fa8b94e4929d86439d761">ta</a>, tv;</div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;    <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a> ttorque;</div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;    <a class="code" href="structrmatrix.html">rmatrix</a> mom;</div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <a class="code" href="group__convertlib__functions.html#gae6df1f04476988717a5b008ed97a5997">att_extra</a>(&amp;loc);</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;    ttorque = physics.<a class="code" href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">ctorque</a>;</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;    <span class="comment">// Now calculate Gravity Gradient Torque</span></div><div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160;    <span class="comment">// Unit vector towards earth, rotated into body frame</span></div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;<span class="comment">//    ue = irotate((loc.att.icrf.s),rv_smult(-1.,loc.pos.eci.s));</span></div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;<span class="comment">//    normalize_rv(ue);</span></div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    ue = <a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html">Quaternion</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>).<a class="code" href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html#a989a3cc529b15d205d7dcc183cc1cbf4">irotate</a>(-1. * <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>)).<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">normalize</a>();</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;<span class="comment">//    physics.gtorque = rv_smult((3.*GM/pow(loc.pos.geos.s.r,3.)),rv_cross(ue,rv_mult(physics.moi,ue)));</span></div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a973d7db7f370560e20d4caded2e6b5a7">gtorque</a> = (3. * <a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a> / pow(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>,3.)) * ue.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#adcbe4b3b64c5a54d5341f36c886b80df">cross</a>(physics.<a class="code" href="structphysicsstruc.html#a879ca2f455b3144801f20c70c9d37aee">moi</a> * ue);</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;<span class="comment">//    ttorque = rv_add(ttorque,physics.gtorque);</span></div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;    ttorque += physics.<a class="code" href="structphysicsstruc.html#a973d7db7f370560e20d4caded2e6b5a7">gtorque</a>;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    <span class="comment">// Atmospheric and solar torque</span></div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    <span class="comment">//  ttorque = rv_add(ttorque,physics.atorque);</span></div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    <span class="comment">//  ttorque = rv_add(ttorque,physics.rtorque);</span></div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <span class="comment">// Torque from rotational effects</span></div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;    <span class="comment">// Moment of Inertia in Body frame</span></div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    mom = <a class="code" href="group__mathlib__functions.html#ga9889205b84117e85ee849fea0e1cdcc6">rm_diag</a>(physics.<a class="code" href="structphysicsstruc.html#a879ca2f455b3144801f20c70c9d37aee">moi</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    <span class="comment">// Attitude rate in Body frame</span></div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    tv = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>,loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>);</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    <span class="comment">// Torque from cross product of angular velocity and angular momentum</span></div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;<span class="comment">//    physics.htorque = rv_smult(-1., rv_cross(tv,rv_add(rv_mmult(mom,tv),physics.hmomentum)));</span></div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;<span class="comment">//    ttorque = rv_add(ttorque,physics.htorque);</span></div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a3b9b186f119cdf497016fb1740ca9b2a">htorque</a> = -1. * tv.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#adcbe4b3b64c5a54d5341f36c886b80df">cross</a>(<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(<a class="code" href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a>(mom, tv.to_rv())) + physics.<a class="code" href="structphysicsstruc.html#ac80d8a50b7bdb77ff2ca8338ce10e9f6">hmomentum</a>);</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;    ttorque += physics.<a class="code" href="structphysicsstruc.html#a3b9b186f119cdf497016fb1740ca9b2a">htorque</a>;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    <span class="comment">// Convert torque into accelerations, doing math in Body frame</span></div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;    <span class="comment">// I x alpha = tau, so alpha = I inverse x tau</span></div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;<span class="comment">//    ta = rv_mmult(rm_inverse(mom),ttorque);</span></div><div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;    ta = <a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Vector</a>(<a class="code" href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a>(<a class="code" href="group__mathlib__functions.html#ga44624ab3e1ddce6484ab2b785f9acef2">rm_inverse</a>(mom),ttorque.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>()));</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;    <span class="comment">// Convert body frame acceleration back to other frames.</span></div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>), ta.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">topo</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">topo</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>), ta.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>), ta.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>), ta.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#af07b0ae5546abe7a6743c7045237a824">selc</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#af07b0ae5546abe7a6743c7045237a824">selc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>), ta.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>());</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;}</div><div class="ttc" id="structphysicsstruc_html_a879ca2f455b3144801f20c70c9d37aee"><div class="ttname"><a href="structphysicsstruc.html#a879ca2f455b3144801f20c70c9d37aee">physicsstruc::moi</a></div><div class="ttdeci">Vector moi</div><div class="ttdef"><b>Definition:</b> physicsdef.h:164</div></div>
<div class="ttc" id="structspherpos_html_ad2978f8e060c698806bb76a9185e55f4"><div class="ttname"><a href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">spherpos::s</a></div><div class="ttdeci">svector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:218</div></div>
<div class="ttc" id="structattstruc_html_a7fa9276c6dcd5ac70c1519721956e3a1"><div class="ttname"><a href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">attstruc::geoc</a></div><div class="ttdeci">qatt geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:418</div></div>
<div class="ttc" id="eci2kep__test_8cpp_html_aa94081298ab2dfd0f261cce6c203d9aaa35367b61876fa8b94e4929d86439d761"><div class="ttname"><a href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa35367b61876fa8b94e4929d86439d761">ta</a></div><div class="ttdef"><b>Definition:</b> eci2kep_test.cpp:33</div></div>
<div class="ttc" id="structphysicsstruc_html_a973d7db7f370560e20d4caded2e6b5a7"><div class="ttname"><a href="structphysicsstruc.html#a973d7db7f370560e20d4caded2e6b5a7">physicsstruc::gtorque</a></div><div class="ttdeci">Vector gtorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:156</div></div>
<div class="ttc" id="structposstruc_html_ab9915207eb8422ed2853bc16f0914c50"><div class="ttname"><a href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">posstruc::geos</a></div><div class="ttdeci">spherpos geos</div><div class="ttdef"><b>Definition:</b> convertdef.h:402</div></div>
<div class="ttc" id="structqatt_html_a1992b6fe91058cb7e0b2629dbef5b444"><div class="ttname"><a href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">qatt::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">2nd derivative: Alpha - acceleration </div><div class="ttdef"><b>Definition:</b> convertdef.h:283</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_adcbe4b3b64c5a54d5341f36c886b80df"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#adcbe4b3b64c5a54d5341f36c886b80df">Cosmos::Math::Vectors::Vector::cross</a></div><div class="ttdeci">Vector cross(Vector b)</div><div class="ttdoc">Cross product. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1667</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a74bd3149cec03a4abcbbca0103e6e634"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">Cosmos::Math::Vectors::Vector::to_rv</a></div><div class="ttdeci">rvector to_rv()</div><div class="ttdoc">Convert from cvector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1638</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga225f033481a4247d0a2853d327cc6f65"><div class="ttname"><a href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a></div><div class="ttdeci">#define GM</div><div class="ttdoc">SI Mass * Gravitational Constant for Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:79</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga44624ab3e1ddce6484ab2b785f9acef2"><div class="ttname"><a href="group__mathlib__functions.html#ga44624ab3e1ddce6484ab2b785f9acef2">rm_inverse</a></div><div class="ttdeci">rmatrix rm_inverse(rmatrix m)</div><div class="ttdoc">Inverse of rmatrix. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:897</div></div>
<div class="ttc" id="structphysicsstruc_html_a3b9b186f119cdf497016fb1740ca9b2a"><div class="ttname"><a href="structphysicsstruc.html#a3b9b186f119cdf497016fb1740ca9b2a">physicsstruc::htorque</a></div><div class="ttdeci">Vector htorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:157</div></div>
<div class="ttc" id="structattstruc_html_af07b0ae5546abe7a6743c7045237a824"><div class="ttname"><a href="structattstruc.html#af07b0ae5546abe7a6743c7045237a824">attstruc::selc</a></div><div class="ttdeci">qatt selc</div><div class="ttdef"><b>Definition:</b> convertdef.h:419</div></div>
<div class="ttc" id="structrmatrix_html"><div class="ttname"><a href="structrmatrix.html">rmatrix</a></div><div class="ttdoc">3x3 element generic matrix </div><div class="ttdef"><b>Definition:</b> matrix.h:41</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga9889205b84117e85ee849fea0e1cdcc6"><div class="ttname"><a href="group__mathlib__functions.html#ga9889205b84117e85ee849fea0e1cdcc6">rm_diag</a></div><div class="ttdeci">rmatrix rm_diag(rvector a)</div><div class="ttdoc">Diagonal rmatrix Creates an rmatrix whose diagonal is filled with the supplied rvector. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:97</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="structphysicsstruc_html_a456cb90c106b568e095506546ca8661c"><div class="ttname"><a href="structphysicsstruc.html#a456cb90c106b568e095506546ca8661c">physicsstruc::ctorque</a></div><div class="ttdeci">Vector ctorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:159</div></div>
<div class="ttc" id="structphysicsstruc_html_ac80d8a50b7bdb77ff2ca8338ce10e9f6"><div class="ttname"><a href="structphysicsstruc.html#ac80d8a50b7bdb77ff2ca8338ce10e9f6">physicsstruc::hmomentum</a></div><div class="ttdeci">Vector hmomentum</div><div class="ttdef"><b>Definition:</b> physicsdef.h:158</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a1a3ecda68cd4eb9616fdfab5e1c86121"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a1a3ecda68cd4eb9616fdfab5e1c86121">Cosmos::Math::Vectors::Vector::normalize</a></div><div class="ttdeci">Vector &amp; normalize(double size=1.)</div><div class="ttdoc">Normalize. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1693</div></div>
<div class="ttc" id="structattstruc_html_a7a07ed22deee4d7ce41c4b97aeaaa836"><div class="ttname"><a href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">attstruc::topo</a></div><div class="ttdeci">qatt topo</div><div class="ttdef"><b>Definition:</b> convertdef.h:416</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion_html"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html">Cosmos::Math::Quaternions::Quaternion</a></div><div class="ttdef"><b>Definition:</b> vector.h:471</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="group__convertlib__functions_html_gae6df1f04476988717a5b008ed97a5997"><div class="ttname"><a href="group__convertlib__functions.html#gae6df1f04476988717a5b008ed97a5997">att_extra</a></div><div class="ttdeci">void att_extra(locstruc *loc)</div><div class="ttdoc">Calculate Extra attitude information. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1556</div></div>
<div class="ttc" id="structsvector_html_acb2e6b4694745ef3cf790e806b7217fa"><div class="ttname"><a href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">svector::r</a></div><div class="ttdeci">double r</div><div class="ttdoc">Radius in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:99</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html">Cosmos::Math::Vectors::Vector</a></div><div class="ttdoc">Vector Class. </div><div class="ttdef"><b>Definition:</b> vector.h:329</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga545ffb5c256d92be8b4f3a60b3b39738"><div class="ttname"><a href="group__mathlib__functions.html#ga545ffb5c256d92be8b4f3a60b3b39738">rv_mmult</a></div><div class="ttdeci">rvector rv_mmult(rmatrix m, rvector v)</div><div class="ttdoc">Multiply rmatrix by rvector. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:41</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion_html_a989a3cc529b15d205d7dcc183cc1cbf4"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_quaternions_1_1_quaternion.html#a989a3cc529b15d205d7dcc183cc1cbf4">Cosmos::Math::Quaternions::Quaternion::irotate</a></div><div class="ttdeci">Vector irotate(const Vector &amp;v)</div><div class="ttdoc">Indirectly rotate a ::Vector using a ::Quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:2460</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae6c163707315970f6172130774af2128"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void geod2icrf </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structposstruc.html">posstruc</a> *&#160;</td>
          <td class="paramname"><em>pos</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Geodetic to Heliocentric. </p>

</div>
</div>
<a class="anchor" id="ga3834eb96d67f08087f079641924b1c50"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double msis86_density </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structposstruc.html">posstruc</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>f107avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>f107</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>magidx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="gaeb733b60ffc30cd2e2df172a398e59d3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double msis00_density </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structposstruc.html">posstruc</a>&#160;</td>
          <td class="paramname"><em>pos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>f107avg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>f107</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">float&#160;</td>
          <td class="paramname"><em>magidx</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate atmospheric density. </p>
<p>Calculate atmospheric density at indicated Latitute/Longitude/Altitude using the NRLMSISE-00 atmospheric model. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pos</td><td>Structure indicating position </td></tr>
    <tr><td class="paramname">f107avg</td><td>Average 10.7 cm solar flux </td></tr>
    <tr><td class="paramname">f107</td><td>Current 10.7 cm solar flux </td></tr>
    <tr><td class="paramname">magidx</td><td>Ap daily geomagnetic index </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Density in kg/m3 </dd></dl>
<div class="fragment"><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;{</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnrlmsise__output.html">nrlmsise_output</a> <a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>;</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnrlmsise__input.html">nrlmsise_input</a> input;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keyword">struct </span><a class="code" href="structnrlmsise__flags.html">nrlmsise_flags</a> flags = {</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;    {0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1},</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    {0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.},</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    {0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.,0.}};</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordtype">int</span> year, month;</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;    <span class="keywordtype">double</span> day, doy;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> lastmjd = 0.;</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> lastdensity = 0.;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    <span class="keyword">static</span> <span class="keywordtype">double</span> lastperiod = 0.;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;    <span class="keywordflow">if</span> (lastperiod != 0.)</div><div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;    {</div><div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;        <span class="keywordflow">if</span> (fabs(lastperiod) &gt; (pos.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a064cf82b0d02843a3ab36d0c7e966889">utc</a>-lastmjd))</div><div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;        {</div><div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160;            <span class="keywordflow">return</span> (lastdensity*(1.+(.001*(pos.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a064cf82b0d02843a3ab36d0c7e966889">utc</a>-lastmjd)/lastperiod)));</div><div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;        }</div><div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;    }</div><div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;</div><div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;    <a class="code" href="group__timelib__functions.html#ga2542e9bb44fb032bb34866d0d09f8cfc">mjd2ymd</a>(pos.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a064cf82b0d02843a3ab36d0c7e966889">utc</a>,year,month,day,doy);</div><div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;    input.doy = (int32_t)doy;</div><div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;    input.g_lat = pos.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>*180./<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>;</div><div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;    input.g_long = pos.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a>*180./<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>;</div><div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;    input.alt = pos.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> / 1000.;</div><div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;    input.sec = (doy - input.doy)*86400.;;</div><div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;    input.lst = input.sec / 3600. + input.g_long / 15.;</div><div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;    input.f107A = f107avg;</div><div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;    input.f107 = f107;</div><div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;    input.ap = magidx;</div><div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;    <a class="code" href="nrlmsise-00_8cpp.html#a641d02c0e964627af5da468d4e07b87a">gtd7d</a>(&amp;input,&amp;flags,&amp;<a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>);</div><div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;</div><div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;    <span class="keywordflow">if</span> (lastdensity != 0. &amp;&amp; lastdensity != <a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>.d[5])</div><div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        lastperiod = (pos.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a064cf82b0d02843a3ab36d0c7e966889">utc</a>-lastmjd)*.001*<a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>.d[5]/(<a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>.d[5]-lastdensity);</div><div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;    lastmjd = pos.<a class="code" href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">extra</a>.<a class="code" href="structextrapos.html#a064cf82b0d02843a3ab36d0c7e966889">utc</a>;</div><div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;    lastdensity = <a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>.d[5];</div><div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;    <span class="keywordflow">return</span>((<span class="keywordtype">double</span>)<a class="code" href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a>.d[5]);</div><div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;}</div><div class="ttc" id="structextrapos_html_a064cf82b0d02843a3ab36d0c7e966889"><div class="ttname"><a href="structextrapos.html#a064cf82b0d02843a3ab36d0c7e966889">extrapos::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Coordinated Universal Time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:347</div></div>
<div class="ttc" id="nrlmsise-00_8cpp_html_a641d02c0e964627af5da468d4e07b87a"><div class="ttname"><a href="nrlmsise-00_8cpp.html#a641d02c0e964627af5da468d4e07b87a">gtd7d</a></div><div class="ttdeci">void gtd7d(struct nrlmsise_input *input, struct nrlmsise_flags *flags, struct nrlmsise_output *output)</div><div class="ttdef"><b>Definition:</b> nrlmsise-00.cpp:1097</div></div>
<div class="ttc" id="structnrlmsise__output_html"><div class="ttname"><a href="structnrlmsise__output.html">nrlmsise_output</a></div><div class="ttdef"><b>Definition:</b> nrlmsise-00.h:167</div></div>
<div class="ttc" id="agent_8cpp_html_af41c9d01b4378f52371581950f5bbca6"><div class="ttname"><a href="agent_8cpp.html#af41c9d01b4378f52371581950f5bbca6">output</a></div><div class="ttdeci">string output</div><div class="ttdef"><b>Definition:</b> agent.cpp:69</div></div>
<div class="ttc" id="group__timelib__functions_html_ga2542e9bb44fb032bb34866d0d09f8cfc"><div class="ttname"><a href="group__timelib__functions.html#ga2542e9bb44fb032bb34866d0d09f8cfc">mjd2ymd</a></div><div class="ttdeci">int32_t mjd2ymd(double mjd, int32_t &amp;year, int32_t &amp;month, double &amp;day)</div><div class="ttdoc">MJD to Year, Month, and Decimal Day (overloaded) </div><div class="ttdef"><b>Definition:</b> timelib.cpp:217</div></div>
<div class="ttc" id="structgvector_html_a682173234f20766ce6fc83b8723758e7"><div class="ttname"><a href="structgvector.html#a682173234f20766ce6fc83b8723758e7">gvector::h</a></div><div class="ttdeci">double h</div><div class="ttdoc">Height in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:116</div></div>
<div class="ttc" id="structposstruc_html_a418c92f8b4a6046521b66c6c5e0bcda9"><div class="ttname"><a href="structposstruc.html#a418c92f8b4a6046521b66c6c5e0bcda9">posstruc::extra</a></div><div class="ttdeci">extrapos extra</div><div class="ttdef"><b>Definition:</b> convertdef.h:403</div></div>
<div class="ttc" id="structgvector_html_a0bfcf58a2e1347b2acf503e503f1c93d"><div class="ttname"><a href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">gvector::lon</a></div><div class="ttdeci">double lon</div><div class="ttdoc">Longitude in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:114</div></div>
<div class="ttc" id="structgeoidpos_html_a58eea1d79a7ffc82af4a43840852b8a1"><div class="ttname"><a href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">geoidpos::s</a></div><div class="ttdeci">gvector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:198</div></div>
<div class="ttc" id="structgvector_html_a76ed76078ce8f825c8c1e783b0a3b7c2"><div class="ttname"><a href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">gvector::lat</a></div><div class="ttdeci">double lat</div><div class="ttdoc">Latitude in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:112</div></div>
<div class="ttc" id="structposstruc_html_a906e802c4aa1f6ac5ad34f5b3a728f6c"><div class="ttname"><a href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">posstruc::geod</a></div><div class="ttdeci">geoidpos geod</div><div class="ttdef"><b>Definition:</b> convertdef.h:400</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="structnrlmsise__input_html"><div class="ttname"><a href="structnrlmsise__input.html">nrlmsise_input</a></div><div class="ttdef"><b>Definition:</b> nrlmsise-00.h:127</div></div>
<div class="ttc" id="structnrlmsise__flags_html"><div class="ttname"><a href="structnrlmsise__flags.html">nrlmsise_flags</a></div><div class="ttdef"><b>Definition:</b> nrlmsise-00.h:67</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga906fb239ba711fa8af6e8b6ea0e8a883"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void orbit_init_tle </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;{</div><div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;</div><div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;    uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;</div><div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;    <span class="comment">// Munge time step to fit local granularity</span></div><div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> = 86400.*((utc + <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>/86400.)-utc);</div><div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160;</div><div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    cinfo-&gt;physics.dt = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;    cinfo-&gt;physics.dtj = cinfo-&gt;physics.dt/86400.;</div><div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;    cinfo-&gt;physics.mode = mode;</div><div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;</div><div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> loc;</div><div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(loc);</div><div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;</div><div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a>(utc,cinfo-&gt;tle,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>);</div><div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;    <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;loc);</div><div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;</div><div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;    <span class="comment">// Initial attitude</span></div><div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;    cinfo-&gt;physics.ftorque = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;    <span class="keywordflow">switch</span> (cinfo-&gt;physics.mode)</div><div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;    {</div><div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;    <span class="comment">//case 0:</span></div><div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;    <span class="comment">//  loc.att.icrf.utc = loc.utc;</span></div><div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;    <span class="comment">//  loc.att.icrf.s = q_eye();</span></div><div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;    <span class="comment">//  loc.att.icrf.v = loc.att.icrf.a = rv_zero();</span></div><div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    <span class="comment">//  att_icrf(&amp;loc);</span></div><div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;    <span class="comment">//  break;</span></div><div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a>(-<a class="code" href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a>);</div><div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01749"></a><span class="lineno"> 1749</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;faces[abs(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].face_idx[0])].normal.to_rv(),<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>));</div><div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;        <span class="comment">//  loc.att.icrf.s = rm_change_between_rv(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].normal,rv_smult(-1.,loc.pos.icrf.s));</span></div><div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;loc);</div><div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160;    }</div><div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;</div><div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160;</div><div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, loc);</div><div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;    <span class="comment">// Initialize hardware,</span></div><div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160;    <span class="comment">// ?? is this only for simulation?</span></div><div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a>(cinfo,loc);</div><div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;</div><div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;    <span class="comment">// ?? check</span></div><div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, loc);</div><div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;    <span class="comment">//  groundstations(cinfo,&amp;loc);</span></div><div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160;</div><div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0] = loc;</div><div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;</div><div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160;    <span class="comment">// Position at t0-dt</span></div><div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <span class="keywordflow">for</span> (i=1; i&lt;4; i++)</div><div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;    {</div><div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i-1];</div><div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> -= <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> / 86400.;</div><div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a>(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i].utc,cinfo-&gt;tle,<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>);</div><div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160;</div><div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i-1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>;</div><div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160;</div><div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;        <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160;    }</div><div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    cinfo-&gt;physics.mjdbase = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;</div><div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;    cinfo-&gt;timestamp = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;}</div><div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga75bef089c2786545431fb3033bbbc8b1"><div class="ttname"><a href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a></div><div class="ttdeci">void simulate_hardware(cosmosstruc *cinfo, vector&lt; locstruc &gt; &amp;locvec)</div><div class="ttdoc">Simulate Hardware data - multiple. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:937</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga5fffad1b57bb62f03d4037deaed8735b"><div class="ttname"><a href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a></div><div class="ttdeci">const double DPI2</div><div class="ttdoc">Double precision PI/2. </div><div class="ttdef"><b>Definition:</b> math/constants.h:18</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a315541d00c2de86f212c310d26527512"><div class="ttname"><a href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a></div><div class="ttdeci">quaternion q_change_around_y(double angle)</div><div class="ttdoc">Rotation quaternion for Y axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1435</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa6e2765f7d85e40f4ef5c960fb04572c"><div class="ttname"><a href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a></div><div class="ttdeci">static locstruc sloc[MAXGJORDER+2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:47</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga076acc0ac689c3de1a49720ec3fc5f76"><div class="ttname"><a href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a></div><div class="ttdeci">void hardware_init_eci(cosmosstruc *cinfo, locstruc &amp;loc)</div><div class="ttdoc">Initialize Hardware. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:877</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structposstruc_html_acd31426d000874db136ca434f3f62b14"><div class="ttname"><a href="structposstruc.html#acd31426d000874db136ca434f3f62b14">posstruc::icrf</a></div><div class="ttdeci">cartpos icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:395</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8f7230867b57198344a49faeab0a83f2"><div class="ttname"><a href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a></div><div class="ttdeci">int lines2eci(double utc, vector&lt; tlestruc &gt;lines, cartpos &amp;eci)</div><div class="ttdoc">Return position from TLE set. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3073</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4be21934f3c809f9c40cc7afea6b8c7e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void orbit_init_eci </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcartpos.html">cartpos</a>&#160;</td>
          <td class="paramname"><em>ipos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;{</div><div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160;    <a class="code" href="structkepstruc.html">kepstruc</a> kep;</div><div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;    <span class="keywordtype">double</span> dea;</div><div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;    uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;</div><div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;    <span class="comment">// Munge time step to fit local granularity</span></div><div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;    <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> = 86400.*((utc + <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>/86400.)-utc);</div><div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160;</div><div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;    cinfo-&gt;physics.dt = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;    cinfo-&gt;physics.dtj = cinfo-&gt;physics.dt/86400.;</div><div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;    cinfo-&gt;physics.mode = mode;</div><div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160;</div><div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> loc;</div><div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(loc);</div><div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160;</div><div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a> = ipos;</div><div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;    loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> = loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = utc;</div><div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;    <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;loc);</div><div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;    <a class="code" href="group__convertlib__functions.html#gaef06a0173c093800cf74d958890a391a">eci2kep</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>,kep);</div><div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160;</div><div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;    <span class="comment">// Initial attitude</span></div><div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;    cinfo-&gt;physics.ftorque = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160;    <span class="keywordflow">switch</span> (cinfo-&gt;physics.mode)</div><div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;    {</div><div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;    <span class="comment">//case 0:</span></div><div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160;    <span class="comment">//  loc.att.icrf.utc = loc.utc;</span></div><div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    <span class="comment">//  loc.att.icrf.s = q_eye();</span></div><div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;    <span class="comment">//  loc.att.icrf.v = loc.att.icrf.a = rv_zero();</span></div><div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;    <span class="comment">//  att_icrf(&amp;loc);</span></div><div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160;    <span class="comment">//  break;</span></div><div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a>(-<a class="code" href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a>);</div><div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;faces[abs(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].face_idx[0])].normal.to_rv(),<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>));</div><div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;        <span class="comment">//  loc.att.icrf.s = rm_change_between_rv(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].normal,rv_smult(-1.,loc.pos.icrf.s));</span></div><div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;loc);</div><div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;    }</div><div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;</div><div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;</div><div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;    <span class="comment">//  groundstations(cinfo,&amp;loc);</span></div><div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, loc);</div><div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160;    <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a>(cinfo, loc);</div><div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, loc);</div><div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;</div><div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0] = loc;</div><div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160;</div><div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;    <span class="comment">// Position at t0-dt</span></div><div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;    <span class="keywordflow">for</span> (i=1; i&lt;4; i++)</div><div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160;    {</div><div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i-1];</div><div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> -= <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> / 86400.;</div><div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160;        kep.<a class="code" href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">ma</a> -= <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> * kep.<a class="code" href="structkepstruc.html#ac717c9dec8ed462c1c7241283ba9797e">mm</a>;</div><div class="line"><a name="l01873"></a><span class="lineno"> 1873</span>&#160;</div><div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;        uint16_t <a class="code" href="rw__test_8cpp.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> = 0;</div><div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;        {</div><div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;            dea = (kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> - kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> * sin(kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a>) - kep.<a class="code" href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">ma</a>) / (1. - kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> * cos(kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a>));</div><div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;            kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> -= dea;</div><div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;        } <span class="keywordflow">while</span> (++count &lt; 100 &amp;&amp; fabs(dea) &gt; .000001);</div><div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a>(kep,<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i].pos.eci);</div><div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160;</div><div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i-1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>;</div><div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;</div><div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;</div><div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[i]);</div><div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    }</div><div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;    cinfo-&gt;physics.mjdbase = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160;</div><div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;    cinfo-&gt;timestamp = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;}</div><div class="ttc" id="structkepstruc_html_ac717c9dec8ed462c1c7241283ba9797e"><div class="ttname"><a href="structkepstruc.html#ac717c9dec8ed462c1c7241283ba9797e">kepstruc::mm</a></div><div class="ttdeci">double mm</div><div class="ttdoc">Mean Motion. </div><div class="ttdef"><b>Definition:</b> convertdef.h:326</div></div>
<div class="ttc" id="group__convertlib__functions_html_gaef06a0173c093800cf74d958890a391a"><div class="ttname"><a href="group__convertlib__functions.html#gaef06a0173c093800cf74d958890a391a">eci2kep</a></div><div class="ttdeci">void eci2kep(cartpos &amp;eci, kepstruc &amp;kep)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2865</div></div>
<div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structkepstruc_html_ae642bc437de0f034b91232ea697ac222"><div class="ttname"><a href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">kepstruc::e</a></div><div class="ttdeci">double e</div><div class="ttdoc">Eccentricity. </div><div class="ttdef"><b>Definition:</b> convertdef.h:305</div></div>
<div class="ttc" id="rw__test_8cpp_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="rw__test_8cpp.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:36</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga75bef089c2786545431fb3033bbbc8b1"><div class="ttname"><a href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a></div><div class="ttdeci">void simulate_hardware(cosmosstruc *cinfo, vector&lt; locstruc &gt; &amp;locvec)</div><div class="ttdoc">Simulate Hardware data - multiple. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:937</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="structkepstruc_html_a0100c740a995bbaa0400b93f58548d5e"><div class="ttname"><a href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">kepstruc::ma</a></div><div class="ttdeci">double ma</div><div class="ttdoc">Mean Anomoly. </div><div class="ttdef"><b>Definition:</b> convertdef.h:320</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga5fffad1b57bb62f03d4037deaed8735b"><div class="ttname"><a href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a></div><div class="ttdeci">const double DPI2</div><div class="ttdoc">Double precision PI/2. </div><div class="ttdef"><b>Definition:</b> math/constants.h:18</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a315541d00c2de86f212c310d26527512"><div class="ttname"><a href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a></div><div class="ttdeci">quaternion q_change_around_y(double angle)</div><div class="ttdoc">Rotation quaternion for Y axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1435</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga51cb3beea90cb416ce61a5787eeb6be8"><div class="ttname"><a href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a></div><div class="ttdeci">void kep2eci(kepstruc &amp;kep, cartpos &amp;eci)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2811</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structkepstruc_html"><div class="ttname"><a href="structkepstruc.html">kepstruc</a></div><div class="ttdoc">Classical elements structure. </div><div class="ttdef"><b>Definition:</b> convertdef.h:294</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa6e2765f7d85e40f4ef5c960fb04572c"><div class="ttname"><a href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a></div><div class="ttdeci">static locstruc sloc[MAXGJORDER+2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:47</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga076acc0ac689c3de1a49720ec3fc5f76"><div class="ttname"><a href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a></div><div class="ttdeci">void hardware_init_eci(cosmosstruc *cinfo, locstruc &amp;loc)</div><div class="ttdoc">Initialize Hardware. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:877</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structposstruc_html_acd31426d000874db136ca434f3f62b14"><div class="ttname"><a href="structposstruc.html#acd31426d000874db136ca434f3f62b14">posstruc::icrf</a></div><div class="ttdeci">cartpos icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:395</div></div>
<div class="ttc" id="structkepstruc_html_a5208f0a1e729fe15297160012146b165"><div class="ttname"><a href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">kepstruc::ea</a></div><div class="ttdeci">double ea</div><div class="ttdoc">Eccentric Anomoly. </div><div class="ttdef"><b>Definition:</b> convertdef.h:324</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad0f3968a46e0bf6bedfbc1cc59c9cceb"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void orbit_init_shape </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>altitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>root</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160;{</div><div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;    <span class="keywordtype">double</span> lon;</div><div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;</div><div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;    lon = 2. * <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> * (fabs(hour)/24. - (utc - (int)utc));</div><div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160;</div><div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;    <span class="comment">// Munge time step to fit local granularity</span></div><div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> = 86400.*((utc + dt/86400.)-utc);</div><div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;</div><div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;    cinfo-&gt;physics.dt = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;    cinfo-&gt;physics.dtj = cinfo-&gt;physics.dt/86400.;</div><div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160;    cinfo-&gt;physics.mode = mode;</div><div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;    <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a> = utc;</div><div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;</div><div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> loc;</div><div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(loc);</div><div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;</div><div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;    <span class="comment">// Initial position</span></div><div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2] = loc;</div><div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a9ed19cfae3eca9d34f1684bf5c324830">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = utc;</div><div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = altitude;</div><div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a> = <a class="code" href="group__physicslib__functions.html#gaec4745d437b9d02cae7d4eb2708392b0">rearth</a>(0.) + altitude;</div><div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = 0.;</div><div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = lon;</div><div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> =  sin(angle) * sqrt(<a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a>/<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].pos.geos.s.r) / <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>;</div><div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = 0.;</div><div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = cos(angle) * sqrt(<a class="code" href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a>/<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].pos.geos.s.r) / <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a>;</div><div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;    <span class="keywordflow">if</span> (hour &lt; 0)</div><div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;    {</div><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = -<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = -<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a>;</div><div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;    }</div><div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> -= <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.;</div><div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a476bf91f6d5f6b9a29b6043b0922ee8f">pass</a>++;</div><div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;    <a class="code" href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;</div><div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;    <span class="comment">// Initial attitude</span></div><div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;    cinfo-&gt;physics.ftorque = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;    <span class="keywordflow">switch</span> (cinfo-&gt;physics.mode)</div><div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;    {</div><div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> =<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> =<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a>(-<a class="code" href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a>);</div><div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;faces[abs(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].face_idx[0])].normal.to_rv(),<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].pos.icrf.s));</div><div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;        <span class="comment">//  sloc[0].att.icrf.s = rm_change_between_rv(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].normal,rv_smult(-1.,loc.pos.icrf.s));</span></div><div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;    }</div><div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;</div><div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;    <span class="comment">//  groundstations(cinfo,&amp;sloc[0]);</span></div><div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;    <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a>(cinfo, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0]);</div><div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;</div><div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;    loc = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0];</div><div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;</div><div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;    <span class="comment">// Position at t0-dt</span></div><div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a9ed19cfae3eca9d34f1684bf5c324830">utc</a> =  <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a9ed19cfae3eca9d34f1684bf5c324830">utc</a> - dt/86400.;</div><div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> - dt * <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> - dt * <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a>;</div><div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> + <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.) * cos(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].pos.geod.s.lat) / cos(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].pos.geod.s.lat) - <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.;</div><div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a> - <a class="code" href="group__physicslib__functions.html#gaec4745d437b9d02cae7d4eb2708392b0">rearth</a>(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].pos.geod.s.lat);</div><div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> - <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a>) / dt;</div><div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;    <a class="code" href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1]);</div><div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160;</div><div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;    <span class="comment">// Attitude at t0-dt</span></div><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>;</div><div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1]);</div><div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160;</div><div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    cinfo-&gt;node.battlev = cinfo-&gt;node.battcap;</div><div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;</div><div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1]);</div><div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1]);</div><div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1]);</div><div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160;</div><div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    <span class="comment">// Position at t0-2*dt</span></div><div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a9ed19cfae3eca9d34f1684bf5c324830">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> - dt/86400.;</div><div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> - dt * <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> - dt * <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a>;</div><div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> + <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.) * cos(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].pos.geod.s.lat) / cos(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].pos.geod.s.lat) - <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.;</div><div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a> - <a class="code" href="group__physicslib__functions.html#gaec4745d437b9d02cae7d4eb2708392b0">rearth</a>(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].pos.geod.s.lat);</div><div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> - <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a>) / dt;</div><div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;    <a class="code" href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2]);</div><div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;</div><div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    <span class="comment">// Attitude at t0-2*dt</span></div><div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>;</div><div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2]);</div><div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;</div><div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    cinfo-&gt;node.battlev = cinfo-&gt;node.battcap;</div><div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160;</div><div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2]);</div><div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2]);</div><div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2]);</div><div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;</div><div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <span class="comment">// Position at t0-3*dt</span></div><div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a9ed19cfae3eca9d34f1684bf5c324830">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> - dt/86400.;</div><div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> - dt * <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">lat</a>;</div><div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> - dt * <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a>;</div><div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> = (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">lon</a> + <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.) * cos(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].pos.geod.s.lat) / cos(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].pos.geod.s.lat) - <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a> / 43200.;</div><div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">geos</a>.<a class="code" href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">s</a>.<a class="code" href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">r</a> - <a class="code" href="group__physicslib__functions.html#gaec4745d437b9d02cae7d4eb2708392b0">rearth</a>(<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].pos.geod.s.lat);</div><div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">v</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> = (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a> - <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">geod</a>.<a class="code" href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">s</a>.<a class="code" href="structgvector.html#a682173234f20766ce6fc83b8723758e7">h</a>) / dt;</div><div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160;    <a class="code" href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3]);</div><div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;</div><div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    <span class="comment">// Attitude at t0-3*dt</span></div><div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a> = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>;</div><div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3]);</div><div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;</div><div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    cinfo-&gt;node.battlev = cinfo-&gt;node.battcap;</div><div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;</div><div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3]);</div><div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3]);</div><div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3]);</div><div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;    cinfo-&gt;physics.mjdbase = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160;</div><div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;    cinfo-&gt;timestamp = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;}</div><div class="ttc" id="structspherpos_html_ad2978f8e060c698806bb76a9185e55f4"><div class="ttname"><a href="structspherpos.html#ad2978f8e060c698806bb76a9185e55f4">spherpos::s</a></div><div class="ttdeci">svector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:218</div></div>
<div class="ttc" id="structattstruc_html_a7fa9276c6dcd5ac70c1519721956e3a1"><div class="ttname"><a href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">attstruc::geoc</a></div><div class="ttdeci">qatt geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:418</div></div>
<div class="ttc" id="structgeoidpos_html_a9ed19cfae3eca9d34f1684bf5c324830"><div class="ttname"><a href="structgeoidpos.html#a9ed19cfae3eca9d34f1684bf5c324830">geoidpos::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:196</div></div>
<div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="structposstruc_html_ab9915207eb8422ed2853bc16f0914c50"><div class="ttname"><a href="structposstruc.html#ab9915207eb8422ed2853bc16f0914c50">posstruc::geos</a></div><div class="ttdeci">spherpos geos</div><div class="ttdef"><b>Definition:</b> convertdef.h:402</div></div>
<div class="ttc" id="structqatt_html_a1992b6fe91058cb7e0b2629dbef5b444"><div class="ttname"><a href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">qatt::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">2nd derivative: Alpha - acceleration </div><div class="ttdef"><b>Definition:</b> convertdef.h:283</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga75bef089c2786545431fb3033bbbc8b1"><div class="ttname"><a href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a></div><div class="ttdeci">void simulate_hardware(cosmosstruc *cinfo, vector&lt; locstruc &gt; &amp;locvec)</div><div class="ttdoc">Simulate Hardware data - multiple. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:937</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga5fffad1b57bb62f03d4037deaed8735b"><div class="ttname"><a href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a></div><div class="ttdeci">const double DPI2</div><div class="ttdoc">Double precision PI/2. </div><div class="ttdef"><b>Definition:</b> math/constants.h:18</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga225f033481a4247d0a2853d327cc6f65"><div class="ttname"><a href="group__convertlib__constants.html#ga225f033481a4247d0a2853d327cc6f65">GM</a></div><div class="ttdeci">#define GM</div><div class="ttdoc">SI Mass * Gravitational Constant for Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:79</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a315541d00c2de86f212c310d26527512"><div class="ttname"><a href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a></div><div class="ttdeci">quaternion q_change_around_y(double angle)</div><div class="ttdoc">Rotation quaternion for Y axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1435</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="physicslib_8cpp_html_a56b5812a8b6883ca5fe5e5345a526b75"><div class="ttname"><a href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a></div><div class="ttdeci">static double initialutc</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:43</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="structgvector_html_a682173234f20766ce6fc83b8723758e7"><div class="ttname"><a href="structgvector.html#a682173234f20766ce6fc83b8723758e7">gvector::h</a></div><div class="ttdeci">double h</div><div class="ttdoc">Height in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:116</div></div>
<div class="ttc" id="structgvector_html_a0bfcf58a2e1347b2acf503e503f1c93d"><div class="ttname"><a href="structgvector.html#a0bfcf58a2e1347b2acf503e503f1c93d">gvector::lon</a></div><div class="ttdeci">double lon</div><div class="ttdoc">Longitude in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:114</div></div>
<div class="ttc" id="group__convertlib__functions_html_gae54737b9083a8eba3e44808185870c3b"><div class="ttname"><a href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a></div><div class="ttdeci">int32_t pos_geod(locstruc *loc)</div><div class="ttdoc">Set Geodetic position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:565</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa6e2765f7d85e40f4ef5c960fb04572c"><div class="ttname"><a href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a></div><div class="ttdeci">static locstruc sloc[MAXGJORDER+2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:47</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structgeoidpos_html_a58eea1d79a7ffc82af4a43840852b8a1"><div class="ttname"><a href="structgeoidpos.html#a58eea1d79a7ffc82af4a43840852b8a1">geoidpos::s</a></div><div class="ttdeci">gvector s</div><div class="ttdoc">Position vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:198</div></div>
<div class="ttc" id="structgvector_html_a76ed76078ce8f825c8c1e783b0a3b7c2"><div class="ttname"><a href="structgvector.html#a76ed76078ce8f825c8c1e783b0a3b7c2">gvector::lat</a></div><div class="ttdeci">double lat</div><div class="ttdoc">Latitude in radians. </div><div class="ttdef"><b>Definition:</b> vector.h:112</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga076acc0ac689c3de1a49720ec3fc5f76"><div class="ttname"><a href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a></div><div class="ttdeci">void hardware_init_eci(cosmosstruc *cinfo, locstruc &amp;loc)</div><div class="ttdoc">Initialize Hardware. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:877</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structposstruc_html_a906e802c4aa1f6ac5ad34f5b3a728f6c"><div class="ttname"><a href="structposstruc.html#a906e802c4aa1f6ac5ad34f5b3a728f6c">posstruc::geod</a></div><div class="ttdeci">geoidpos geod</div><div class="ttdef"><b>Definition:</b> convertdef.h:400</div></div>
<div class="ttc" id="structsvector_html_acb2e6b4694745ef3cf790e806b7217fa"><div class="ttname"><a href="structsvector.html#acb2e6b4694745ef3cf790e806b7217fa">svector::r</a></div><div class="ttdeci">double r</div><div class="ttdoc">Radius in meters. </div><div class="ttdef"><b>Definition:</b> vector.h:99</div></div>
<div class="ttc" id="structgeoidpos_html_a476bf91f6d5f6b9a29b6043b0922ee8f"><div class="ttname"><a href="structgeoidpos.html#a476bf91f6d5f6b9a29b6043b0922ee8f">geoidpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:204</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="structgeoidpos_html_af998046c9fe45bc13eded2540073cde5"><div class="ttname"><a href="structgeoidpos.html#af998046c9fe45bc13eded2540073cde5">geoidpos::v</a></div><div class="ttdeci">gvector v</div><div class="ttdoc">Velocity vector. </div><div class="ttdef"><b>Definition:</b> convertdef.h:200</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
<div class="ttc" id="group__physicslib__functions_html_gaec4745d437b9d02cae7d4eb2708392b0"><div class="ttname"><a href="group__physicslib__functions.html#gaec4745d437b9d02cae7d4eb2708392b0">rearth</a></div><div class="ttdeci">double rearth(double lat)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1540</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga45bb7ae9e9ec69a8f8bb1712445f479b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void propagate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;{</div><div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> lnew, lnewp;</div><div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    <a class="code" href="structrvector.html">rvector</a> ds, unitp, unitx;</div><div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;    <a class="code" href="structquaternion.html">quaternion</a> dq;</div><div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordtype">double</span> angle;</div><div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;    <span class="keywordtype">double</span> lutc;</div><div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;    uint32_t chunks, <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, j;</div><div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;</div><div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].pos.geod.s.h &lt; 100.)</div><div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;    {</div><div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    }</div><div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;</div><div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160;    chunks = (uint32_t)(.5 + 86400.*(utc-<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].utc)/cinfo-&gt;physics.dt);</div><div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">if</span> (chunks &gt; 100000)</div><div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;    {</div><div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        chunks = 100000;</div><div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    }</div><div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    lutc = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#ad1ba15f2863bf55e35585cfe5fc74261">utc</a>;</div><div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;chunks; ++<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    {</div><div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].pos.geod.s.h &lt; 100.)</div><div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;        {</div><div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;        }</div><div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;</div><div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;        lnew = lnewp = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0];</div><div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;</div><div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;        lutc += (double)(cinfo-&gt;physics.dt)/86400.;</div><div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;</div><div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> = lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = lutc;</div><div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;</div><div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += cinfo-&gt;physics.dt * (lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + cinfo-&gt;physics.dt * (323.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 264.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 159.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 38.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 360.);</div><div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += cinfo-&gt;physics.dt * (lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + cinfo-&gt;physics.dt * (323.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 264.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 159.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 38.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 360.);</div><div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += cinfo-&gt;physics.dt * (lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + cinfo-&gt;physics.dt * (323.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 264.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 159.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 38.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 360.);</div><div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += cinfo-&gt;physics.dt * (55.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 59.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 37.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 9.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 24.;</div><div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += cinfo-&gt;physics.dt * (55.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 59.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 37.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 9.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 24.;</div><div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += cinfo-&gt;physics.dt * (55.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 59.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 37.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 9.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 24.;</div><div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;        lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;lnewp);</div><div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, lnewp);</div><div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;</div><div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> = lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = lutc;</div><div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += cinfo-&gt;physics.dt * (lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + cinfo-&gt;physics.dt * (38.*lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 171.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 36.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 7.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 360.);</div><div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += cinfo-&gt;physics.dt * (lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + cinfo-&gt;physics.dt * (38.*lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 171.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 36.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 7.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 360.);</div><div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += cinfo-&gt;physics.dt * (lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + cinfo-&gt;physics.dt * (38.*lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 171.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 36.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 7.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 360.);</div><div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += cinfo-&gt;physics.dt * (9.*lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 19.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 5.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 24.;</div><div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += cinfo-&gt;physics.dt * (9.*lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 19.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 5.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 24.;</div><div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += cinfo-&gt;physics.dt * (9.*lnewp.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 19.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 5.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 24.;</div><div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;        lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;lnew);</div><div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, lnew);</div><div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;</div><div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;</div><div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;        <span class="keywordflow">switch</span> (cinfo-&gt;physics.mode)</div><div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;        {</div><div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;        <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;            ds = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;            ds.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cinfo-&gt;physics.dt * (lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + cinfo-&gt;physics.dt * (323.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 264.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 159.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 38.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 360.);</div><div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;            ds.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = cinfo-&gt;physics.dt * (lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + cinfo-&gt;physics.dt * (323.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 264.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 159.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 38.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 360.);</div><div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;            ds.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] = cinfo-&gt;physics.dt * (lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + cinfo-&gt;physics.dt * (323.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 264.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 159.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 38.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 360.);</div><div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;            dq = <a class="code" href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a>(<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(.1,ds));</div><div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;            <span class="keywordflow">for</span> (j=0; j&lt;10; ++j)</div><div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160;            {</div><div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;                lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(dq,lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>);</div><div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;            }</div><div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;            lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += cinfo-&gt;physics.dt * (55.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 59.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 37.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 9.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 24.;</div><div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;            lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += cinfo-&gt;physics.dt * (55.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 59.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 37.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 9.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 24.;</div><div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;            lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += cinfo-&gt;physics.dt * (55.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 59.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 37.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 9.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 24.;</div><div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;lnew);</div><div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;            <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, lnewp);</div><div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;</div><div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;            ds = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;            ds.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cinfo-&gt;physics.dt * (lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + cinfo-&gt;physics.dt * (38.*lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 171.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 36.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 7.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 3600.);</div><div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;            ds.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = cinfo-&gt;physics.dt * (lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + cinfo-&gt;physics.dt * (38.*lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 171.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 36.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 7.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 3600.);</div><div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;            ds.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] = cinfo-&gt;physics.dt * (lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + cinfo-&gt;physics.dt * (38.*lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 171.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 36.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 7.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 3600.);</div><div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;            dq = <a class="code" href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a>(<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(.1,ds));</div><div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            <span class="keywordflow">for</span> (j=0; j&lt;10; ++j)</div><div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            {</div><div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;                lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(dq,lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>);</div><div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;            }</div><div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += cinfo-&gt;physics.dt * (9.*lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + 19.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] - 5.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] + <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]) / 24.;</div><div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += cinfo-&gt;physics.dt * (9.*lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + 19.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] - 5.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] + <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]) / 24.;</div><div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += cinfo-&gt;physics.dt * (9.*lnewp.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + 19.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] - 5.*<a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] + <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2].<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]) / 24.;</div><div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;lnew);</div><div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;        <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;lnew);</div><div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a>(-<a class="code" href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a>);</div><div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;lnew);</div><div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>(),lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>);</div><div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;lnew);</div><div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;        <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;faces[abs(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].face_idx[0])].normal.to_rv(),<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,lnew.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>));</div><div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;            <span class="comment">//      lnew.att.icrf.s = rm_change_between_rv(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].normal,rv_smult(-1.,lnew.pos.icrf.s));</span></div><div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;lnew);</div><div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;        <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;            angle = (1440.*(lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> - <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a>) - (<span class="keywordtype">int</span>)(1440.*(lnew.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> - <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a>))) * 2.*<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>;</div><div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;            unitx = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;            unitx.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = 1.;</div><div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;            unitp = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;            unitp.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cos(angle);</div><div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;            unitp.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = sin(angle);</div><div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(unitp,unitx);</div><div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;            lnew.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] = 2.*<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>/1440.;</div><div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;lnew);</div><div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;        }</div><div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;</div><div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160;        <span class="comment">//      groundstations(cinfo,&amp;lnew);</span></div><div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;        cinfo-&gt;node.battlev += (cinfo-&gt;physics.dt/3600.) * (cinfo-&gt;node.powgen-cinfo-&gt;node.powuse);</div><div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;</div><div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;node.powgen &gt; cinfo-&gt;node.powuse)</div><div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;            cinfo-&gt;node.flags |= <a class="code" href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a>;</div><div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;            cinfo-&gt;node.flags &amp;= ~<a class="code" href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a>;</div><div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;</div><div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;node.battlev &lt; 0.)</div><div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;            cinfo-&gt;node.battlev = 0.;</div><div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;</div><div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;        <span class="keywordflow">if</span> (cinfo-&gt;node.battlev &gt; cinfo-&gt;node.battcap)</div><div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;        {</div><div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;            cinfo-&gt;node.flags &amp;= ~<a class="code" href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a>;</div><div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;            cinfo-&gt;node.battlev = cinfo-&gt;node.battcap;</div><div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;        }</div><div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;        <span class="comment">// Simulate hardware values</span></div><div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, lnew);</div><div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, lnew);</div><div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;</div><div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;</div><div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[3] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2];</div><div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[2] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1];</div><div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[1] = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0];</div><div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;        <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0] = lnew;</div><div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;</div><div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    }</div><div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;</div><div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    cinfo-&gt;node.loc = <a class="code" href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a>[0];</div><div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;</div><div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    cinfo-&gt;timestamp = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;}</div><div class="ttc" id="group__defs__node__flag_html_gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368"><div class="ttname"><a href="group__defs__node__flag.html#gga3ae23c868a0b1348b121cde684086880aa4cb0f44208a042855adeec168779368">NODE_FLAG_CHARGING</a></div><div class="ttdef"><b>Definition:</b> cosmos-defs.h:114</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structcartpos_html_a2cfac3e4e3f929074ad589ec7f7b4ef2"><div class="ttname"><a href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">cartpos::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">Acceleration. </div><div class="ttdef"><b>Definition:</b> convertdef.h:167</div></div>
<div class="ttc" id="structcartpos_html_ad1ba15f2863bf55e35585cfe5fc74261"><div class="ttname"><a href="structcartpos.html#ad1ba15f2863bf55e35585cfe5fc74261">cartpos::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">UTC of Position. </div><div class="ttdef"><b>Definition:</b> convertdef.h:161</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structqatt_html_a1992b6fe91058cb7e0b2629dbef5b444"><div class="ttname"><a href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">qatt::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">2nd derivative: Alpha - acceleration </div><div class="ttdef"><b>Definition:</b> convertdef.h:283</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga75bef089c2786545431fb3033bbbc8b1"><div class="ttname"><a href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a></div><div class="ttdeci">void simulate_hardware(cosmosstruc *cinfo, vector&lt; locstruc &gt; &amp;locvec)</div><div class="ttdoc">Simulate Hardware data - multiple. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:937</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="structquaternion_html"><div class="ttname"><a href="structquaternion.html">quaternion</a></div><div class="ttdoc">Quaternion, scalar last, using x, y, z. </div><div class="ttdef"><b>Definition:</b> vector.h:213</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga4a24ca18a4f5b089270218620aad45ae"><div class="ttname"><a href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a></div><div class="ttdeci">quaternion q_axis2quaternion_rv(rvector v)</div><div class="ttdoc">Row vector axis and angle to Quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:260</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga5fffad1b57bb62f03d4037deaed8735b"><div class="ttname"><a href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a></div><div class="ttdeci">const double DPI2</div><div class="ttdoc">Double precision PI/2. </div><div class="ttdef"><b>Definition:</b> math/constants.h:18</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a315541d00c2de86f212c310d26527512"><div class="ttname"><a href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a></div><div class="ttdeci">quaternion q_change_around_y(double angle)</div><div class="ttdoc">Rotation quaternion for Y axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1435</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="physicslib_8cpp_html_a56b5812a8b6883ca5fe5e5345a526b75"><div class="ttname"><a href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a></div><div class="ttdeci">static double initialutc</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:43</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__mathlib__functions_html_gab90467a79da270c024863945d0cea778"><div class="ttname"><a href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a></div><div class="ttdeci">rvector rv_unitz(double scale)</div><div class="ttdoc">Scaled z row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:140</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="physicslib_8cpp_html_aa6e2765f7d85e40f4ef5c960fb04572c"><div class="ttname"><a href="physicslib_8cpp.html#aa6e2765f7d85e40f4ef5c960fb04572c">sloc</a></div><div class="ttdeci">static locstruc sloc[MAXGJORDER+2]</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:47</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="structposstruc_html_acd31426d000874db136ca434f3f62b14"><div class="ttname"><a href="structposstruc.html#acd31426d000874db136ca434f3f62b14">posstruc::icrf</a></div><div class="ttdeci">cartpos icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:395</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
<div class="ttc" id="structcartpos_html_a338924c9e05f128797aedf28a79388f6"><div class="ttname"><a href="structcartpos.html#a338924c9e05f128797aedf28a79388f6">cartpos::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">Velocity. </div><div class="ttdef"><b>Definition:</b> convertdef.h:165</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gaec4745d437b9d02cae7d4eb2708392b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double rearth </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>lat</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;{</div><div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <span class="keywordtype">double</span> st,ct;</div><div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <span class="keywordtype">double</span> c;</div><div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;</div><div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    st = sin(lat);</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;    ct = cos(lat);</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    c = sqrt(((<a class="code" href="group__convertlib__constants.html#ga93280ffde795bfa8066050d7d993e51c">FRATIO2</a> * <a class="code" href="group__convertlib__constants.html#ga93280ffde795bfa8066050d7d993e51c">FRATIO2</a> * st * st) + (ct * ct))/((ct * ct) + (<a class="code" href="group__convertlib__constants.html#ga93280ffde795bfa8066050d7d993e51c">FRATIO2</a> * st * st)));</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordflow">return</span> (<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a> * c);</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;}</div><div class="ttc" id="group__convertlib__constants_html_ga93280ffde795bfa8066050d7d993e51c"><div class="ttname"><a href="group__convertlib__constants.html#ga93280ffde795bfa8066050d7d993e51c">FRATIO2</a></div><div class="ttdeci">#define FRATIO2</div><div class="ttdef"><b>Definition:</b> convertdef.h:66</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga956263bca754093679747bc3d12b733d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int update_eci </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>utc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcartpos.html">cartpos</a>&#160;</td>
          <td class="paramname"><em>pos</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l03298"></a><span class="lineno"> 3298</span>&#160;{</div><div class="line"><a name="l03299"></a><span class="lineno"> 3299</span>&#160;    <a class="code" href="structquaternion.html">quaternion</a> dsq, q1, q2;</div><div class="line"><a name="l03300"></a><span class="lineno"> 3300</span>&#160;    <a class="code" href="unionuvector.html">uvector</a> utemp;</div><div class="line"><a name="l03301"></a><span class="lineno"> 3301</span>&#160;    <span class="keyword">static</span> <a class="code" href="structrvector.html">rvector</a> unitp1, unitp2, lunitp1;</div><div class="line"><a name="l03302"></a><span class="lineno"> 3302</span>&#160;    <a class="code" href="structrvector.html">rvector</a> unitp, unitx, normal, unitv;</div><div class="line"><a name="l03303"></a><span class="lineno"> 3303</span>&#160;    <a class="code" href="structlocstruc.html">locstruc</a> tloc;</div><div class="line"><a name="l03304"></a><span class="lineno"> 3304</span>&#160;    <a class="code" href="structdem__pixel.html">dem_pixel</a> val;</div><div class="line"><a name="l03305"></a><span class="lineno"> 3305</span>&#160;    <span class="keywordtype">double</span> angle;</div><div class="line"><a name="l03306"></a><span class="lineno"> 3306</span>&#160;    <span class="keywordtype">int</span> j, k;</div><div class="line"><a name="l03307"></a><span class="lineno"> 3307</span>&#160;</div><div class="line"><a name="l03308"></a><span class="lineno"> 3308</span>&#160;    cinfo-&gt;node.loc.utc = utc;</div><div class="line"><a name="l03309"></a><span class="lineno"> 3309</span>&#160;    cinfo-&gt;node.loc.pos.eci = pos;</div><div class="line"><a name="l03310"></a><span class="lineno"> 3310</span>&#160;    cinfo-&gt;node.loc.pos.eci.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l03311"></a><span class="lineno"> 3311</span>&#160;    <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03312"></a><span class="lineno"> 3312</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;physics.mode == <a class="code" href="group__defs__physics.html#ga66cf3f61e6df7383bc40148a2d742e58">PHYSICS_MODE_SURFACE</a>)</div><div class="line"><a name="l03313"></a><span class="lineno"> 3313</span>&#160;    {</div><div class="line"><a name="l03314"></a><span class="lineno"> 3314</span>&#160;        <span class="keywordflow">switch</span> (cinfo-&gt;node.loc.pos.extra.closest)</div><div class="line"><a name="l03315"></a><span class="lineno"> 3315</span>&#160;        {</div><div class="line"><a name="l03316"></a><span class="lineno"> 3316</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>:</div><div class="line"><a name="l03317"></a><span class="lineno"> 3317</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l03318"></a><span class="lineno"> 3318</span>&#160;            cinfo-&gt;node.loc.pos.geod.s.h = 0.5;</div><div class="line"><a name="l03319"></a><span class="lineno"> 3319</span>&#160;            cinfo-&gt;node.loc.pos.geod.utc += 1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-8;</div><div class="line"><a name="l03320"></a><span class="lineno"> 3320</span>&#160;            <a class="code" href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03321"></a><span class="lineno"> 3321</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03322"></a><span class="lineno"> 3322</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>:</div><div class="line"><a name="l03323"></a><span class="lineno"> 3323</span>&#160;            cinfo-&gt;node.loc.pos.selg.s.h = 2.5;</div><div class="line"><a name="l03324"></a><span class="lineno"> 3324</span>&#160;            cinfo-&gt;node.loc.pos.selg.utc += 1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-8;</div><div class="line"><a name="l03325"></a><span class="lineno"> 3325</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga75adc8ad34b82c931401eba1bebb0d4d">pos_selg</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03326"></a><span class="lineno"> 3326</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03327"></a><span class="lineno"> 3327</span>&#160;        }</div><div class="line"><a name="l03328"></a><span class="lineno"> 3328</span>&#160;    }</div><div class="line"><a name="l03329"></a><span class="lineno"> 3329</span>&#160;    tloc = cinfo-&gt;node.loc;</div><div class="line"><a name="l03330"></a><span class="lineno"> 3330</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(cinfo-&gt;physics, tloc);</div><div class="line"><a name="l03331"></a><span class="lineno"> 3331</span>&#160;</div><div class="line"><a name="l03332"></a><span class="lineno"> 3332</span>&#160;    <span class="comment">// Calculate probable thrust</span></div><div class="line"><a name="l03333"></a><span class="lineno"> 3333</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;devspec.thst_cnt)</div><div class="line"><a name="l03334"></a><span class="lineno"> 3334</span>&#160;    {</div><div class="line"><a name="l03335"></a><span class="lineno"> 3335</span>&#160;        cinfo-&gt;physics.thrust = <a class="code" href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a>(cinfo-&gt;node.loc.pos.eci.a,tloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">a</a>);</div><div class="line"><a name="l03336"></a><span class="lineno"> 3336</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(cinfo-&gt;physics.thrust.to_rv()) &lt; 5.)</div><div class="line"><a name="l03337"></a><span class="lineno"> 3337</span>&#160;        {</div><div class="line"><a name="l03338"></a><span class="lineno"> 3338</span>&#160;            cinfo-&gt;physics.thrust = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03339"></a><span class="lineno"> 3339</span>&#160;        }</div><div class="line"><a name="l03340"></a><span class="lineno"> 3340</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03341"></a><span class="lineno"> 3341</span>&#160;        {</div><div class="line"><a name="l03342"></a><span class="lineno"> 3342</span>&#160;            cinfo-&gt;physics.thrust = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;physics.mass,cinfo-&gt;physics.thrust.to_rv());</div><div class="line"><a name="l03343"></a><span class="lineno"> 3343</span>&#160;        }</div><div class="line"><a name="l03344"></a><span class="lineno"> 3344</span>&#160;    }</div><div class="line"><a name="l03345"></a><span class="lineno"> 3345</span>&#160;</div><div class="line"><a name="l03346"></a><span class="lineno"> 3346</span>&#160;    <span class="comment">// Calculate probable motor motion</span></div><div class="line"><a name="l03347"></a><span class="lineno"> 3347</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;devspec.motr_cnt)</div><div class="line"><a name="l03348"></a><span class="lineno"> 3348</span>&#160;    {</div><div class="line"><a name="l03349"></a><span class="lineno"> 3349</span>&#160;</div><div class="line"><a name="l03350"></a><span class="lineno"> 3350</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;cinfo-&gt;devspec.motr_cnt; j++)</div><div class="line"><a name="l03351"></a><span class="lineno"> 3351</span>&#160;        {</div><div class="line"><a name="l03352"></a><span class="lineno"> 3352</span>&#160;            <span class="keywordflow">switch</span> (cinfo-&gt;node.loc.pos.extra.closest)</div><div class="line"><a name="l03353"></a><span class="lineno"> 3353</span>&#160;            {</div><div class="line"><a name="l03354"></a><span class="lineno"> 3354</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>:</div><div class="line"><a name="l03355"></a><span class="lineno"> 3355</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l03356"></a><span class="lineno"> 3356</span>&#160;                cinfo-&gt;device[cinfo-&gt;devspec.motr[j]].motr.spd = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(cinfo-&gt;node.loc.pos.geoc.v)/cinfo-&gt;device[cinfo-&gt;devspec.motr[j]].motr.rat;</div><div class="line"><a name="l03357"></a><span class="lineno"> 3357</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03358"></a><span class="lineno"> 3358</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>:</div><div class="line"><a name="l03359"></a><span class="lineno"> 3359</span>&#160;                cinfo-&gt;device[cinfo-&gt;devspec.motr[j]].motr.spd = <a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(cinfo-&gt;node.loc.pos.selc.v)/cinfo-&gt;device[cinfo-&gt;devspec.motr[j]].motr.rat;</div><div class="line"><a name="l03360"></a><span class="lineno"> 3360</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03361"></a><span class="lineno"> 3361</span>&#160;            }</div><div class="line"><a name="l03362"></a><span class="lineno"> 3362</span>&#160;        }</div><div class="line"><a name="l03363"></a><span class="lineno"> 3363</span>&#160;    }</div><div class="line"><a name="l03364"></a><span class="lineno"> 3364</span>&#160;</div><div class="line"><a name="l03365"></a><span class="lineno"> 3365</span>&#160;    <span class="keywordflow">switch</span> (cinfo-&gt;physics.mode)</div><div class="line"><a name="l03366"></a><span class="lineno"> 3366</span>&#160;    {</div><div class="line"><a name="l03367"></a><span class="lineno"> 3367</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l03368"></a><span class="lineno"> 3368</span>&#160;        cinfo-&gt;node.loc.att.icrf.utc = cinfo-&gt;node.loc.utc;</div><div class="line"><a name="l03369"></a><span class="lineno"> 3369</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;10; k++)</div><div class="line"><a name="l03370"></a><span class="lineno"> 3370</span>&#160;        {</div><div class="line"><a name="l03371"></a><span class="lineno"> 3371</span>&#160;            q1 = <a class="code" href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a>(<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;physics.dt/10.,cinfo-&gt;node.loc.att.icrf.v));</div><div class="line"><a name="l03372"></a><span class="lineno"> 3372</span>&#160;            cinfo-&gt;node.loc.att.icrf.s = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(q1,cinfo-&gt;node.loc.att.icrf.s);</div><div class="line"><a name="l03373"></a><span class="lineno"> 3373</span>&#160;            <a class="code" href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a>(&amp;cinfo-&gt;node.loc.att.icrf.s);</div><div class="line"><a name="l03374"></a><span class="lineno"> 3374</span>&#160;            cinfo-&gt;node.loc.att.icrf.v = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(cinfo-&gt;node.loc.att.icrf.v,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(cinfo-&gt;physics.dt/10.,cinfo-&gt;node.loc.att.icrf.a));</div><div class="line"><a name="l03375"></a><span class="lineno"> 3375</span>&#160;        }</div><div class="line"><a name="l03376"></a><span class="lineno"> 3376</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03377"></a><span class="lineno"> 3377</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03378"></a><span class="lineno"> 3378</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l03379"></a><span class="lineno"> 3379</span>&#160;        cinfo-&gt;node.loc.att.lvlh.utc = cinfo-&gt;node.loc.utc;</div><div class="line"><a name="l03380"></a><span class="lineno"> 3380</span>&#160;        cinfo-&gt;node.loc.att.lvlh.s = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l03381"></a><span class="lineno"> 3381</span>&#160;        cinfo-&gt;node.loc.att.lvlh.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03382"></a><span class="lineno"> 3382</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03383"></a><span class="lineno"> 3383</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03384"></a><span class="lineno"> 3384</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l03385"></a><span class="lineno"> 3385</span>&#160;        cinfo-&gt;node.loc.att.topo.v = cinfo-&gt;node.loc.att.topo.a = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03386"></a><span class="lineno"> 3386</span>&#160;        <span class="keywordflow">switch</span> (cinfo-&gt;node.loc.pos.extra.closest)</div><div class="line"><a name="l03387"></a><span class="lineno"> 3387</span>&#160;        {</div><div class="line"><a name="l03388"></a><span class="lineno"> 3388</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>:</div><div class="line"><a name="l03389"></a><span class="lineno"> 3389</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l03390"></a><span class="lineno"> 3390</span>&#160;            val = <a class="code" href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a>(<a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>,cinfo-&gt;node.loc.pos.geod.s.lon,cinfo-&gt;node.loc.pos.geod.s.lat,1./<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>);</div><div class="line"><a name="l03391"></a><span class="lineno"> 3391</span>&#160;            <span class="keywordflow">for</span> (j=0; j&lt;3; j++)</div><div class="line"><a name="l03392"></a><span class="lineno"> 3392</span>&#160;            {</div><div class="line"><a name="l03393"></a><span class="lineno"> 3393</span>&#160;                normal.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[j] = val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[j];</div><div class="line"><a name="l03394"></a><span class="lineno"> 3394</span>&#160;            }</div><div class="line"><a name="l03395"></a><span class="lineno"> 3395</span>&#160;            unitv = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03396"></a><span class="lineno"> 3396</span>&#160;            unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cinfo-&gt;node.loc.pos.geod.v.lon / cos(cinfo-&gt;node.loc.pos.geod.s.lat);</div><div class="line"><a name="l03397"></a><span class="lineno"> 3397</span>&#160;            unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = cinfo-&gt;node.loc.pos.geod.v.lat;</div><div class="line"><a name="l03398"></a><span class="lineno"> 3398</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03399"></a><span class="lineno"> 3399</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>:</div><div class="line"><a name="l03400"></a><span class="lineno"> 3400</span>&#160;            val = <a class="code" href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a>(<a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>,cinfo-&gt;node.loc.pos.selg.s.lon,cinfo-&gt;node.loc.pos.selg.s.lat,1./<a class="code" href="group__convertlib__constants.html#gab390472803f74cb9dfbf3f47cf6b82cd">RMOONM</a>);</div><div class="line"><a name="l03401"></a><span class="lineno"> 3401</span>&#160;            <span class="keywordflow">for</span> (j=0; j&lt;3; j++)</div><div class="line"><a name="l03402"></a><span class="lineno"> 3402</span>&#160;            {</div><div class="line"><a name="l03403"></a><span class="lineno"> 3403</span>&#160;                normal.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[j] = -val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[j];</div><div class="line"><a name="l03404"></a><span class="lineno"> 3404</span>&#160;            }</div><div class="line"><a name="l03405"></a><span class="lineno"> 3405</span>&#160;            unitv = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03406"></a><span class="lineno"> 3406</span>&#160;            unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cinfo-&gt;node.loc.pos.selg.v.lon / cos(cinfo-&gt;node.loc.pos.selg.s.lat);</div><div class="line"><a name="l03407"></a><span class="lineno"> 3407</span>&#160;            unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = cinfo-&gt;node.loc.pos.selg.v.lat;</div><div class="line"><a name="l03408"></a><span class="lineno"> 3408</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03409"></a><span class="lineno"> 3409</span>&#160;        }</div><div class="line"><a name="l03410"></a><span class="lineno"> 3410</span>&#160;        q1 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>(),normal);</div><div class="line"><a name="l03411"></a><span class="lineno"> 3411</span>&#160;        unitx = <a class="code" href="group__mathlib__functions.html#ga87872977600612c97f2ccd895a18c1a4">rv_cross</a>(normal,<a class="code" href="group__mathlib__functions.html#ga0ab927d0ce1a6822fd4be8392515c41d">rv_unity</a>());</div><div class="line"><a name="l03412"></a><span class="lineno"> 3412</span>&#160;        unitx = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(q1,unitx);</div><div class="line"><a name="l03413"></a><span class="lineno"> 3413</span>&#160;        q2 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(unitx,unitv);</div><div class="line"><a name="l03414"></a><span class="lineno"> 3414</span>&#160;        <span class="comment">//      cinfo-&gt;node.loc.att.topo.s = q_fmult(q2,q1);</span></div><div class="line"><a name="l03415"></a><span class="lineno"> 3415</span>&#160;        cinfo-&gt;node.loc.att.topo.s = q1;</div><div class="line"><a name="l03416"></a><span class="lineno"> 3416</span>&#160;        cinfo-&gt;node.loc.att.topo.utc = cinfo-&gt;node.loc.pos.utc+1.e8;</div><div class="line"><a name="l03417"></a><span class="lineno"> 3417</span>&#160;        cinfo-&gt;node.loc.att.topo.pass++;</div><div class="line"><a name="l03418"></a><span class="lineno"> 3418</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga4d53b830876193698ea7ac99cd3ba8a4">att_topo</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03419"></a><span class="lineno"> 3419</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03420"></a><span class="lineno"> 3420</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l03421"></a><span class="lineno"> 3421</span>&#160;        cinfo-&gt;node.loc.att.icrf.utc = cinfo-&gt;node.loc.utc;</div><div class="line"><a name="l03422"></a><span class="lineno"> 3422</span>&#160;        q1 = cinfo-&gt;node.loc.att.icrf.s;</div><div class="line"><a name="l03423"></a><span class="lineno"> 3423</span>&#160;        cinfo-&gt;node.loc.att.icrf.s = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;physics.thrust.to_rv(),<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>());</div><div class="line"><a name="l03424"></a><span class="lineno"> 3424</span>&#160;        dsq = <a class="code" href="vector_8cpp.html#ae8b2683785836c9b3afd6ea770fbe584">q_sub</a>(cinfo-&gt;node.loc.att.icrf.s,q1);</div><div class="line"><a name="l03425"></a><span class="lineno"> 3425</span>&#160;        angle = 2. * atan(<a class="code" href="vector_8cpp.html#a4cfee4d6799b84744d6885b0c7c30630">length_q</a>(dsq)/2.);</div><div class="line"><a name="l03426"></a><span class="lineno"> 3426</span>&#160;        q2 = <a class="code" href="vector_8cpp.html#a7b455a47657477c96faae73ef614fb3d">q_smult</a>(1./cos(angle),cinfo-&gt;node.loc.att.icrf.s);</div><div class="line"><a name="l03427"></a><span class="lineno"> 3427</span>&#160;        dsq = <a class="code" href="vector_8cpp.html#ae8b2683785836c9b3afd6ea770fbe584">q_sub</a>(q2,q1);</div><div class="line"><a name="l03428"></a><span class="lineno"> 3428</span>&#160;        utemp.<a class="code" href="unionuvector.html#ad159f6a7f62bc17852fb25e1074ab732">q</a> = <a class="code" href="vector_8cpp.html#a7b455a47657477c96faae73ef614fb3d">q_smult</a>(2.,<a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(q1),dsq));</div><div class="line"><a name="l03429"></a><span class="lineno"> 3429</span>&#160;        cinfo-&gt;node.loc.att.icrf.v = utemp.<a class="code" href="unionuvector.html#a43a4f1b1ae3408298ec499e7604e2d8a">r</a>;</div><div class="line"><a name="l03430"></a><span class="lineno"> 3430</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03431"></a><span class="lineno"> 3431</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03432"></a><span class="lineno"> 3432</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l03433"></a><span class="lineno"> 3433</span>&#160;        cinfo-&gt;node.loc.att.selc.utc = cinfo-&gt;node.loc.utc;</div><div class="line"><a name="l03434"></a><span class="lineno"> 3434</span>&#160;        unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += .1*(cinfo-&gt;node.loc.pos.selg.v.lon-unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]);</div><div class="line"><a name="l03435"></a><span class="lineno"> 3435</span>&#160;        unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += .1*(cinfo-&gt;node.loc.pos.selg.v.lat-unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]);</div><div class="line"><a name="l03436"></a><span class="lineno"> 3436</span>&#160;        unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] =  0.;</div><div class="line"><a name="l03437"></a><span class="lineno"> 3437</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(unitp1) &lt; 1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-9)</div><div class="line"><a name="l03438"></a><span class="lineno"> 3438</span>&#160;            unitp1 = lunitp1;</div><div class="line"><a name="l03439"></a><span class="lineno"> 3439</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l03440"></a><span class="lineno"> 3440</span>&#160;            lunitp1 = unitp1;</div><div class="line"><a name="l03441"></a><span class="lineno"> 3441</span>&#160;        q1 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#gacd0bd1cf5e88440f2912f37c9a5e2c4b">rv_unitx</a>(),unitp1);</div><div class="line"><a name="l03442"></a><span class="lineno"> 3442</span>&#160;        val = <a class="code" href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a>(<a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>,cinfo-&gt;node.loc.pos.selg.s.lon,cinfo-&gt;node.loc.pos.selg.s.lat,.0003);</div><div class="line"><a name="l03443"></a><span class="lineno"> 3443</span>&#160;        unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += .1*(val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[0]-unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]);</div><div class="line"><a name="l03444"></a><span class="lineno"> 3444</span>&#160;        unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += .1*(val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[1]-unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]);</div><div class="line"><a name="l03445"></a><span class="lineno"> 3445</span>&#160;        unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += .1*(val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[2]-unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]);</div><div class="line"><a name="l03446"></a><span class="lineno"> 3446</span>&#160;        q2 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(q1,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>()),unitp2);</div><div class="line"><a name="l03447"></a><span class="lineno"> 3447</span>&#160;        cinfo-&gt;node.loc.att.selc.s = <a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(<a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(q2,q1));</div><div class="line"><a name="l03448"></a><span class="lineno"> 3448</span>&#160;        cinfo-&gt;node.loc.att.selc.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03449"></a><span class="lineno"> 3449</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga8044d1e9feba3476837335411c2e0333">att_selc2icrf</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03450"></a><span class="lineno"> 3450</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03451"></a><span class="lineno"> 3451</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l03452"></a><span class="lineno"> 3452</span>&#160;        cinfo-&gt;node.loc.att.geoc.utc = cinfo-&gt;node.loc.utc;</div><div class="line"><a name="l03453"></a><span class="lineno"> 3453</span>&#160;        angle = 2.*acos(cinfo-&gt;node.loc.att.geoc.s.w);</div><div class="line"><a name="l03454"></a><span class="lineno"> 3454</span>&#160;        cinfo-&gt;node.loc.att.geoc.s = <a class="code" href="vector_8cpp.html#aecec827dcad2784658f70113f527fa4a">q_change_around_z</a>(angle+.2*<a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>*cinfo-&gt;physics.dt);</div><div class="line"><a name="l03455"></a><span class="lineno"> 3455</span>&#160;        cinfo-&gt;node.loc.att.geoc.v = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(.2*<a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>());</div><div class="line"><a name="l03456"></a><span class="lineno"> 3456</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga34669623045ba324af3e0e465da4673c">att_geoc2icrf</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03457"></a><span class="lineno"> 3457</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga4942297c63cf2b95cde477a04cdde02d">att_planec2lvlh</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03458"></a><span class="lineno"> 3458</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03459"></a><span class="lineno"> 3459</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l03460"></a><span class="lineno"> 3460</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l03461"></a><span class="lineno"> 3461</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l03462"></a><span class="lineno"> 3462</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l03463"></a><span class="lineno"> 3463</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l03464"></a><span class="lineno"> 3464</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l03465"></a><span class="lineno"> 3465</span>&#160;        cinfo-&gt;node.loc.att.icrf.s = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;faces[abs(cinfo-&gt;pieces[cinfo-&gt;physics.mode-2].face_idx[0])].normal.to_rv(),<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,cinfo-&gt;node.loc.pos.icrf.s));</div><div class="line"><a name="l03466"></a><span class="lineno"> 3466</span>&#160;        cinfo-&gt;node.loc.att.icrf.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03467"></a><span class="lineno"> 3467</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03468"></a><span class="lineno"> 3468</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03469"></a><span class="lineno"> 3469</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l03470"></a><span class="lineno"> 3470</span>&#160;        angle = (1440.*(cinfo-&gt;node.loc.utc - <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a>) - (<span class="keywordtype">int</span>)(1440.*(cinfo-&gt;node.loc.utc - <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a>))) * 2.*<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>;</div><div class="line"><a name="l03471"></a><span class="lineno"> 3471</span>&#160;        unitx = unitp =  <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03472"></a><span class="lineno"> 3472</span>&#160;        unitx.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = 1.;</div><div class="line"><a name="l03473"></a><span class="lineno"> 3473</span>&#160;        unitp.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cos(angle);</div><div class="line"><a name="l03474"></a><span class="lineno"> 3474</span>&#160;        unitp.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = sin(angle);</div><div class="line"><a name="l03475"></a><span class="lineno"> 3475</span>&#160;        cinfo-&gt;node.loc.att.lvlh.s = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(unitp,unitx);</div><div class="line"><a name="l03476"></a><span class="lineno"> 3476</span>&#160;        cinfo-&gt;node.loc.att.lvlh.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03477"></a><span class="lineno"> 3477</span>&#160;        cinfo-&gt;node.loc.att.lvlh.v.col[2] = 2.*<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>/1440.;</div><div class="line"><a name="l03478"></a><span class="lineno"> 3478</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;cinfo-&gt;node.loc);</div><div class="line"><a name="l03479"></a><span class="lineno"> 3479</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03480"></a><span class="lineno"> 3480</span>&#160;    }</div><div class="line"><a name="l03481"></a><span class="lineno"> 3481</span>&#160;</div><div class="line"><a name="l03482"></a><span class="lineno"> 3482</span>&#160;    <span class="comment">// Perform positional and attitude accelerations at new position</span></div><div class="line"><a name="l03483"></a><span class="lineno"> 3483</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a>(cinfo, cinfo-&gt;node.loc);</div><div class="line"><a name="l03484"></a><span class="lineno"> 3484</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;physics, cinfo-&gt;node.loc);</div><div class="line"><a name="l03485"></a><span class="lineno"> 3485</span>&#160;</div><div class="line"><a name="l03486"></a><span class="lineno"> 3486</span>&#160;    <span class="comment">// Simulate at new position</span></div><div class="line"><a name="l03487"></a><span class="lineno"> 3487</span>&#160;    <span class="comment">//  groundstations(cinfo,&amp;cinfo-&gt;node.loc);</span></div><div class="line"><a name="l03488"></a><span class="lineno"> 3488</span>&#160;</div><div class="line"><a name="l03489"></a><span class="lineno"> 3489</span>&#160;    cinfo-&gt;timestamp = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l03490"></a><span class="lineno"> 3490</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03491"></a><span class="lineno"> 3491</span>&#160;}</div><div class="ttc" id="unionuvector_html"><div class="ttname"><a href="unionuvector.html">uvector</a></div><div class="ttdoc">Quaternion/Rvector Union. </div><div class="ttdef"><b>Definition:</b> mathlib.h:155</div></div>
<div class="ttc" id="structdem__pixel_html_aeb37f380181cd6ad125584e5fab174a8"><div class="ttname"><a href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">dem_pixel::nmap</a></div><div class="ttdeci">float nmap[3]</div><div class="ttdef"><b>Definition:</b> demlib.h:85</div></div>
<div class="ttc" id="eci2kep__test_8cpp_html_aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f"><div class="ttname"><a href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a></div><div class="ttdef"><b>Definition:</b> eci2kep_test.cpp:33</div></div>
<div class="ttc" id="vector_8cpp_html_ae8b2683785836c9b3afd6ea770fbe584"><div class="ttname"><a href="vector_8cpp.html#ae8b2683785836c9b3afd6ea770fbe584">q_sub</a></div><div class="ttdeci">quaternion q_sub(quaternion a, quaternion b)</div><div class="ttdoc">Subtract two quaternions. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1186</div></div>
<div class="ttc" id="group__mathlib__functions_html_gad3d78ceb8af40ce126896a854dc2bb22"><div class="ttname"><a href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a></div><div class="ttdeci">rvector rv_add(rvector a, rvector b)</div><div class="ttdoc">Add two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:299</div></div>
<div class="ttc" id="unionuvector_html_a43a4f1b1ae3408298ec499e7604e2d8a"><div class="ttname"><a href="unionuvector.html#a43a4f1b1ae3408298ec499e7604e2d8a">uvector::r</a></div><div class="ttdeci">rvector r</div><div class="ttdef"><b>Definition:</b> mathlib.h:161</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="structcartpos_html_a2cfac3e4e3f929074ad589ec7f7b4ef2"><div class="ttname"><a href="structcartpos.html#a2cfac3e4e3f929074ad589ec7f7b4ef2">cartpos::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">Acceleration. </div><div class="ttdef"><b>Definition:</b> convertdef.h:167</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4942297c63cf2b95cde477a04cdde02d"><div class="ttname"><a href="group__convertlib__functions.html#ga4942297c63cf2b95cde477a04cdde02d">att_planec2lvlh</a></div><div class="ttdeci">void att_planec2lvlh(locstruc *loc)</div><div class="ttdoc">Convert ITRS attitude to LVLH attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1823</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga75bef089c2786545431fb3033bbbc8b1"><div class="ttname"><a href="group__physicslib__functions.html#ga75bef089c2786545431fb3033bbbc8b1">simulate_hardware</a></div><div class="ttdeci">void simulate_hardware(cosmosstruc *cinfo, vector&lt; locstruc &gt; &amp;locvec)</div><div class="ttdoc">Simulate Hardware data - multiple. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:937</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="group__mathlib__functions_html_gac6a350c8823f5ad93e80299ab777f602"><div class="ttname"><a href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a></div><div class="ttdeci">double length_rv(rvector v)</div><div class="ttdoc">Length of row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:748</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8044d1e9feba3476837335411c2e0333"><div class="ttname"><a href="group__convertlib__functions.html#ga8044d1e9feba3476837335411c2e0333">att_selc2icrf</a></div><div class="ttdeci">void att_selc2icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1732</div></div>
<div class="ttc" id="structquaternion_html"><div class="ttname"><a href="structquaternion.html">quaternion</a></div><div class="ttdoc">Quaternion, scalar last, using x, y, z. </div><div class="ttdef"><b>Definition:</b> vector.h:213</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="group__defs__physics_html_ga66cf3f61e6df7383bc40148a2d742e58"><div class="ttname"><a href="group__defs__physics.html#ga66cf3f61e6df7383bc40148a2d742e58">PHYSICS_MODE_SURFACE</a></div><div class="ttdeci">#define PHYSICS_MODE_SURFACE</div><div class="ttdef"><b>Definition:</b> cosmos-defs.h:249</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga4a24ca18a4f5b089270218620aad45ae"><div class="ttname"><a href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a></div><div class="ttdeci">quaternion q_axis2quaternion_rv(rvector v)</div><div class="ttdoc">Row vector axis and angle to Quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:260</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga75adc8ad34b82c931401eba1bebb0d4d"><div class="ttname"><a href="group__convertlib__functions.html#ga75adc8ad34b82c931401eba1bebb0d4d">pos_selg</a></div><div class="ttdeci">int32_t pos_selg(locstruc *loc)</div><div class="ttdoc">Set Selenographic position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:473</div></div>
<div class="ttc" id="unionuvector_html_ad159f6a7f62bc17852fb25e1074ab732"><div class="ttname"><a href="unionuvector.html#ad159f6a7f62bc17852fb25e1074ab732">uvector::q</a></div><div class="ttdeci">quaternion q</div><div class="ttdef"><b>Definition:</b> mathlib.h:157</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="physicslib_8cpp_html_a56b5812a8b6883ca5fe5e5345a526b75"><div class="ttname"><a href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a></div><div class="ttdeci">static double initialutc</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:43</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga0ab927d0ce1a6822fd4be8392515c41d"><div class="ttname"><a href="group__mathlib__functions.html#ga0ab927d0ce1a6822fd4be8392515c41d">rv_unity</a></div><div class="ttdeci">rvector rv_unity(double scale)</div><div class="ttdoc">Scaled y row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:129</div></div>
<div class="ttc" id="vector_8cpp_html_a7b455a47657477c96faae73ef614fb3d"><div class="ttname"><a href="vector_8cpp.html#a7b455a47657477c96faae73ef614fb3d">q_smult</a></div><div class="ttdeci">quaternion q_smult(double a, quaternion b)</div><div class="ttdoc">Multiply quaternion by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1151</div></div>
<div class="ttc" id="vector_8cpp_html_a4cfee4d6799b84744d6885b0c7c30630"><div class="ttname"><a href="vector_8cpp.html#a4cfee4d6799b84744d6885b0c7c30630">length_q</a></div><div class="ttdeci">double length_q(quaternion q)</div><div class="ttdoc">Length of quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1329</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="vector_8cpp_html_ad3b9f20d98c02e6a2c6fc57a7c55826d"><div class="ttname"><a href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a></div><div class="ttdeci">void normalize_q(quaternion *q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:961</div></div>
<div class="ttc" id="group__demlib__functions_html_gaf7e4f0cdeccd2fdb836f06659d0524d7"><div class="ttname"><a href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a></div><div class="ttdeci">dem_pixel map_dem_pixel(int body, double lon, double lat, double res)</div><div class="ttdoc">Height in DEM. </div><div class="ttdef"><b>Definition:</b> demlib.cpp:357</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga34669623045ba324af3e0e465da4673c"><div class="ttname"><a href="group__convertlib__functions.html#ga34669623045ba324af3e0e465da4673c">att_geoc2icrf</a></div><div class="ttdeci">void att_geoc2icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1619</div></div>
<div class="ttc" id="vector_8cpp_html_aecec827dcad2784658f70113f527fa4a"><div class="ttname"><a href="vector_8cpp.html#aecec827dcad2784658f70113f527fa4a">q_change_around_z</a></div><div class="ttdeci">quaternion q_change_around_z(double angle)</div><div class="ttdoc">Rotation quaternion for Z axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1461</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__convertlib__constants_html_gab390472803f74cb9dfbf3f47cf6b82cd"><div class="ttname"><a href="group__convertlib__constants.html#gab390472803f74cb9dfbf3f47cf6b82cd">RMOONM</a></div><div class="ttdeci">#define RMOONM</div><div class="ttdoc">SI Radius of Moon. </div><div class="ttdef"><b>Definition:</b> convertdef.h:58</div></div>
<div class="ttc" id="group__mathlib__functions_html_gab90467a79da270c024863945d0cea778"><div class="ttname"><a href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a></div><div class="ttdeci">rvector rv_unitz(double scale)</div><div class="ttdoc">Scaled z row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:140</div></div>
<div class="ttc" id="group__convertlib__functions_html_gae54737b9083a8eba3e44808185870c3b"><div class="ttname"><a href="group__convertlib__functions.html#gae54737b9083a8eba3e44808185870c3b">pos_geod</a></div><div class="ttdeci">int32_t pos_geod(locstruc *loc)</div><div class="ttdoc">Set Geodetic position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:565</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="group__demlib__planets_html_gaea348e6fd7b22620d80ab0f5643b7fbe"><div class="ttname"><a href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a></div><div class="ttdeci">#define COSMOS_MOON</div><div class="ttdef"><b>Definition:</b> convertdef.h:144</div></div>
<div class="ttc" id="group__demlib__planets_html_ga953a753d5b76c9871e10a848b6a264f0"><div class="ttname"><a href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a></div><div class="ttdeci">#define COSMOS_EARTH</div><div class="ttdef"><b>Definition:</b> convertdef.h:137</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="structdem__pixel_html"><div class="ttname"><a href="structdem__pixel.html">dem_pixel</a></div><div class="ttdoc">Location value. </div><div class="ttdef"><b>Definition:</b> demlib.h:82</div></div>
<div class="ttc" id="group__mathlib__functions_html_gacd0bd1cf5e88440f2912f37c9a5e2c4b"><div class="ttname"><a href="group__mathlib__functions.html#gacd0bd1cf5e88440f2912f37c9a5e2c4b">rv_unitx</a></div><div class="ttdeci">rvector rv_unitx(double scale)</div><div class="ttdoc">Scaled x row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:118</div></div>
<div class="ttc" id="group__mathlib__functions_html_gac195169be6c06261b9d49bac80a003d2"><div class="ttname"><a href="group__mathlib__functions.html#gac195169be6c06261b9d49bac80a003d2">rv_sub</a></div><div class="ttdeci">rvector rv_sub(rvector a, rvector b)</div><div class="ttdoc">Subtract two vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:315</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4d53b830876193698ea7ac99cd3ba8a4"><div class="ttname"><a href="group__convertlib__functions.html#ga4d53b830876193698ea7ac99cd3ba8a4">att_topo</a></div><div class="ttdeci">int32_t att_topo(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2202</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga87872977600612c97f2ccd895a18c1a4"><div class="ttname"><a href="group__mathlib__functions.html#ga87872977600612c97f2ccd895a18c1a4">rv_cross</a></div><div class="ttdeci">rvector rv_cross(rvector a, rvector b)</div><div class="ttdoc">Take cross product of two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:363</div></div>
<div class="ttc" id="structlocstruc_html"><div class="ttname"><a href="structlocstruc.html">locstruc</a></div><div class="ttdef"><b>Definition:</b> convertdef.h:427</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga076acc0ac689c3de1a49720ec3fc5f76"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void hardware_init_eci </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>cinfo</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Hardware. </p>
<p>Set up the hardware simulation by initializing the various components to their base values. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">devspec</td><td>Pointer to structure holding specs on devices. </td></tr>
    <tr><td class="paramname">loc</td><td>Structure specifying location </td></tr>
  </table>
  </dd>
</dl>
<p>Initialize temperature sensors</p>
<p>Reaction Wheels</p>
<p>Magnetic Torque Rods</p>
<p>Star Trackers </p>
<div class="fragment"><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;{</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;    uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;    <span class="comment">// Initialize power</span></div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;    <span class="comment">//  cinfo-&gt;node.battlev = cinfo-&gt;node.battcap;</span></div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a6014a57b42b32586ac97d89aa4d05f55">bus_cnt</a>; i++)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;    {</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].bus.amp = 0.;</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">bus</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].bus.flag |= <a class="code" href="group__defs__comp__flag.html#gab1319b2a66d48c7d92123f970c082a44">DEVICE_FLAG_ON</a>;</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;    }</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;<span class="comment">//    for (i=0; i&lt;cinfo-&gt;devspec.tsen_cnt; i++)</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;<span class="comment">//        cinfo-&gt;device[cinfo-&gt;devspec.tsen[i]].tsen.temp = 300.;</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a982244f15316677590502f08b93a5cde">rw_cnt</a>; i++)</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;    {</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.omg = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.alp = 0.;</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.romg = cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">rw</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].rw.ralp = 0.;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;    }</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;    <span class="keywordflow">if</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a56c71a1d7c766055719842f6d82f032e">tcu_cnt</a>)</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;    {</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a8121c6b6fb383f6467a576fdf59fd3c5">tcu</a>[0]].tcu.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#ace81b493dad7e9971a06c2df2d159a8e">mtr_cnt</a>; i++)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        {</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.mom = 0.;</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;            cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">mtr</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].mtr.rmom = 0.;</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        }</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;    }</div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;    <span class="comment">// Inertial Measurement Units</span></div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">imu_cnt</a>; i++)</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;    {</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga1922b090d2c47d135b29ca7d91de0030">initialize_imu</a>(i, cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>, loc);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">imu</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].imu.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;    }</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aa16d7419633cb5ba20f81ec2e2d6b2e7">stt_cnt</a>; i++)</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;    {</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.att = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[i]].stt.align,<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a>));</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.omega = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[i]].stt.align),loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a>);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">device</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">devspec</a>.<a class="code" href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">stt</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>]].stt.utc = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    }</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;}</div><div class="ttc" id="structdevspecstruc_html_a8fa600fe999ea5fe82360f12d3a4c918"><div class="ttname"><a href="structdevspecstruc.html#a8fa600fe999ea5fe82360f12d3a4c918">devspecstruc::imu_cnt</a></div><div class="ttdeci">uint16_t imu_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1827</div></div>
<div class="ttc" id="structdevspecstruc_html_adc2df0836d9c6ba7f393dddfce2a87e5"><div class="ttname"><a href="structdevspecstruc.html#adc2df0836d9c6ba7f393dddfce2a87e5">devspecstruc::mtr</a></div><div class="ttdeci">vector&lt; uint16_t &gt; mtr</div><div class="ttdef"><b>Definition:</b> jsondef.h:1863</div></div>
<div class="ttc" id="structdevspecstruc_html_aad89fb4f77fb5e1b06cca79cf1f134f1"><div class="ttname"><a href="structdevspecstruc.html#aad89fb4f77fb5e1b06cca79cf1f134f1">devspecstruc::stt</a></div><div class="ttdeci">vector&lt; uint16_t &gt; stt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1872</div></div>
<div class="ttc" id="structdevspecstruc_html_a5216197281736e4b38a5b330894233e8"><div class="ttname"><a href="structdevspecstruc.html#a5216197281736e4b38a5b330894233e8">devspecstruc::bus</a></div><div class="ttdeci">vector&lt; uint16_t &gt; bus</div><div class="ttdef"><b>Definition:</b> jsondef.h:1854</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga1922b090d2c47d135b29ca7d91de0030"><div class="ttname"><a href="group__physicslib__functions.html#ga1922b090d2c47d135b29ca7d91de0030">initialize_imu</a></div><div class="ttdeci">void initialize_imu(uint16_t index, devspecstruc &amp;devspec, locstruc &amp;loc)</div><div class="ttdoc">Initialize IMU. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1452</div></div>
<div class="ttc" id="structdevspecstruc_html_a607780e080ad5d8230125bc6314be7e0"><div class="ttname"><a href="structdevspecstruc.html#a607780e080ad5d8230125bc6314be7e0">devspecstruc::imu</a></div><div class="ttdeci">vector&lt; uint16_t &gt; imu</div><div class="ttdef"><b>Definition:</b> jsondef.h:1860</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="structdevspecstruc_html_aa79561f078de9958e50f6ab644d7b18a"><div class="ttname"><a href="structdevspecstruc.html#aa79561f078de9958e50f6ab644d7b18a">devspecstruc::rw</a></div><div class="ttdeci">vector&lt; uint16_t &gt; rw</div><div class="ttdef"><b>Definition:</b> jsondef.h:1869</div></div>
<div class="ttc" id="group__defs__comp__flag_html_gab1319b2a66d48c7d92123f970c082a44"><div class="ttname"><a href="group__defs__comp__flag.html#gab1319b2a66d48c7d92123f970c082a44">DEVICE_FLAG_ON</a></div><div class="ttdeci">#define DEVICE_FLAG_ON</div><div class="ttdef"><b>Definition:</b> jsondef.h:683</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="structdevspecstruc_html_a8121c6b6fb383f6467a576fdf59fd3c5"><div class="ttname"><a href="structdevspecstruc.html#a8121c6b6fb383f6467a576fdf59fd3c5">devspecstruc::tcu</a></div><div class="ttdeci">vector&lt; uint16_t &gt; tcu</div><div class="ttdef"><b>Definition:</b> jsondef.h:1875</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="structcosmosstruc_html_a84fcbf5d6772b8c6e1512dd041b3009d"><div class="ttname"><a href="structcosmosstruc.html#a84fcbf5d6772b8c6e1512dd041b3009d">cosmosstruc::device</a></div><div class="ttdeci">vector&lt; devicestruc &gt; device</div><div class="ttdoc">Vector of all general (common) information for devices (components) in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2026</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="structdevspecstruc_html_a6014a57b42b32586ac97d89aa4d05f55"><div class="ttname"><a href="structdevspecstruc.html#a6014a57b42b32586ac97d89aa4d05f55">devspecstruc::bus_cnt</a></div><div class="ttdeci">uint16_t bus_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1821</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="structdevspecstruc_html_a982244f15316677590502f08b93a5cde"><div class="ttname"><a href="structdevspecstruc.html#a982244f15316677590502f08b93a5cde">devspecstruc::rw_cnt</a></div><div class="ttdeci">uint16_t rw_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1836</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structcosmosstruc_html_a5b88004fd97b785dbce7c03b8d5d714d"><div class="ttname"><a href="structcosmosstruc.html#a5b88004fd97b785dbce7c03b8d5d714d">cosmosstruc::devspec</a></div><div class="ttdeci">devspecstruc devspec</div><div class="ttdoc">Structure for devices (components) special data in node, by type. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2028</div></div>
<div class="ttc" id="structdevspecstruc_html_a56c71a1d7c766055719842f6d82f032e"><div class="ttname"><a href="structdevspecstruc.html#a56c71a1d7c766055719842f6d82f032e">devspecstruc::tcu_cnt</a></div><div class="ttdeci">uint16_t tcu_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1843</div></div>
<div class="ttc" id="structdevspecstruc_html_ace81b493dad7e9971a06c2df2d159a8e"><div class="ttname"><a href="structdevspecstruc.html#ace81b493dad7e9971a06c2df2d159a8e">devspecstruc::mtr_cnt</a></div><div class="ttdeci">uint16_t mtr_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1830</div></div>
<div class="ttc" id="structdevspecstruc_html_aa16d7419633cb5ba20f81ec2e2d6b2e7"><div class="ttname"><a href="structdevspecstruc.html#aa16d7419633cb5ba20f81ec2e2d6b2e7">devspecstruc::stt_cnt</a></div><div class="ttdeci">uint16_t stt_cnt</div><div class="ttdef"><b>Definition:</b> jsondef.h:1840</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga8678ece24649523ac1139bc6072e28bd"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gauss_jackson_setup </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>utc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>dt</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Prepare for Gauss-Jackson integration. </p>
<p>Initializes Gauss-Jackson integration parameters for indicated order (must be even). Binomial coefficients are initialized first time through. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gjh</td><td><a class="el" href="structgj__handle.html" title="Gauss-Jackson integration handle. ">gj_handle</a> containing Gauss-Jackson inforation. </td></tr>
    <tr><td class="paramname">order</td><td>The order at which the integration will be performed </td></tr>
    <tr><td class="paramname">utc</td><td>Initial Modified Julian Day. </td></tr>
    <tr><td class="paramname">dt</td><td>Step size in seconds. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;{</div><div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;    uint32_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, n, j,m,k;</div><div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="testprofiler_8c.html#ae1a3968e7947464bee7714f6d43b7002">test</a>;</div><div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;</div><div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>.resize(order+2);</div><div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>.resize(order+2);</div><div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;    gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>.resize(order+2);</div><div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>.resize(order+2);</div><div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;order+2; ++<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    {</div><div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;        gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(order+2);</div><div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(order+1);</div><div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;        gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].resize(order+1);</div><div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;    }</div><div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>.resize(order+3);</div><div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;    gjh.<a class="code" href="structgj__handle.html#aec279bc9f269750b73e88662323a3023">gam</a>.resize(order+2);</div><div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>.resize(order+3);</div><div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ab10da2fdeaa7e8616c5fadca72a51fb3">lam</a>.resize(order+3);</div><div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;    gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a> = 0;</div><div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;</div><div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;    <span class="comment">// Munge time step to fit local granularity</span></div><div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;    test = utc + <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>/86400.;</div><div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;    <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> = 86400.*(test-utc);</div><div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;</div><div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a> = order;</div><div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a> = gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>/2;</div><div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;    gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a> = gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a> * 2;</div><div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a>;</div><div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;</div><div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;    <span class="keywordflow">for</span> (m=0; m&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+2; m++)</div><div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    {</div><div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;        <span class="keywordflow">for</span> (i=0; i&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+2; i++)</div><div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;        {</div><div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;            <span class="keywordflow">if</span> (m &gt; i)</div><div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;                gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0;</div><div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;            {</div><div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;                <span class="keywordflow">if</span> (m == i)</div><div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;                    gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div><div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                {</div><div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;                    <span class="keywordflow">if</span> (m == 0)</div><div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                        gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 1;</div><div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;                    {</div><div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160;                        gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m-1][i-1] + gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][i-1];</div><div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;                    }</div><div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;                }</div><div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;            }</div><div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;        }</div><div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    }</div><div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;</div><div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;    gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[0] = 1.;</div><div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;    <span class="keywordflow">for</span> (n=1; n&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+3; n++)</div><div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;    {</div><div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[n] = 0.;</div><div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160;        <span class="keywordflow">for</span> (i=0; i&lt;=n-1; i++)</div><div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        {</div><div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;            gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[n] -= gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] / (n+1-<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>);</div><div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;        }</div><div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;    }</div><div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;</div><div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;    gjh.<a class="code" href="structgj__handle.html#aec279bc9f269750b73e88662323a3023">gam</a>[0] = gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[0];</div><div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;    <span class="keywordflow">for</span> (i=1; i&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+2; i++)</div><div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;    {</div><div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        gjh.<a class="code" href="structgj__handle.html#aec279bc9f269750b73e88662323a3023">gam</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#aec279bc9f269750b73e88662323a3023">gam</a>[i-1] + gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;    }</div><div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;</div><div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1; i++)</div><div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;    {</div><div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;        gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#aec279bc9f269750b73e88662323a3023">gam</a>[i+1];</div><div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;        gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[i+1];</div><div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;        <span class="keywordflow">for</span> (j=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-1; j&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; --j)</div><div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;        {</div><div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;            <span class="keywordflow">if</span> (!i)</div><div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;                gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[j][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[j+1][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;                gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[j][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[j+1][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[j+1][i-1];</div><div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;        }</div><div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;    }</div><div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;</div><div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>[0] = 1.;</div><div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;    <span class="keywordflow">for</span> (i=1; i&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+3; i++)</div><div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    {</div><div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = 0.;</div><div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;=<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>; k++)</div><div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;        {</div><div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] += gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[k]*gjh.<a class="code" href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">c</a>[i-k];</div><div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;        }</div><div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;    }</div><div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;</div><div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ab10da2fdeaa7e8616c5fadca72a51fb3">lam</a>[0] = gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>[0];</div><div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;    <span class="keywordflow">for</span> (i=1; i&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+3; i++)</div><div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160;    {</div><div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ab10da2fdeaa7e8616c5fadca72a51fb3">lam</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#ab10da2fdeaa7e8616c5fadca72a51fb3">lam</a>[i-1] + gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    }</div><div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;</div><div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1; i++)</div><div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;    {</div><div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;        gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#ab10da2fdeaa7e8616c5fadca72a51fb3">lam</a>[i+2];</div><div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;        gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">q</a>[i+2];</div><div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;        <span class="keywordflow">for</span> (j=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-1; j&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; --j)</div><div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;        {</div><div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            <span class="keywordflow">if</span> (!i)</div><div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;                gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[j][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[j+1][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;                gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[j][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] = gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[j+1][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] - gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[j+1][i-1];</div><div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;        }</div><div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;    }</div><div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;</div><div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;    <span class="keywordflow">for</span> (j=0; j&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+2; j++)</div><div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;    {</div><div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;        <span class="keywordflow">for</span> (m=0; m&lt;gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1; m++)</div><div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;        {</div><div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].a[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].b[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] = 0.;</div><div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;            <span class="keywordflow">for</span> (i=m; i&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; i++)</div><div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;            {</div><div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].a[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] += gjh.<a class="code" href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">alpha</a>[j][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].b[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] += gjh.<a class="code" href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">beta</a>[j][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>] * gjh.<a class="code" href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">binom</a>[m][<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>];</div><div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;            }</div><div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].a[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] *= pow(-1.,m);</div><div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].b[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] *= pow(-1.,m);</div><div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;            <span class="keywordflow">if</span> (gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m == j)</div><div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j].b[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>-m] += .5;</div><div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;        }</div><div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;    }</div><div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;}</div><div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structgj__handle_html_a2c396692d23acfbe592d99245d0130bf"><div class="ttname"><a href="structgj__handle.html#a2c396692d23acfbe592d99245d0130bf">gj_handle::binom</a></div><div class="ttdeci">vector&lt; vector&lt; int32_t &gt; &gt; binom</div><div class="ttdef"><b>Definition:</b> physicsdef.h:100</div></div>
<div class="ttc" id="structgj__handle_html_a2f488fdbc7994a7fc495a4b751cba1ff"><div class="ttname"><a href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">gj_handle::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> physicsdef.h:107</div></div>
<div class="ttc" id="structgj__handle_html_a11021ee6de06e1cf7016feed18da1c46"><div class="ttname"><a href="structgj__handle.html#a11021ee6de06e1cf7016feed18da1c46">gj_handle::alpha</a></div><div class="ttdeci">vector&lt; vector&lt; double &gt; &gt; alpha</div><div class="ttdef"><b>Definition:</b> physicsdef.h:106</div></div>
<div class="ttc" id="structgj__handle_html_ab647e87cf4004dff8d15f1dcf3baed95"><div class="ttname"><a href="structgj__handle.html#ab647e87cf4004dff8d15f1dcf3baed95">gj_handle::q</a></div><div class="ttdeci">vector&lt; double &gt; q</div><div class="ttdef"><b>Definition:</b> physicsdef.h:104</div></div>
<div class="ttc" id="structgj__handle_html_a3535e99a3323d7925c4bdaef7a330f11"><div class="ttname"><a href="structgj__handle.html#a3535e99a3323d7925c4bdaef7a330f11">gj_handle::c</a></div><div class="ttdeci">vector&lt; double &gt; c</div><div class="ttdef"><b>Definition:</b> physicsdef.h:101</div></div>
<div class="ttc" id="testprofiler_8c_html_ae1a3968e7947464bee7714f6d43b7002"><div class="ttname"><a href="testprofiler_8c.html#ae1a3968e7947464bee7714f6d43b7002">test</a></div><div class="ttdeci">void test()</div><div class="ttdef"><b>Definition:</b> testprofiler.c:34</div></div>
<div class="ttc" id="structgj__handle_html_aa4b6d601bbd7822f070449d8bbf5f791"><div class="ttname"><a href="structgj__handle.html#aa4b6d601bbd7822f070449d8bbf5f791">gj_handle::beta</a></div><div class="ttdeci">vector&lt; vector&lt; double &gt; &gt; beta</div><div class="ttdef"><b>Definition:</b> physicsdef.h:103</div></div>
<div class="ttc" id="structgj__handle_html_acbc5bd29496ca4d3b055cac4de98f8ae"><div class="ttname"><a href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">gj_handle::order</a></div><div class="ttdeci">uint32_t order</div><div class="ttdef"><b>Definition:</b> physicsdef.h:109</div></div>
<div class="ttc" id="structgj__handle_html_a62b8504d75c54a2c7b29bfb5d8c5d17e"><div class="ttname"><a href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">gj_handle::order2</a></div><div class="ttdeci">uint32_t order2</div><div class="ttdef"><b>Definition:</b> physicsdef.h:110</div></div>
<div class="ttc" id="structgj__handle_html_a7fd87f83546183ecfa0c85018a259aa1"><div class="ttname"><a href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">gj_handle::dtsq</a></div><div class="ttdeci">double dtsq</div><div class="ttdef"><b>Definition:</b> physicsdef.h:108</div></div>
<div class="ttc" id="structgj__handle_html_ae9962ed18b4c84e077e08e1fdf081795"><div class="ttname"><a href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">gj_handle::step</a></div><div class="ttdeci">vector&lt; gjstruc &gt; step</div><div class="ttdef"><b>Definition:</b> physicsdef.h:111</div></div>
<div class="ttc" id="structgj__handle_html_ab10da2fdeaa7e8616c5fadca72a51fb3"><div class="ttname"><a href="structgj__handle.html#ab10da2fdeaa7e8616c5fadca72a51fb3">gj_handle::lam</a></div><div class="ttdeci">vector&lt; double &gt; lam</div><div class="ttdef"><b>Definition:</b> physicsdef.h:105</div></div>
<div class="ttc" id="structgj__handle_html_aec279bc9f269750b73e88662323a3023"><div class="ttname"><a href="structgj__handle.html#aec279bc9f269750b73e88662323a3023">gj_handle::gam</a></div><div class="ttdeci">vector&lt; double &gt; gam</div><div class="ttdef"><b>Definition:</b> physicsdef.h:102</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga33b927b611e398ea2f1a033df736eb3b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gauss_jackson_init_tle </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>cinfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

</div>
</div>
<a class="anchor" id="ga3ce1f727eca8b17340829870f3265f07"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gauss_jackson_init_eci </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>utc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcartpos.html">cartpos</a>&#160;</td>
          <td class="paramname"><em>ipos</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structqatt.html">qatt</a>&#160;</td>
          <td class="paramname"><em>iatt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize Gauss-Jackson orbit using ECI state vector. </p>
<p>Initializes Gauss-Jackson structures using supplied initial state vector. </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">gjh</td><td>Reference to <a class="el" href="structgj__handle.html" title="Gauss-Jackson integration handle. ">gj_handle</a> for Gauss-Jackson integration. </td></tr>
    <tr><td class="paramname">order</td><td>the order at which the integration will be performed (must be even) </td></tr>
    <tr><td class="paramname">mode</td><td>Mode of physics propagation. Zero is free propagation. </td></tr>
    <tr><td class="paramname">dt</td><td>Step size in seconds </td></tr>
    <tr><td class="paramname">utc</td><td>Initial step time as UTC in Modified Julian Days </td></tr>
    <tr><td class="paramname">ipos</td><td>Initial ECI Position </td></tr>
    <tr><td class="paramname">iatt</td><td>Initial ICRF Attitude </td></tr>
    <tr><td class="paramname">physics</td><td>Reference to <a class="el" href="structphysicsstruc.html" title="Physics Simulation Structure. ">physicsstruc</a> to use. </td></tr>
    <tr><td class="paramname">loc</td><td>Reference to <a class="el" href="structlocstruc.html">locstruc</a> to use. </td></tr>
  </table>
  </dd>
</dl>
<div class="fragment"><div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;{</div><div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;    <a class="code" href="structkepstruc.html">kepstruc</a> kep;</div><div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160;    <span class="keywordtype">double</span> dea;</div><div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;    uint32_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;    <a class="code" href="structquaternion.html">quaternion</a> q1;</div><div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;</div><div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;    <span class="comment">// dt is modified during setup</span></div><div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a>(gjh, order, utc, <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>);</div><div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">dtj</a> = physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/86400.;</div><div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a> = mode;</div><div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160;</div><div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(loc);</div><div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc = loc;</div><div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;    ipos.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a> = iatt.<a class="code" href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">pass</a> = 0;</div><div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a> = ipos;</div><div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160;    loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a> = loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#ad1ba15f2863bf55e35585cfe5fc74261">utc</a>= utc;</div><div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;    <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;loc);</div><div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;</div><div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;    <span class="comment">// Initial attitude</span></div><div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;    <span class="keywordflow">switch</span> (physics.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a>)</div><div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;    {</div><div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;        <span class="comment">// Pure propagation</span></div><div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a> = iatt;</div><div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">pass</a>++;</div><div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga47c2eee20fb1d9d75dbec8e84fc0c133">att_icrf</a>(&amp;loc);</div><div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;        <span class="comment">// Force LVLH</span></div><div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">pass</a>++;</div><div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga438e3289001a472967115cee8c5b4fc7">att_lvlh</a>(&amp;loc);</div><div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;        <span class="comment">// Force 90 degrees off LVLH</span></div><div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a>(-<a class="code" href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a>);</div><div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga8cdd6821b23a178d39b82a5c1e2080d3">pos_eci2geoc</a>(&amp;loc);</div><div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;        <span class="comment">//      loc.att.icrf.s = q_drotate_between_rv(cinfo-&gt;pieces[physics.mode-2].normal,rv_smult(-1.,loc.pos.icrf.s));</span></div><div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga8cdd6821b23a178d39b82a5c1e2080d3">pos_eci2geoc</a>(&amp;loc);</div><div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;loc);</div><div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;    }</div><div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160;</div><div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;    <span class="comment">//    simulate_hardware(cinfo, loc);</span></div><div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(physics, loc);</div><div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;    <span class="comment">//    simulate_hardware(cinfo, loc);</span></div><div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, loc);</div><div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;</div><div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc = loc;</div><div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;</div><div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;    <span class="comment">// Position at t0-dt</span></div><div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;    <a class="code" href="group__convertlib__functions.html#gaef06a0173c093800cf74d958890a391a">eci2kep</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>,kep);</div><div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160;    <span class="comment">//  kep2eci(&amp;kep,&amp;gjh.step[gjh.order2].sloc.pos.eci);</span></div><div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;    <span class="keywordflow">for</span> (i=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-1; i&lt;gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>; --i)</div><div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;    {</div><div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i+1].sloc;</div><div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc -= <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> / 86400.;</div><div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;        kep.<a class="code" href="structkepstruc.html#a726379e1a16af943a6b2420bd406b5a5">utc</a> = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc;</div><div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160;        kep.<a class="code" href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">ma</a> -= <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> * kep.<a class="code" href="structkepstruc.html#ac717c9dec8ed462c1c7241283ba9797e">mm</a>;</div><div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;</div><div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160;        uint16_t <a class="code" href="rw__test_8cpp.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a> = 0;</div><div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;        {</div><div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160;            dea = (kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> - kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> * sin(kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a>) - kep.<a class="code" href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">ma</a>) / (1. - kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> * cos(kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a>));</div><div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;            kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> -= dea;</div><div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;        } <span class="keywordflow">while</span> (++count &lt; 100 &amp;&amp; fabs(dea) &gt; .000001);</div><div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a>(kep,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.pos.eci);</div><div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.pos.eci.pass++;</div><div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;</div><div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160;        q1 = <a class="code" href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a>(<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-<a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.v));</div><div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.s = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(q1,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.s);</div><div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;        <a class="code" href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.s);</div><div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;        <span class="comment">// Calculate new v from da</span></div><div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.v = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.v,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-<a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.a));</div><div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;        <span class="comment">//      gjh.step[i].sloc.att.icrf.utc -= dt/86400.;</span></div><div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;        <span class="comment">//      att_icrf2lvlh(&amp;gjh.step[i].sloc);</span></div><div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160;</div><div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;        <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;        <span class="comment">//      hardware_init_eci(cinfo,gjh.step[i].sloc);</span></div><div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;    }</div><div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;</div><div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160;    <a class="code" href="group__convertlib__functions.html#gaef06a0173c093800cf74d958890a391a">eci2kep</a>(loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>,kep);</div><div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;    <span class="keywordflow">for</span> (i=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+1; i&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; i++)</div><div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160;    {</div><div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i-1].sloc;</div><div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc += <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> / 86400.;</div><div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;        kep.<a class="code" href="structkepstruc.html#a726379e1a16af943a6b2420bd406b5a5">utc</a> = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc;</div><div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160;        kep.<a class="code" href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">ma</a> += <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> * kep.<a class="code" href="structkepstruc.html#ac717c9dec8ed462c1c7241283ba9797e">mm</a>;</div><div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;</div><div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;        uint16_t count = 0;</div><div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;        {</div><div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;            dea = (kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> - kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> * sin(kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a>) - kep.<a class="code" href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">ma</a>) / (1. - kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> * cos(kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a>));</div><div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160;            kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> -= dea;</div><div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;        } <span class="keywordflow">while</span> (++count &lt; 100 &amp;&amp; fabs(dea) &gt; .000001);</div><div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a>(kep,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.pos.eci);</div><div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.pos.eci.pass++;</div><div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160;</div><div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;        q1 = <a class="code" href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a>(<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(<a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.v));</div><div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.s = <a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(q1,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.s);</div><div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;        <a class="code" href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.s);</div><div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160;        <span class="comment">// Calculate new v from da</span></div><div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.v = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.v,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(<a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.att.icrf.a));</div><div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;        <span class="comment">//      gjh.step[i].sloc.att.icrf.utc += dt/86400.;</span></div><div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;        <span class="comment">//      att_icrf2lvlh(&amp;gjh.step[i].sloc);</span></div><div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;</div><div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;        <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;        <span class="comment">//      hardware_init_eci(cinfo, gjh.step[i].sloc);</span></div><div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;    }</div><div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;    loc = <a class="code" href="group__physicslib__functions.html#ga117e8280d2377a657c3648bc8c217967">gauss_jackson_converge_orbit</a>(gjh, physics);</div><div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga798e201a0205dabc1a938fb8ff09c496">gauss_jackson_converge_hardware</a>(gjh, physics);</div><div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">mjdbase</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160;}</div><div class="ttc" id="structkepstruc_html_ac717c9dec8ed462c1c7241283ba9797e"><div class="ttname"><a href="structkepstruc.html#ac717c9dec8ed462c1c7241283ba9797e">kepstruc::mm</a></div><div class="ttdeci">double mm</div><div class="ttdoc">Mean Motion. </div><div class="ttdef"><b>Definition:</b> convertdef.h:326</div></div>
<div class="ttc" id="group__convertlib__functions_html_gaef06a0173c093800cf74d958890a391a"><div class="ttname"><a href="group__convertlib__functions.html#gaef06a0173c093800cf74d958890a391a">eci2kep</a></div><div class="ttdeci">void eci2kep(cartpos &amp;eci, kepstruc &amp;kep)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2865</div></div>
<div class="ttc" id="group__mathlib__functions_html_gad3d78ceb8af40ce126896a854dc2bb22"><div class="ttname"><a href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a></div><div class="ttdeci">rvector rv_add(rvector a, rvector b)</div><div class="ttdoc">Add two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:299</div></div>
<div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="structkepstruc_html_a726379e1a16af943a6b2420bd406b5a5"><div class="ttname"><a href="structkepstruc.html#a726379e1a16af943a6b2420bd406b5a5">kepstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">UTC time of state vector in MJD. </div><div class="ttdef"><b>Definition:</b> convertdef.h:297</div></div>
<div class="ttc" id="structcartpos_html_ad1ba15f2863bf55e35585cfe5fc74261"><div class="ttname"><a href="structcartpos.html#ad1ba15f2863bf55e35585cfe5fc74261">cartpos::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">UTC of Position. </div><div class="ttdef"><b>Definition:</b> convertdef.h:161</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structkepstruc_html_ae642bc437de0f034b91232ea697ac222"><div class="ttname"><a href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">kepstruc::e</a></div><div class="ttdeci">double e</div><div class="ttdoc">Eccentricity. </div><div class="ttdef"><b>Definition:</b> convertdef.h:305</div></div>
<div class="ttc" id="rw__test_8cpp_html_ad43c3812e6d13e0518d9f8b8f463ffcf"><div class="ttname"><a href="rw__test_8cpp.html#ad43c3812e6d13e0518d9f8b8f463ffcf">count</a></div><div class="ttdeci">int count</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:36</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="structkepstruc_html_a0100c740a995bbaa0400b93f58548d5e"><div class="ttname"><a href="structkepstruc.html#a0100c740a995bbaa0400b93f58548d5e">kepstruc::ma</a></div><div class="ttdeci">double ma</div><div class="ttdoc">Mean Anomoly. </div><div class="ttdef"><b>Definition:</b> convertdef.h:320</div></div>
<div class="ttc" id="structquaternion_html"><div class="ttname"><a href="structquaternion.html">quaternion</a></div><div class="ttdoc">Quaternion, scalar last, using x, y, z. </div><div class="ttdef"><b>Definition:</b> vector.h:213</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga4a24ca18a4f5b089270218620aad45ae"><div class="ttname"><a href="group__mathlib__functions.html#ga4a24ca18a4f5b089270218620aad45ae">q_axis2quaternion_rv</a></div><div class="ttdeci">quaternion q_axis2quaternion_rv(rvector v)</div><div class="ttdoc">Row vector axis and angle to Quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:260</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga5fffad1b57bb62f03d4037deaed8735b"><div class="ttname"><a href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a></div><div class="ttdeci">const double DPI2</div><div class="ttdoc">Double precision PI/2. </div><div class="ttdef"><b>Definition:</b> math/constants.h:18</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a315541d00c2de86f212c310d26527512"><div class="ttname"><a href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a></div><div class="ttdeci">quaternion q_change_around_y(double angle)</div><div class="ttdoc">Rotation quaternion for Y axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1435</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="vector_8cpp_html_ad3b9f20d98c02e6a2c6fc57a7c55826d"><div class="ttname"><a href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a></div><div class="ttdeci">void normalize_q(quaternion *q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:961</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga117e8280d2377a657c3648bc8c217967"><div class="ttname"><a href="group__physicslib__functions.html#ga117e8280d2377a657c3648bc8c217967">gauss_jackson_converge_orbit</a></div><div class="ttdeci">locstruc gauss_jackson_converge_orbit(gj_handle &amp;gjh, physicsstruc &amp;physics)</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2761</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8cdd6821b23a178d39b82a5c1e2080d3"><div class="ttname"><a href="group__convertlib__functions.html#ga8cdd6821b23a178d39b82a5c1e2080d3">pos_eci2geoc</a></div><div class="ttdeci">int32_t pos_eci2geoc(locstruc *loc)</div><div class="ttdoc">Convert ECI to GEOC. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:825</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga51cb3beea90cb416ce61a5787eeb6be8"><div class="ttname"><a href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a></div><div class="ttdeci">void kep2eci(kepstruc &amp;kep, cartpos &amp;eci)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2811</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga47c2eee20fb1d9d75dbec8e84fc0c133"><div class="ttname"><a href="group__convertlib__functions.html#ga47c2eee20fb1d9d75dbec8e84fc0c133">att_icrf</a></div><div class="ttdeci">void att_icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1798</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structkepstruc_html"><div class="ttname"><a href="structkepstruc.html">kepstruc</a></div><div class="ttdoc">Classical elements structure. </div><div class="ttdef"><b>Definition:</b> convertdef.h:294</div></div>
<div class="ttc" id="structgj__handle_html_acbc5bd29496ca4d3b055cac4de98f8ae"><div class="ttname"><a href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">gj_handle::order</a></div><div class="ttdeci">uint32_t order</div><div class="ttdef"><b>Definition:</b> physicsdef.h:109</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structgj__handle_html_a62b8504d75c54a2c7b29bfb5d8c5d17e"><div class="ttname"><a href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">gj_handle::order2</a></div><div class="ttdeci">uint32_t order2</div><div class="ttdef"><b>Definition:</b> physicsdef.h:110</div></div>
<div class="ttc" id="structqatt_html_aa206cfdf50dd7c1e53d2880672480de6"><div class="ttname"><a href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">qatt::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:285</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structphysicsstruc_html_ad34bd2ae633ea1bdbf01e2f38bf35a36"><div class="ttname"><a href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">physicsstruc::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Time step in seconds. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:141</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga798e201a0205dabc1a938fb8ff09c496"><div class="ttname"><a href="group__physicslib__functions.html#ga798e201a0205dabc1a938fb8ff09c496">gauss_jackson_converge_hardware</a></div><div class="ttdeci">void gauss_jackson_converge_hardware(gj_handle &amp;gjh, physicsstruc &amp;physics)</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2862</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="structgj__handle_html_ae9962ed18b4c84e077e08e1fdf081795"><div class="ttname"><a href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">gj_handle::step</a></div><div class="ttdeci">vector&lt; gjstruc &gt; step</div><div class="ttdef"><b>Definition:</b> physicsdef.h:111</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structphysicsstruc_html_ac7ce668e6c24f9cc73b884da33a758ce"><div class="ttname"><a href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">physicsstruc::mode</a></div><div class="ttdeci">int32_t mode</div><div class="ttdef"><b>Definition:</b> physicsdef.h:151</div></div>
<div class="ttc" id="structkepstruc_html_a5208f0a1e729fe15297160012146b165"><div class="ttname"><a href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">kepstruc::ea</a></div><div class="ttdeci">double ea</div><div class="ttdoc">Eccentric Anomoly. </div><div class="ttdef"><b>Definition:</b> convertdef.h:324</div></div>
<div class="ttc" id="structphysicsstruc_html_a52ff2d9795a3a78753a6bbe1e0bb5b6e"><div class="ttname"><a href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">physicsstruc::dtj</a></div><div class="ttdeci">double dtj</div><div class="ttdoc">Time step in Julian days. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:143</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga438e3289001a472967115cee8c5b4fc7"><div class="ttname"><a href="group__convertlib__functions.html#ga438e3289001a472967115cee8c5b4fc7">att_lvlh</a></div><div class="ttdeci">int32_t att_lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2019</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga8678ece24649523ac1139bc6072e28bd"><div class="ttname"><a href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a></div><div class="ttdeci">void gauss_jackson_setup(gj_handle &amp;gjh, uint32_t order, double utc, double &amp;dt)</div><div class="ttdoc">Prepare for Gauss-Jackson integration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2219</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
<div class="ttc" id="structphysicsstruc_html_a7c26927025bc587595b9f328042ff8fa"><div class="ttname"><a href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">physicsstruc::mjdbase</a></div><div class="ttdeci">double mjdbase</div><div class="ttdoc">Simulated starting time in MJD. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:145</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gad4f9a6f69d513aacac201759e7ee33ad"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gauss_jackson_init_stk </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structstkstruc.html">stkstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>stk</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;{</div><div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;    uint32_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;</div><div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a> = mode;</div><div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a>(gjh, order, utc, physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>);</div><div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">dtj</a> = physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/86400.;</div><div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160;</div><div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(loc);</div><div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc = loc;</div><div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a>(utc,stk,loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>);</div><div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160;    loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = utc;</div><div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;    loc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160;    <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;loc);</div><div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160;</div><div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;    <span class="comment">// Initial attitude</span></div><div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a729474b703b213c723c98937382c673c">ftorque</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;    <span class="keywordflow">switch</span> (physics.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a>)</div><div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;    {</div><div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160;    <span class="comment">//case 0:</span></div><div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;    <span class="comment">//  loc.att.icrf.utc = loc.utc;</span></div><div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;    <span class="comment">//  loc.att.icrf.s = q_eye();</span></div><div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;    <span class="comment">//  loc.att.icrf.v = loc.att.icrf.a = rv_zero();</span></div><div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <span class="comment">//  att_icrf(&amp;loc);</span></div><div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <span class="comment">//  break;</span></div><div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a>(-<a class="code" href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a>);</div><div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;loc);</div><div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;        <span class="comment">//        loc.att.icrf.s = q_drotate_between_rv(physics.pieces[physics.mode-2].normal,rv_smult(-1.,loc.pos.icrf.s));</span></div><div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;        loc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;loc);</div><div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;    }</div><div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;</div><div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;</div><div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;    <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160;    <span class="comment">//    hardware_init_eci(physics.devspec, loc);</span></div><div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, loc);</div><div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160;    <span class="comment">//  groundstations(cinfo,&amp;loc);</span></div><div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;</div><div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;    gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc = loc;</div><div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;</div><div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;    <span class="comment">// Position at t0-dt</span></div><div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;    <span class="keywordflow">for</span> (i=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-1; i&lt;gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>; --i)</div><div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;    {</div><div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i+1].sloc;</div><div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc -= <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> / 86400.;</div><div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.icrf.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc;</div><div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;        <a class="code" href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.utc,stk,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.pos.eci);</div><div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.pos.eci.pass++;</div><div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;</div><div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.lvlh = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i+1].sloc.att.lvlh;</div><div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;</div><div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;        <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;        <span class="comment">//        hardware_init_eci(physics.devspec,gjh.step[i].sloc);</span></div><div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    }</div><div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;</div><div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160;    <span class="keywordflow">for</span> (i=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+1; i&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; i++)</div><div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;    {</div><div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i-1].sloc;</div><div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc += <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> / 86400.;</div><div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;        <a class="code" href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.utc,stk,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc.pos.eci);</div><div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.pos.eci.pass++;</div><div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;</div><div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.lvlh = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i-1].sloc.att.lvlh;</div><div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.att.lvlh.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc.utc;</div><div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;</div><div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;        <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;        <span class="comment">//        hardware_init_eci(physics.devspec,gjh.step[i].sloc);</span></div><div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[i].sloc);</div><div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;    }</div><div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;</div><div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;    loc = <a class="code" href="group__physicslib__functions.html#ga117e8280d2377a657c3648bc8c217967">gauss_jackson_converge_orbit</a>(gjh, physics);</div><div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga798e201a0205dabc1a938fb8ff09c496">gauss_jackson_converge_hardware</a>(gjh, physics);</div><div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">mjdbase</a> = loc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;}</div><div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structphysicsstruc_html_a729474b703b213c723c98937382c673c"><div class="ttname"><a href="structphysicsstruc.html#a729474b703b213c723c98937382c673c">physicsstruc::ftorque</a></div><div class="ttdeci">Vector ftorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:153</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga5fffad1b57bb62f03d4037deaed8735b"><div class="ttname"><a href="group__mathlib__constants.html#ga5fffad1b57bb62f03d4037deaed8735b">DPI2</a></div><div class="ttdeci">const double DPI2</div><div class="ttdoc">Double precision PI/2. </div><div class="ttdef"><b>Definition:</b> math/constants.h:18</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="vector_8cpp_html_a315541d00c2de86f212c310d26527512"><div class="ttname"><a href="vector_8cpp.html#a315541d00c2de86f212c310d26527512">q_change_around_y</a></div><div class="ttdeci">quaternion q_change_around_y(double angle)</div><div class="ttdoc">Rotation quaternion for Y axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1435</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga117e8280d2377a657c3648bc8c217967"><div class="ttname"><a href="group__physicslib__functions.html#ga117e8280d2377a657c3648bc8c217967">gauss_jackson_converge_orbit</a></div><div class="ttdeci">locstruc gauss_jackson_converge_orbit(gj_handle &amp;gjh, physicsstruc &amp;physics)</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2761</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structgj__handle_html_acbc5bd29496ca4d3b055cac4de98f8ae"><div class="ttname"><a href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">gj_handle::order</a></div><div class="ttdeci">uint32_t order</div><div class="ttdef"><b>Definition:</b> physicsdef.h:109</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structgj__handle_html_a62b8504d75c54a2c7b29bfb5d8c5d17e"><div class="ttname"><a href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">gj_handle::order2</a></div><div class="ttdeci">uint32_t order2</div><div class="ttdef"><b>Definition:</b> physicsdef.h:110</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structphysicsstruc_html_ad34bd2ae633ea1bdbf01e2f38bf35a36"><div class="ttname"><a href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">physicsstruc::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Time step in seconds. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:141</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga798e201a0205dabc1a938fb8ff09c496"><div class="ttname"><a href="group__physicslib__functions.html#ga798e201a0205dabc1a938fb8ff09c496">gauss_jackson_converge_hardware</a></div><div class="ttdeci">void gauss_jackson_converge_hardware(gj_handle &amp;gjh, physicsstruc &amp;physics)</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2862</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="structgj__handle_html_ae9962ed18b4c84e077e08e1fdf081795"><div class="ttname"><a href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">gj_handle::step</a></div><div class="ttdeci">vector&lt; gjstruc &gt; step</div><div class="ttdef"><b>Definition:</b> physicsdef.h:111</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structphysicsstruc_html_ac7ce668e6c24f9cc73b884da33a758ce"><div class="ttname"><a href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">physicsstruc::mode</a></div><div class="ttdeci">int32_t mode</div><div class="ttdef"><b>Definition:</b> physicsdef.h:151</div></div>
<div class="ttc" id="structphysicsstruc_html_a52ff2d9795a3a78753a6bbe1e0bb5b6e"><div class="ttname"><a href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">physicsstruc::dtj</a></div><div class="ttdeci">double dtj</div><div class="ttdoc">Time step in Julian days. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:143</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga8678ece24649523ac1139bc6072e28bd"><div class="ttname"><a href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a></div><div class="ttdeci">void gauss_jackson_setup(gj_handle &amp;gjh, uint32_t order, double utc, double &amp;dt)</div><div class="ttdoc">Prepare for Gauss-Jackson integration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2219</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad43f2fcdeaaa277215f0e490f443af08"><div class="ttname"><a href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a></div><div class="ttdeci">int stk2eci(double utc, stkstruc &amp;stk, cartpos &amp;eci)</div><div class="ttdoc">ECI from STK data. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3732</div></div>
<div class="ttc" id="structphysicsstruc_html_a7c26927025bc587595b9f328042ff8fa"><div class="ttname"><a href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">physicsstruc::mjdbase</a></div><div class="ttdeci">double mjdbase</div><div class="ttdoc">Simulated starting time in MJD. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:145</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="gae301914bfb352281d8bd8a0252e716db"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gauss_jackson_init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint32_t&#160;</td>
          <td class="paramname"><em>order</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>altitude</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>angle</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>hour</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>iloc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;{</div><div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;    <span class="keywordtype">double</span> lon;</div><div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;    <a class="code" href="structkepstruc.html">kepstruc</a> kep;</div><div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;</div><div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;    lon = <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a> * (fabs(hour)/24. - (utc - (int)utc));</div><div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;    <span class="keywordflow">if</span> (lon &lt; -<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>)</div><div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;        lon += <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;    <span class="keywordflow">if</span> (lon &gt; <a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>)</div><div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;        lon -= <a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>;</div><div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;</div><div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a> = mode;</div><div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a>(gjh, order, utc, physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>);</div><div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">dtj</a> = physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/86400.;</div><div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160;    <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a> = utc;</div><div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;</div><div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;    <span class="comment">// Initial position</span></div><div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(iloc);</div><div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;    kep.<a class="code" href="structkepstruc.html#a726379e1a16af943a6b2420bd406b5a5">utc</a> = utc;</div><div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;    kep.<a class="code" href="structkepstruc.html#aa61551401490f1323a6facd9a3790c11">a</a> = <a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a> + altitude;</div><div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;    kep.<a class="code" href="structkepstruc.html#acd076bf6527f0203975d971610abfb5d">i</a> = angle;</div><div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;    kep.<a class="code" href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">e</a> = 0.;</div><div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;    kep.<a class="code" href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">ea</a> = 0.;</div><div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;    kep.<a class="code" href="structkepstruc.html#a692936a3a81d40467cb522d1eddb528a">ap</a> = 0.;</div><div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;    kep.<a class="code" href="structkepstruc.html#af0aa44d91ce08e0a9f7cb4acd1ebb15f">raan</a> = lon;</div><div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a>(kep, iloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>);</div><div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;    ++iloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">geoc</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>;</div><div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga61a44ed1aa24a1d448b7475ad4bef45d">pos_geoc</a>(&amp;iloc);</div><div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;</div><div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;    iloc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;    iloc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;    iloc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">a</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;    ++iloc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">pass</a>;</div><div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;    <a class="code" href="group__convertlib__functions.html#ga438e3289001a472967115cee8c5b4fc7">att_lvlh</a>(&amp;iloc);</div><div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;</div><div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga3ce1f727eca8b17340829870f3265f07">gauss_jackson_init_eci</a>(gjh, order, mode, physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>, utc, iloc.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>, iloc.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>, physics, loc);</div><div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;    physics.<a class="code" href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">mjdbase</a> = iloc.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;}</div><div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="structkepstruc_html_a726379e1a16af943a6b2420bd406b5a5"><div class="ttname"><a href="structkepstruc.html#a726379e1a16af943a6b2420bd406b5a5">kepstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">UTC time of state vector in MJD. </div><div class="ttdef"><b>Definition:</b> convertdef.h:297</div></div>
<div class="ttc" id="structkepstruc_html_ae642bc437de0f034b91232ea697ac222"><div class="ttname"><a href="structkepstruc.html#ae642bc437de0f034b91232ea697ac222">kepstruc::e</a></div><div class="ttdeci">double e</div><div class="ttdoc">Eccentricity. </div><div class="ttdef"><b>Definition:</b> convertdef.h:305</div></div>
<div class="ttc" id="structqatt_html_a1992b6fe91058cb7e0b2629dbef5b444"><div class="ttname"><a href="structqatt.html#a1992b6fe91058cb7e0b2629dbef5b444">qatt::a</a></div><div class="ttdeci">rvector a</div><div class="ttdoc">2nd derivative: Alpha - acceleration </div><div class="ttdef"><b>Definition:</b> convertdef.h:283</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga3ce1f727eca8b17340829870f3265f07"><div class="ttname"><a href="group__physicslib__functions.html#ga3ce1f727eca8b17340829870f3265f07">gauss_jackson_init_eci</a></div><div class="ttdeci">void gauss_jackson_init_eci(gj_handle &amp;gjh, uint32_t order, int32_t mode, double dt, double utc, cartpos ipos, qatt iatt, physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Initialize Gauss-Jackson orbit using ECI state vector. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2479</div></div>
<div class="ttc" id="structposstruc_html_af9f736cccdc7b112c3454b7512be3f6c"><div class="ttname"><a href="structposstruc.html#af9f736cccdc7b112c3454b7512be3f6c">posstruc::geoc</a></div><div class="ttdeci">cartpos geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:398</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="physicslib_8cpp_html_a56b5812a8b6883ca5fe5e5345a526b75"><div class="ttname"><a href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a></div><div class="ttdeci">static double initialutc</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:43</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga61a44ed1aa24a1d448b7475ad4bef45d"><div class="ttname"><a href="group__convertlib__functions.html#ga61a44ed1aa24a1d448b7475ad4bef45d">pos_geoc</a></div><div class="ttdeci">int32_t pos_geoc(locstruc *loc)</div><div class="ttdoc">Set Geocentric position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:355</div></div>
<div class="ttc" id="structkepstruc_html_af0aa44d91ce08e0a9f7cb4acd1ebb15f"><div class="ttname"><a href="structkepstruc.html#af0aa44d91ce08e0a9f7cb4acd1ebb15f">kepstruc::raan</a></div><div class="ttdeci">double raan</div><div class="ttdoc">Right Ascension of the Ascending Node in radians. </div><div class="ttdef"><b>Definition:</b> convertdef.h:314</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga51cb3beea90cb416ce61a5787eeb6be8"><div class="ttname"><a href="group__convertlib__functions.html#ga51cb3beea90cb416ce61a5787eeb6be8">kep2eci</a></div><div class="ttdeci">void kep2eci(kepstruc &amp;kep, cartpos &amp;eci)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2811</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structkepstruc_html"><div class="ttname"><a href="structkepstruc.html">kepstruc</a></div><div class="ttdoc">Classical elements structure. </div><div class="ttdef"><b>Definition:</b> convertdef.h:294</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structqatt_html_aa206cfdf50dd7c1e53d2880672480de6"><div class="ttname"><a href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">qatt::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:285</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="structkepstruc_html_a692936a3a81d40467cb522d1eddb528a"><div class="ttname"><a href="structkepstruc.html#a692936a3a81d40467cb522d1eddb528a">kepstruc::ap</a></div><div class="ttdeci">double ap</div><div class="ttdoc">Argument of Perigee. </div><div class="ttdef"><b>Definition:</b> convertdef.h:316</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structphysicsstruc_html_ad34bd2ae633ea1bdbf01e2f38bf35a36"><div class="ttname"><a href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">physicsstruc::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Time step in seconds. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:141</div></div>
<div class="ttc" id="structkepstruc_html_acd076bf6527f0203975d971610abfb5d"><div class="ttname"><a href="structkepstruc.html#acd076bf6527f0203975d971610abfb5d">kepstruc::i</a></div><div class="ttdeci">double i</div><div class="ttdoc">Orbital Inclination in radians. </div><div class="ttdef"><b>Definition:</b> convertdef.h:312</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structkepstruc_html_aa61551401490f1323a6facd9a3790c11"><div class="ttname"><a href="structkepstruc.html#aa61551401490f1323a6facd9a3790c11">kepstruc::a</a></div><div class="ttdeci">double a</div><div class="ttdoc">Semi-Major Axis in meters. </div><div class="ttdef"><b>Definition:</b> convertdef.h:303</div></div>
<div class="ttc" id="structphysicsstruc_html_ac7ce668e6c24f9cc73b884da33a758ce"><div class="ttname"><a href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">physicsstruc::mode</a></div><div class="ttdeci">int32_t mode</div><div class="ttdef"><b>Definition:</b> physicsdef.h:151</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="structkepstruc_html_a5208f0a1e729fe15297160012146b165"><div class="ttname"><a href="structkepstruc.html#a5208f0a1e729fe15297160012146b165">kepstruc::ea</a></div><div class="ttdeci">double ea</div><div class="ttdoc">Eccentric Anomoly. </div><div class="ttdef"><b>Definition:</b> convertdef.h:324</div></div>
<div class="ttc" id="structphysicsstruc_html_a52ff2d9795a3a78753a6bbe1e0bb5b6e"><div class="ttname"><a href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">physicsstruc::dtj</a></div><div class="ttdeci">double dtj</div><div class="ttdoc">Time step in Julian days. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:143</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga438e3289001a472967115cee8c5b4fc7"><div class="ttname"><a href="group__convertlib__functions.html#ga438e3289001a472967115cee8c5b4fc7">att_lvlh</a></div><div class="ttdeci">int32_t att_lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2019</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga8678ece24649523ac1139bc6072e28bd"><div class="ttname"><a href="group__physicslib__functions.html#ga8678ece24649523ac1139bc6072e28bd">gauss_jackson_setup</a></div><div class="ttdeci">void gauss_jackson_setup(gj_handle &amp;gjh, uint32_t order, double utc, double &amp;dt)</div><div class="ttdoc">Prepare for Gauss-Jackson integration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:2219</div></div>
<div class="ttc" id="structphysicsstruc_html_a7c26927025bc587595b9f328042ff8fa"><div class="ttname"><a href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">physicsstruc::mjdbase</a></div><div class="ttdeci">double mjdbase</div><div class="ttdoc">Simulated starting time in MJD. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:145</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga117e8280d2377a657c3648bc8c217967"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="structlocstruc.html">locstruc</a> gauss_jackson_converge_orbit </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;{</div><div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;    uint32_t c_cnt, cflag=0, k, n, <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>;</div><div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;    <a class="code" href="structrvector.html">rvector</a> oldsa;</div><div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;</div><div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;    c_cnt = 0;</div><div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;    <span class="keywordflow">do</span></div><div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;    {</div><div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].s.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc.pos.eci.v.col[0]/gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a>;</div><div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].s.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc.pos.eci.v.col[1]/gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a>;</div><div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].s.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc.pos.eci.v.col[2]/gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a>;</div><div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; k++)</div><div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;        {</div><div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].s.col[0] -= gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].s.col[1] -= gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].s.col[2] -= gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;        }</div><div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160;        <span class="keywordflow">for</span> (n=1; n&lt;=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>; n++)</div><div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160;        {</div><div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].s.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].s.col[0] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].sloc.pos.eci.a.col[0]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].sloc.pos.eci.a.col[0])/2;</div><div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].s.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].s.col[1] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].sloc.pos.eci.a.col[1]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].sloc.pos.eci.a.col[1])/2;</div><div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].s.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].s.col[2] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].sloc.pos.eci.a.col[2]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].sloc.pos.eci.a.col[2])/2;</div><div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].s.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].s.col[0] - (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].sloc.pos.eci.a.col[0]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].sloc.pos.eci.a.col[0])/2;</div><div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].s.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].s.col[1] - (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].sloc.pos.eci.a.col[1]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].sloc.pos.eci.a.col[1])/2;</div><div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].s.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].s.col[2] - (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].sloc.pos.eci.a.col[2]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].sloc.pos.eci.a.col[2])/2;</div><div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;        }</div><div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].ss.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc.pos.eci.s.col[0]/gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a>;</div><div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].ss.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc.pos.eci.s.col[1]/gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a>;</div><div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].ss.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].sloc.pos.eci.s.col[2]/gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a>;</div><div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; k++)</div><div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160;        {</div><div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].ss.col[0] -= gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].ss.col[1] -= gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].ss.col[2] -= gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02795"></a><span class="lineno"> 2795</span>&#160;        }</div><div class="line"><a name="l02796"></a><span class="lineno"> 2796</span>&#160;        <span class="keywordflow">for</span> (n=1; n&lt;=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>; n++)</div><div class="line"><a name="l02797"></a><span class="lineno"> 2797</span>&#160;        {</div><div class="line"><a name="l02798"></a><span class="lineno"> 2798</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].ss.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].ss.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].s.col[0] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].sloc.pos.eci.a.col[0])/2;</div><div class="line"><a name="l02799"></a><span class="lineno"> 2799</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].ss.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].ss.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].s.col[1] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].sloc.pos.eci.a.col[1])/2;</div><div class="line"><a name="l02800"></a><span class="lineno"> 2800</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n].ss.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].ss.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].s.col[2] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+n-1].sloc.pos.eci.a.col[2])/2;</div><div class="line"><a name="l02801"></a><span class="lineno"> 2801</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].ss.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].ss.col[0] - gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].s.col[0] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].sloc.pos.eci.a.col[0])/2;</div><div class="line"><a name="l02802"></a><span class="lineno"> 2802</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].ss.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].ss.col[1] - gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].s.col[1] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].sloc.pos.eci.a.col[1])/2;</div><div class="line"><a name="l02803"></a><span class="lineno"> 2803</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n].ss.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].ss.col[2] - gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].s.col[2] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>-n+1].sloc.pos.eci.a.col[2])/2;</div><div class="line"><a name="l02804"></a><span class="lineno"> 2804</span>&#160;        }</div><div class="line"><a name="l02805"></a><span class="lineno"> 2805</span>&#160;</div><div class="line"><a name="l02806"></a><span class="lineno"> 2806</span>&#160;        <span class="keywordflow">for</span> (n=0; n&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; n++)</div><div class="line"><a name="l02807"></a><span class="lineno"> 2807</span>&#160;        {</div><div class="line"><a name="l02808"></a><span class="lineno"> 2808</span>&#160;            <span class="keywordflow">if</span> (n == gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>)</div><div class="line"><a name="l02809"></a><span class="lineno"> 2809</span>&#160;                <span class="keywordflow">continue</span>;</div><div class="line"><a name="l02810"></a><span class="lineno"> 2810</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sb = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sa = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02811"></a><span class="lineno"> 2811</span>&#160;            <span class="keywordflow">for</span> (k=0; k&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; k++)</div><div class="line"><a name="l02812"></a><span class="lineno"> 2812</span>&#160;            {</div><div class="line"><a name="l02813"></a><span class="lineno"> 2813</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sb.col[0] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02814"></a><span class="lineno"> 2814</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sa.col[0] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02815"></a><span class="lineno"> 2815</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sb.col[1] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02816"></a><span class="lineno"> 2816</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sa.col[1] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02817"></a><span class="lineno"> 2817</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sb.col[2] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02818"></a><span class="lineno"> 2818</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].sa.col[2] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[n].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02819"></a><span class="lineno"> 2819</span>&#160;            }</div><div class="line"><a name="l02820"></a><span class="lineno"> 2820</span>&#160;        }</div><div class="line"><a name="l02821"></a><span class="lineno"> 2821</span>&#160;</div><div class="line"><a name="l02822"></a><span class="lineno"> 2822</span>&#160;        <span class="keywordflow">for</span> (n=1; n&lt;=gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>; n++)</div><div class="line"><a name="l02823"></a><span class="lineno"> 2823</span>&#160;        {</div><div class="line"><a name="l02824"></a><span class="lineno"> 2824</span>&#160;            <span class="keywordflow">for</span> (i=-1; i&lt;2; i+=2)</div><div class="line"><a name="l02825"></a><span class="lineno"> 2825</span>&#160;            {</div><div class="line"><a name="l02826"></a><span class="lineno"> 2826</span>&#160;                cflag = 0;</div><div class="line"><a name="l02827"></a><span class="lineno"> 2827</span>&#160;</div><div class="line"><a name="l02828"></a><span class="lineno"> 2828</span>&#160;                <span class="comment">// Save current acceleration for comparison with next iteration</span></div><div class="line"><a name="l02829"></a><span class="lineno"> 2829</span>&#160;                oldsa.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02830"></a><span class="lineno"> 2830</span>&#160;                oldsa.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02831"></a><span class="lineno"> 2831</span>&#160;                oldsa.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02832"></a><span class="lineno"> 2832</span>&#160;</div><div class="line"><a name="l02833"></a><span class="lineno"> 2833</span>&#160;                <span class="comment">// Calculate new probable position and velocity</span></div><div class="line"><a name="l02834"></a><span class="lineno"> 2834</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.v.col[0] = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].s.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sb.col[0]);</div><div class="line"><a name="l02835"></a><span class="lineno"> 2835</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.v.col[1] = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].s.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sb.col[1]);</div><div class="line"><a name="l02836"></a><span class="lineno"> 2836</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.v.col[2] = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].s.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sb.col[2]);</div><div class="line"><a name="l02837"></a><span class="lineno"> 2837</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.s.col[0] = gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].ss.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sa.col[0]);</div><div class="line"><a name="l02838"></a><span class="lineno"> 2838</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.s.col[1] = gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].ss.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sa.col[1]);</div><div class="line"><a name="l02839"></a><span class="lineno"> 2839</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.s.col[2] = gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].ss.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sa.col[2]);</div><div class="line"><a name="l02840"></a><span class="lineno"> 2840</span>&#160;</div><div class="line"><a name="l02841"></a><span class="lineno"> 2841</span>&#160;                <span class="comment">// Perform conversions between different systems</span></div><div class="line"><a name="l02842"></a><span class="lineno"> 2842</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.pass++;</div><div class="line"><a name="l02843"></a><span class="lineno"> 2843</span>&#160;                <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc);</div><div class="line"><a name="l02844"></a><span class="lineno"> 2844</span>&#160;                <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc);</div><div class="line"><a name="l02845"></a><span class="lineno"> 2845</span>&#160;                <span class="comment">//      eci2earth(&amp;gjh.step[gjh.order2+i*n].sloc.pos,&amp;gjh.step[gjh.order2+i*n].sloc.att);</span></div><div class="line"><a name="l02846"></a><span class="lineno"> 2846</span>&#160;</div><div class="line"><a name="l02847"></a><span class="lineno"> 2847</span>&#160;                <span class="comment">// Calculate acceleration at new position</span></div><div class="line"><a name="l02848"></a><span class="lineno"> 2848</span>&#160;                <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc);</div><div class="line"><a name="l02849"></a><span class="lineno"> 2849</span>&#160;                <span class="comment">//              hardware_init_eci(cinfo,gjh.step[gjh.order2+i*n].sloc);</span></div><div class="line"><a name="l02850"></a><span class="lineno"> 2850</span>&#160;</div><div class="line"><a name="l02851"></a><span class="lineno"> 2851</span>&#160;                <span class="comment">// Compare acceleration at new position to previous iteration</span></div><div class="line"><a name="l02852"></a><span class="lineno"> 2852</span>&#160;                <span class="keywordflow">if</span> (fabs(oldsa.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]-gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.a.col[0])&gt;1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-14 || fabs(oldsa.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]-gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.a.col[1])&gt;1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-14 || fabs(oldsa.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]-gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">order2</a>+i*n].sloc.pos.eci.a.col[2])&gt;1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-14)</div><div class="line"><a name="l02853"></a><span class="lineno"> 2853</span>&#160;                    cflag = 1;</div><div class="line"><a name="l02854"></a><span class="lineno"> 2854</span>&#160;            }</div><div class="line"><a name="l02855"></a><span class="lineno"> 2855</span>&#160;        }</div><div class="line"><a name="l02856"></a><span class="lineno"> 2856</span>&#160;        c_cnt++;</div><div class="line"><a name="l02857"></a><span class="lineno"> 2857</span>&#160;    } <span class="keywordflow">while</span> (c_cnt&lt;10 &amp;&amp; cflag);</div><div class="line"><a name="l02858"></a><span class="lineno"> 2858</span>&#160;</div><div class="line"><a name="l02859"></a><span class="lineno"> 2859</span>&#160;    <span class="keywordflow">return</span> gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc;</div><div class="line"><a name="l02860"></a><span class="lineno"> 2860</span>&#160;}</div><div class="ttc" id="eci2kep__test_8cpp_html_aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f"><div class="ttname"><a href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a></div><div class="ttdef"><b>Definition:</b> eci2kep_test.cpp:33</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structgj__handle_html_a2f488fdbc7994a7fc495a4b751cba1ff"><div class="ttname"><a href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">gj_handle::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> physicsdef.h:107</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structgj__handle_html_acbc5bd29496ca4d3b055cac4de98f8ae"><div class="ttname"><a href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">gj_handle::order</a></div><div class="ttdeci">uint32_t order</div><div class="ttdef"><b>Definition:</b> physicsdef.h:109</div></div>
<div class="ttc" id="structgj__handle_html_a62b8504d75c54a2c7b29bfb5d8c5d17e"><div class="ttname"><a href="structgj__handle.html#a62b8504d75c54a2c7b29bfb5d8c5d17e">gj_handle::order2</a></div><div class="ttdeci">uint32_t order2</div><div class="ttdef"><b>Definition:</b> physicsdef.h:110</div></div>
<div class="ttc" id="structgj__handle_html_a7fd87f83546183ecfa0c85018a259aa1"><div class="ttname"><a href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">gj_handle::dtsq</a></div><div class="ttdeci">double dtsq</div><div class="ttdef"><b>Definition:</b> physicsdef.h:108</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="structgj__handle_html_ae9962ed18b4c84e077e08e1fdf081795"><div class="ttname"><a href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">gj_handle::step</a></div><div class="ttdeci">vector&lt; gjstruc &gt; step</div><div class="ttdef"><b>Definition:</b> physicsdef.h:111</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga798e201a0205dabc1a938fb8ff09c496"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void gauss_jackson_converge_hardware </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02863"></a><span class="lineno"> 2863</span>&#160;{</div><div class="line"><a name="l02864"></a><span class="lineno"> 2864</span>&#160;    <span class="keywordflow">for</span> (uint16_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>=0; <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; ++<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>)</div><div class="line"><a name="l02865"></a><span class="lineno"> 2865</span>&#160;    {</div><div class="line"><a name="l02866"></a><span class="lineno"> 2866</span>&#160;        <span class="comment">//      simulate_hardware(cinfo, gjh.step[i].sloc);</span></div><div class="line"><a name="l02867"></a><span class="lineno"> 2867</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[<a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>].sloc);</div><div class="line"><a name="l02868"></a><span class="lineno"> 2868</span>&#160;    }</div><div class="line"><a name="l02869"></a><span class="lineno"> 2869</span>&#160;}</div><div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="structgj__handle_html_acbc5bd29496ca4d3b055cac4de98f8ae"><div class="ttname"><a href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">gj_handle::order</a></div><div class="ttdeci">uint32_t order</div><div class="ttdef"><b>Definition:</b> physicsdef.h:109</div></div>
<div class="ttc" id="structgj__handle_html_ae9962ed18b4c84e077e08e1fdf081795"><div class="ttname"><a href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">gj_handle::step</a></div><div class="ttdeci">vector&lt; gjstruc &gt; step</div><div class="ttdef"><b>Definition:</b> physicsdef.h:111</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga73a5d12a8fff794baaca9ee7e507719e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">vector&lt;<a class="el" href="structlocstruc.html">locstruc</a>&gt; gauss_jackson_propagate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structgj__handle.html">gj_handle</a> &amp;&#160;</td>
          <td class="paramname"><em>gjh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structphysicsstruc.html">physicsstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>physics</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structlocstruc.html">locstruc</a> &amp;&#160;</td>
          <td class="paramname"><em>loc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<div class="fragment"><div class="line"><a name="l02872"></a><span class="lineno"> 2872</span>&#160;{</div><div class="line"><a name="l02873"></a><span class="lineno"> 2873</span>&#160;    uint32_t <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>,chunks , astep;</div><div class="line"><a name="l02874"></a><span class="lineno"> 2874</span>&#160;    uint32_t j, k;</div><div class="line"><a name="l02875"></a><span class="lineno"> 2875</span>&#160;    <span class="comment">//  static quaternion qs[2]={{{0.,0.,0.},0.}};</span></div><div class="line"><a name="l02876"></a><span class="lineno"> 2876</span>&#160;    <span class="comment">//  static rvector alpha[2] = {{{0.,0.,0.}}};</span></div><div class="line"><a name="l02877"></a><span class="lineno"> 2877</span>&#160;    <span class="comment">//  static rvector omega[2] = {{{0.,0.,0.}}};</span></div><div class="line"><a name="l02878"></a><span class="lineno"> 2878</span>&#160;    <a class="code" href="structquaternion.html">quaternion</a> q1, dsq, q2;</div><div class="line"><a name="l02879"></a><span class="lineno"> 2879</span>&#160;    <a class="code" href="structdem__pixel.html">dem_pixel</a> val;</div><div class="line"><a name="l02880"></a><span class="lineno"> 2880</span>&#160;    <a class="code" href="structrvector.html">rvector</a> normal, unitv, unitx, unitp, unitp1, unitp2;</div><div class="line"><a name="l02881"></a><span class="lineno"> 2881</span>&#160;    <span class="keyword">static</span> <a class="code" href="structrvector.html">rvector</a> lunitp1 = {{.1,.1,0.}};</div><div class="line"><a name="l02882"></a><span class="lineno"> 2882</span>&#160;    <span class="keywordtype">double</span> angle;</div><div class="line"><a name="l02883"></a><span class="lineno"> 2883</span>&#160;    <a class="code" href="unionuvector.html">uvector</a> utemp;</div><div class="line"><a name="l02884"></a><span class="lineno"> 2884</span>&#160;    <span class="keywordtype">double</span> dtsave;</div><div class="line"><a name="l02885"></a><span class="lineno"> 2885</span>&#160;    <span class="keywordtype">double</span> dtuse;</div><div class="line"><a name="l02886"></a><span class="lineno"> 2886</span>&#160;    <a class="code" href="structrmatrix.html">rmatrix</a> tskew;</div><div class="line"><a name="l02887"></a><span class="lineno"> 2887</span>&#160;    <a class="code" href="unionuvector.html">uvector</a> tvector1;</div><div class="line"><a name="l02888"></a><span class="lineno"> 2888</span>&#160;    <a class="code" href="structmatrix2d.html">matrix2d</a> tmatrix2;</div><div class="line"><a name="l02889"></a><span class="lineno"> 2889</span>&#160;    <a class="code" href="structrvector.html">rvector</a> tvector;</div><div class="line"><a name="l02890"></a><span class="lineno"> 2890</span>&#160;    vector &lt;locstruc&gt; locvec;</div><div class="line"><a name="l02891"></a><span class="lineno"> 2891</span>&#160;</div><div class="line"><a name="l02892"></a><span class="lineno"> 2892</span>&#160;    <span class="comment">// Initial location</span></div><div class="line"><a name="l02893"></a><span class="lineno"> 2893</span>&#160;    locvec.push_back(loc);</div><div class="line"><a name="l02894"></a><span class="lineno"> 2894</span>&#160;</div><div class="line"><a name="l02895"></a><span class="lineno"> 2895</span>&#160;    <span class="comment">// Don&#39;t bother if too low</span></div><div class="line"><a name="l02896"></a><span class="lineno"> 2896</span>&#160;    <span class="keywordflow">if</span> (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.geod.s.h &lt; 100.)</div><div class="line"><a name="l02897"></a><span class="lineno"> 2897</span>&#160;    {</div><div class="line"><a name="l02898"></a><span class="lineno"> 2898</span>&#160;        <span class="keywordflow">return</span> locvec;</div><div class="line"><a name="l02899"></a><span class="lineno"> 2899</span>&#160;    }</div><div class="line"><a name="l02900"></a><span class="lineno"> 2900</span>&#160;    <span class="comment">//  if (qs[0].w == 0.)</span></div><div class="line"><a name="l02901"></a><span class="lineno"> 2901</span>&#160;    <span class="comment">//  {</span></div><div class="line"><a name="l02902"></a><span class="lineno"> 2902</span>&#160;    <span class="comment">//      qs[0] = qs[1] = loc.att.icrf.s;</span></div><div class="line"><a name="l02903"></a><span class="lineno"> 2903</span>&#160;    <span class="comment">//      alpha[0] = alpha[1] = loc.att.icrf.a;</span></div><div class="line"><a name="l02904"></a><span class="lineno"> 2904</span>&#160;    <span class="comment">//      omega[0] = omega[1] = loc.att.icrf.v;</span></div><div class="line"><a name="l02905"></a><span class="lineno"> 2905</span>&#160;    <span class="comment">//  }</span></div><div class="line"><a name="l02906"></a><span class="lineno"> 2906</span>&#160;    <span class="comment">// Return immediately if we are trying to propagate earlier but dt is positive or vice versa</span></div><div class="line"><a name="l02907"></a><span class="lineno"> 2907</span>&#160;    <span class="keywordflow">if</span> ((tomjd &lt; gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.utc &amp;&amp; physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> &gt; 0.) || (tomjd &gt; gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.utc &amp;&amp; physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> &lt; 0.))</div><div class="line"><a name="l02908"></a><span class="lineno"> 2908</span>&#160;    {</div><div class="line"><a name="l02909"></a><span class="lineno"> 2909</span>&#160;        <span class="keywordflow">return</span> locvec;</div><div class="line"><a name="l02910"></a><span class="lineno"> 2910</span>&#160;    }</div><div class="line"><a name="l02911"></a><span class="lineno"> 2911</span>&#160;    chunks = (uint32_t)(.5 + 86400.*(tomjd - gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.utc)/physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>);</div><div class="line"><a name="l02912"></a><span class="lineno"> 2912</span>&#160;    <span class="keywordflow">if</span> (chunks &gt; 100000)</div><div class="line"><a name="l02913"></a><span class="lineno"> 2913</span>&#160;    {</div><div class="line"><a name="l02914"></a><span class="lineno"> 2914</span>&#160;        chunks = 100000;</div><div class="line"><a name="l02915"></a><span class="lineno"> 2915</span>&#160;<span class="comment">//        dtuse = 86400.*(tomjd - gjh.step[gjh.order].sloc.utc) / 100000;</span></div><div class="line"><a name="l02916"></a><span class="lineno"> 2916</span>&#160;    }</div><div class="line"><a name="l02917"></a><span class="lineno"> 2917</span>&#160;<span class="comment">//    else</span></div><div class="line"><a name="l02918"></a><span class="lineno"> 2918</span>&#160;<span class="comment">//    {</span></div><div class="line"><a name="l02919"></a><span class="lineno"> 2919</span>&#160;        dtuse = physics.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>;</div><div class="line"><a name="l02920"></a><span class="lineno"> 2920</span>&#160;<span class="comment">//    }</span></div><div class="line"><a name="l02921"></a><span class="lineno"> 2921</span>&#160;</div><div class="line"><a name="l02922"></a><span class="lineno"> 2922</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;chunks; i++)</div><div class="line"><a name="l02923"></a><span class="lineno"> 2923</span>&#160;    {</div><div class="line"><a name="l02924"></a><span class="lineno"> 2924</span>&#160;        <span class="keywordflow">if</span> (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.geod.s.h &lt; 100.)</div><div class="line"><a name="l02925"></a><span class="lineno"> 2925</span>&#160;        {</div><div class="line"><a name="l02926"></a><span class="lineno"> 2926</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l02927"></a><span class="lineno"> 2927</span>&#160;        }</div><div class="line"><a name="l02928"></a><span class="lineno"> 2928</span>&#160;</div><div class="line"><a name="l02929"></a><span class="lineno"> 2929</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.utc + (dtuse)/86400.;</div><div class="line"><a name="l02930"></a><span class="lineno"> 2930</span>&#160;</div><div class="line"><a name="l02931"></a><span class="lineno"> 2931</span>&#160;        <span class="comment">// Calculate S(order/2+1)</span></div><div class="line"><a name="l02932"></a><span class="lineno"> 2932</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].ss.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].ss.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[0]/2.;</div><div class="line"><a name="l02933"></a><span class="lineno"> 2933</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].ss.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].ss.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[1]/2.;</div><div class="line"><a name="l02934"></a><span class="lineno"> 2934</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].ss.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].ss.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[2]/2.;</div><div class="line"><a name="l02935"></a><span class="lineno"> 2935</span>&#160;</div><div class="line"><a name="l02936"></a><span class="lineno"> 2936</span>&#160;        <span class="comment">// Calculate Sum(order/2+1) for a and b</span></div><div class="line"><a name="l02937"></a><span class="lineno"> 2937</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l02938"></a><span class="lineno"> 2938</span>&#160;        <span class="keywordflow">for</span> (k=0; k&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; k++)</div><div class="line"><a name="l02939"></a><span class="lineno"> 2939</span>&#160;        {</div><div class="line"><a name="l02940"></a><span class="lineno"> 2940</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb.col[0] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02941"></a><span class="lineno"> 2941</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa.col[0] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[0];</div><div class="line"><a name="l02942"></a><span class="lineno"> 2942</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb.col[1] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02943"></a><span class="lineno"> 2943</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa.col[1] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[1];</div><div class="line"><a name="l02944"></a><span class="lineno"> 2944</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb.col[2] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].b[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02945"></a><span class="lineno"> 2945</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa.col[2] += gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].a[k] * gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[k].sloc.pos.eci.a.col[2];</div><div class="line"><a name="l02946"></a><span class="lineno"> 2946</span>&#160;        }</div><div class="line"><a name="l02947"></a><span class="lineno"> 2947</span>&#160;</div><div class="line"><a name="l02948"></a><span class="lineno"> 2948</span>&#160;        <span class="comment">// Calculate pos.v(order/2+1)</span></div><div class="line"><a name="l02949"></a><span class="lineno"> 2949</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.v.col[0] = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[0]/2. + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb.col[0]);</div><div class="line"><a name="l02950"></a><span class="lineno"> 2950</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.v.col[1] = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[1]/2. + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb.col[1]);</div><div class="line"><a name="l02951"></a><span class="lineno"> 2951</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.v.col[2] = gjh.<a class="code" href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">dt</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[2]/2. + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sb.col[2]);</div><div class="line"><a name="l02952"></a><span class="lineno"> 2952</span>&#160;</div><div class="line"><a name="l02953"></a><span class="lineno"> 2953</span>&#160;        <span class="comment">// Calculate pos.s(order/2+1)</span></div><div class="line"><a name="l02954"></a><span class="lineno"> 2954</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.s.col[0] = gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].ss.col[0] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa.col[0]);</div><div class="line"><a name="l02955"></a><span class="lineno"> 2955</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.s.col[1] = gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].ss.col[1] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa.col[1]);</div><div class="line"><a name="l02956"></a><span class="lineno"> 2956</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.s.col[2] = gjh.<a class="code" href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">dtsq</a> * (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].ss.col[2] + gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sa.col[2]);</div><div class="line"><a name="l02957"></a><span class="lineno"> 2957</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.pass++;</div><div class="line"><a name="l02958"></a><span class="lineno"> 2958</span>&#160;        <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l02959"></a><span class="lineno"> 2959</span>&#160;</div><div class="line"><a name="l02960"></a><span class="lineno"> 2960</span>&#160;        <span class="comment">// Calculate att.s(order/2+1) + hardware</span></div><div class="line"><a name="l02961"></a><span class="lineno"> 2961</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.att.icrf;</div><div class="line"><a name="l02962"></a><span class="lineno"> 2962</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.utc;</div><div class="line"><a name="l02963"></a><span class="lineno"> 2963</span>&#160;        <span class="keywordflow">switch</span> (physics.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a>)</div><div class="line"><a name="l02964"></a><span class="lineno"> 2964</span>&#160;        {</div><div class="line"><a name="l02965"></a><span class="lineno"> 2965</span>&#160;        <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l02966"></a><span class="lineno"> 2966</span>&#160;            <span class="comment">// Calculate att.v(order/2+1)</span></div><div class="line"><a name="l02967"></a><span class="lineno"> 2967</span>&#160;            astep = 1 + (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.v) * dtuse) / .01;</div><div class="line"><a name="l02968"></a><span class="lineno"> 2968</span>&#160;            <span class="keywordflow">if</span> (astep &gt; 1000)</div><div class="line"><a name="l02969"></a><span class="lineno"> 2969</span>&#160;            {</div><div class="line"><a name="l02970"></a><span class="lineno"> 2970</span>&#160;                astep = 1000;</div><div class="line"><a name="l02971"></a><span class="lineno"> 2971</span>&#160;            }</div><div class="line"><a name="l02972"></a><span class="lineno"> 2972</span>&#160;            dtsave = dtuse;</div><div class="line"><a name="l02973"></a><span class="lineno"> 2973</span>&#160;            dtuse /= astep;</div><div class="line"><a name="l02974"></a><span class="lineno"> 2974</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.utc;</div><div class="line"><a name="l02975"></a><span class="lineno"> 2975</span>&#160;            <span class="comment">//              simulate_hardware(cinfo, gjh.step[gjh.order+1].sloc);</span></div><div class="line"><a name="l02976"></a><span class="lineno"> 2976</span>&#160;            <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l02977"></a><span class="lineno"> 2977</span>&#160;            <span class="keywordflow">for</span> (k=0; k&lt;astep; k++)</div><div class="line"><a name="l02978"></a><span class="lineno"> 2978</span>&#160;            {</div><div class="line"><a name="l02979"></a><span class="lineno"> 2979</span>&#160;                tvector = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(dtuse,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.v));</div><div class="line"><a name="l02980"></a><span class="lineno"> 2980</span>&#160;                tskew = <a class="code" href="group__mathlib__functions.html#ga5a57f375657d1f5532f0289719805206">rm_skew</a>(tvector);</div><div class="line"><a name="l02981"></a><span class="lineno"> 2981</span>&#160;                tmatrix2.<a class="code" href="structmatrix2d.html#a76037cca0e427c74ab59ea871c034acd">rows</a> = tmatrix2.<a class="code" href="structmatrix2d.html#a0b93d7a1de4f1e801d8c834cd0d744fc">cols</a> = 4;</div><div class="line"><a name="l02982"></a><span class="lineno"> 2982</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> l=0; l&lt;3; ++l)</div><div class="line"><a name="l02983"></a><span class="lineno"> 2983</span>&#160;                {</div><div class="line"><a name="l02984"></a><span class="lineno"> 2984</span>&#160;                    tmatrix2.<a class="code" href="structmatrix2d.html#a1e46c323ac5c556d1564e6552fc95eb6">array</a>[3][l] = -tvector.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[l];</div><div class="line"><a name="l02985"></a><span class="lineno"> 2985</span>&#160;                    tmatrix2.<a class="code" href="structmatrix2d.html#a1e46c323ac5c556d1564e6552fc95eb6">array</a>[l][3] = tvector.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[l];</div><div class="line"><a name="l02986"></a><span class="lineno"> 2986</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> m=0; m&lt;3; m++)</div><div class="line"><a name="l02987"></a><span class="lineno"> 2987</span>&#160;                    {</div><div class="line"><a name="l02988"></a><span class="lineno"> 2988</span>&#160;                        tmatrix2.<a class="code" href="structmatrix2d.html#a1e46c323ac5c556d1564e6552fc95eb6">array</a>[l][m] = -tskew.<a class="code" href="structrmatrix.html#aa665325d4b450cb862942302ec648f3d">row</a>[l].<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[m];</div><div class="line"><a name="l02989"></a><span class="lineno"> 2989</span>&#160;                    }</div><div class="line"><a name="l02990"></a><span class="lineno"> 2990</span>&#160;                }</div><div class="line"><a name="l02991"></a><span class="lineno"> 2991</span>&#160;                tmatrix2.<a class="code" href="structmatrix2d.html#a1e46c323ac5c556d1564e6552fc95eb6">array</a>[3][3] = 0.;</div><div class="line"><a name="l02992"></a><span class="lineno"> 2992</span>&#160;                tvector1.<a class="code" href="unionuvector.html#a0e880bc6da791c1679798534dd4808eb">m1</a>.<a class="code" href="structmatrix1d.html#aa012fc3b0f1c1a4a96054218ab13e353">cols</a> = 4;</div><div class="line"><a name="l02993"></a><span class="lineno"> 2993</span>&#160;                tvector1.<a class="code" href="unionuvector.html#ad159f6a7f62bc17852fb25e1074ab732">q</a> = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s;</div><div class="line"><a name="l02994"></a><span class="lineno"> 2994</span>&#160;                tvector1.<a class="code" href="unionuvector.html#a0e880bc6da791c1679798534dd4808eb">m1</a> = <a class="code" href="group__mathlib__functions.html#ga6c172896ca2b6ac998542b43084a3fbb">m1_smult</a>(.5,<a class="code" href="group__mathlib__functions.html#gad995945480af2a582bf127561531a43b">m1_mmult</a>(tmatrix2,tvector1.<a class="code" href="unionuvector.html#a0e880bc6da791c1679798534dd4808eb">m1</a>));</div><div class="line"><a name="l02995"></a><span class="lineno"> 2995</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s = <a class="code" href="vector_8cpp.html#a5c389f779b8f5b2273b4ae64557a8ea5">q_add</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s,tvector1.<a class="code" href="unionuvector.html#ad159f6a7f62bc17852fb25e1074ab732">q</a>);</div><div class="line"><a name="l02996"></a><span class="lineno"> 2996</span>&#160;</div><div class="line"><a name="l02997"></a><span class="lineno"> 2997</span>&#160;                <span class="comment">//                  q1 = q_axis2quaternion_rv(rv_smult(dtuse,gjh.step[gjh.order+1].sloc.att.icrf.v));</span></div><div class="line"><a name="l02998"></a><span class="lineno"> 2998</span>&#160;                <span class="comment">//                  gjh.step[gjh.order+1].sloc.att.icrf.s = q_fmult(q1,gjh.step[gjh.order+1].sloc.att.icrf.s);</span></div><div class="line"><a name="l02999"></a><span class="lineno"> 2999</span>&#160;                <a class="code" href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s);</div><div class="line"><a name="l03000"></a><span class="lineno"> 3000</span>&#160;</div><div class="line"><a name="l03001"></a><span class="lineno"> 3001</span>&#160;                <span class="comment">// Calculate new v from da</span></div><div class="line"><a name="l03002"></a><span class="lineno"> 3002</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.v = <a class="code" href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.v,<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(dtuse,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.a));</div><div class="line"><a name="l03003"></a><span class="lineno"> 3003</span>&#160;                gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc += (dtuse)/86400.;</div><div class="line"><a name="l03004"></a><span class="lineno"> 3004</span>&#160;                ++gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.pass;</div><div class="line"><a name="l03005"></a><span class="lineno"> 3005</span>&#160;                <a class="code" href="group__convertlib__functions.html#ga47c2eee20fb1d9d75dbec8e84fc0c133">att_icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03006"></a><span class="lineno"> 3006</span>&#160;            }</div><div class="line"><a name="l03007"></a><span class="lineno"> 3007</span>&#160;            dtuse = dtsave;</div><div class="line"><a name="l03008"></a><span class="lineno"> 3008</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03009"></a><span class="lineno"> 3009</span>&#160;        <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l03010"></a><span class="lineno"> 3010</span>&#160;            <span class="comment">// Force LVLH</span></div><div class="line"><a name="l03011"></a><span class="lineno"> 3011</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.lvlh.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc;</div><div class="line"><a name="l03012"></a><span class="lineno"> 3012</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.lvlh.s = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l03013"></a><span class="lineno"> 3013</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.lvlh.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03014"></a><span class="lineno"> 3014</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03015"></a><span class="lineno"> 3015</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03016"></a><span class="lineno"> 3016</span>&#160;        <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l03017"></a><span class="lineno"> 3017</span>&#160;            <span class="comment">// Force surface normal (rover)</span></div><div class="line"><a name="l03018"></a><span class="lineno"> 3018</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.topo.v = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.topo.a = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03019"></a><span class="lineno"> 3019</span>&#160;            <span class="keywordflow">switch</span> (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.extra.closest)</div><div class="line"><a name="l03020"></a><span class="lineno"> 3020</span>&#160;            {</div><div class="line"><a name="l03021"></a><span class="lineno"> 3021</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>:</div><div class="line"><a name="l03022"></a><span class="lineno"> 3022</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l03023"></a><span class="lineno"> 3023</span>&#160;                val = <a class="code" href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a>(<a class="code" href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.geod.s.lon,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.geod.s.lat,1./<a class="code" href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a>);</div><div class="line"><a name="l03024"></a><span class="lineno"> 3024</span>&#160;                <span class="keywordflow">for</span> (j=0; j&lt;3; j++)</div><div class="line"><a name="l03025"></a><span class="lineno"> 3025</span>&#160;                {</div><div class="line"><a name="l03026"></a><span class="lineno"> 3026</span>&#160;                    normal.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[j] = val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[j];</div><div class="line"><a name="l03027"></a><span class="lineno"> 3027</span>&#160;                }</div><div class="line"><a name="l03028"></a><span class="lineno"> 3028</span>&#160;                unitv = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03029"></a><span class="lineno"> 3029</span>&#160;                unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.geod.v.lon / cos(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.geod.s.lat);</div><div class="line"><a name="l03030"></a><span class="lineno"> 3030</span>&#160;                unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.geod.v.lat;</div><div class="line"><a name="l03031"></a><span class="lineno"> 3031</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03032"></a><span class="lineno"> 3032</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>:</div><div class="line"><a name="l03033"></a><span class="lineno"> 3033</span>&#160;                val = <a class="code" href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a>(<a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.s.lon,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.s.lat,1./<a class="code" href="group__convertlib__constants.html#gab390472803f74cb9dfbf3f47cf6b82cd">RMOONM</a>);</div><div class="line"><a name="l03034"></a><span class="lineno"> 3034</span>&#160;                <span class="keywordflow">for</span> (j=0; j&lt;3; j++)</div><div class="line"><a name="l03035"></a><span class="lineno"> 3035</span>&#160;                {</div><div class="line"><a name="l03036"></a><span class="lineno"> 3036</span>&#160;                    normal.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[j] = -val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[j];</div><div class="line"><a name="l03037"></a><span class="lineno"> 3037</span>&#160;                }</div><div class="line"><a name="l03038"></a><span class="lineno"> 3038</span>&#160;                unitv = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03039"></a><span class="lineno"> 3039</span>&#160;                unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.v.lon / cos(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.s.lat);</div><div class="line"><a name="l03040"></a><span class="lineno"> 3040</span>&#160;                unitv.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.v.lat;</div><div class="line"><a name="l03041"></a><span class="lineno"> 3041</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l03042"></a><span class="lineno"> 3042</span>&#160;            }</div><div class="line"><a name="l03043"></a><span class="lineno"> 3043</span>&#160;            q1 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>(),normal);</div><div class="line"><a name="l03044"></a><span class="lineno"> 3044</span>&#160;            unitx = <a class="code" href="group__mathlib__functions.html#ga87872977600612c97f2ccd895a18c1a4">rv_cross</a>(normal,<a class="code" href="group__mathlib__functions.html#ga0ab927d0ce1a6822fd4be8392515c41d">rv_unity</a>());</div><div class="line"><a name="l03045"></a><span class="lineno"> 3045</span>&#160;            unitx = <a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(q1,unitx);</div><div class="line"><a name="l03046"></a><span class="lineno"> 3046</span>&#160;            q2 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(unitx,unitv);</div><div class="line"><a name="l03047"></a><span class="lineno"> 3047</span>&#160;            <span class="comment">//      gjh.step[gjh.order+1].sloc.att.topo.s = q_fmult(q2,q1);</span></div><div class="line"><a name="l03048"></a><span class="lineno"> 3048</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.topo.s = q1;</div><div class="line"><a name="l03049"></a><span class="lineno"> 3049</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.topo.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.utc+1.e8;</div><div class="line"><a name="l03050"></a><span class="lineno"> 3050</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.topo.pass++;</div><div class="line"><a name="l03051"></a><span class="lineno"> 3051</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga4d53b830876193698ea7ac99cd3ba8a4">att_topo</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03052"></a><span class="lineno"> 3052</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03053"></a><span class="lineno"> 3053</span>&#160;        <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l03054"></a><span class="lineno"> 3054</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc;</div><div class="line"><a name="l03055"></a><span class="lineno"> 3055</span>&#160;            q1 = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s;</div><div class="line"><a name="l03056"></a><span class="lineno"> 3056</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(physics.<a class="code" href="structphysicsstruc.html#aa41fdb408a64cc53683853bfa8629d32">thrust</a>.<a class="code" href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">to_rv</a>(),<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>());</div><div class="line"><a name="l03057"></a><span class="lineno"> 3057</span>&#160;            dsq = <a class="code" href="vector_8cpp.html#ae8b2683785836c9b3afd6ea770fbe584">q_sub</a>(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s,q1);</div><div class="line"><a name="l03058"></a><span class="lineno"> 3058</span>&#160;            angle = 2. * atan(<a class="code" href="vector_8cpp.html#a4cfee4d6799b84744d6885b0c7c30630">length_q</a>(dsq)/2.);</div><div class="line"><a name="l03059"></a><span class="lineno"> 3059</span>&#160;            q2 = <a class="code" href="vector_8cpp.html#a7b455a47657477c96faae73ef614fb3d">q_smult</a>(1./cos(angle),gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.s);</div><div class="line"><a name="l03060"></a><span class="lineno"> 3060</span>&#160;            dsq = <a class="code" href="vector_8cpp.html#ae8b2683785836c9b3afd6ea770fbe584">q_sub</a>(q2,q1);</div><div class="line"><a name="l03061"></a><span class="lineno"> 3061</span>&#160;            utemp.<a class="code" href="unionuvector.html#ad159f6a7f62bc17852fb25e1074ab732">q</a> = <a class="code" href="vector_8cpp.html#a7b455a47657477c96faae73ef614fb3d">q_smult</a>(2.,<a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(<a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(q1),dsq));</div><div class="line"><a name="l03062"></a><span class="lineno"> 3062</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.v = utemp.<a class="code" href="unionuvector.html#a43a4f1b1ae3408298ec499e7604e2d8a">r</a>;</div><div class="line"><a name="l03063"></a><span class="lineno"> 3063</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03064"></a><span class="lineno"> 3064</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03065"></a><span class="lineno"> 3065</span>&#160;        <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l03066"></a><span class="lineno"> 3066</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.selc.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc;</div><div class="line"><a name="l03067"></a><span class="lineno"> 3067</span>&#160;            unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += .1*(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.v.lon-unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]);</div><div class="line"><a name="l03068"></a><span class="lineno"> 3068</span>&#160;            unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += .1*(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.v.lat-unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]);</div><div class="line"><a name="l03069"></a><span class="lineno"> 3069</span>&#160;            unitp1.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] =  0.;</div><div class="line"><a name="l03070"></a><span class="lineno"> 3070</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a>(unitp1) &lt; 1<a class="code" href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a>-9)</div><div class="line"><a name="l03071"></a><span class="lineno"> 3071</span>&#160;                unitp1 = lunitp1;</div><div class="line"><a name="l03072"></a><span class="lineno"> 3072</span>&#160;            <span class="keywordflow">else</span></div><div class="line"><a name="l03073"></a><span class="lineno"> 3073</span>&#160;                lunitp1 = unitp1;</div><div class="line"><a name="l03074"></a><span class="lineno"> 3074</span>&#160;            q1 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#gacd0bd1cf5e88440f2912f37c9a5e2c4b">rv_unitx</a>(),unitp1);</div><div class="line"><a name="l03075"></a><span class="lineno"> 3075</span>&#160;            val = <a class="code" href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a>(<a class="code" href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a>,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.s.lon,gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.selg.s.lat,.0003);</div><div class="line"><a name="l03076"></a><span class="lineno"> 3076</span>&#160;            unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] += .1*(val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[0]-unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0]);</div><div class="line"><a name="l03077"></a><span class="lineno"> 3077</span>&#160;            unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] += .1*(val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[1]-unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1]);</div><div class="line"><a name="l03078"></a><span class="lineno"> 3078</span>&#160;            unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2] += .1*(val.<a class="code" href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">nmap</a>[2]-unitp2.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[2]);</div><div class="line"><a name="l03079"></a><span class="lineno"> 3079</span>&#160;            q2 = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(<a class="code" href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a>(q1,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>()),unitp2);</div><div class="line"><a name="l03080"></a><span class="lineno"> 3080</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.selc.s = <a class="code" href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a>(<a class="code" href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a>(q2,q1));</div><div class="line"><a name="l03081"></a><span class="lineno"> 3081</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.selc.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03082"></a><span class="lineno"> 3082</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga8044d1e9feba3476837335411c2e0333">att_selc2icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03083"></a><span class="lineno"> 3083</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03084"></a><span class="lineno"> 3084</span>&#160;        <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l03085"></a><span class="lineno"> 3085</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.geoc.utc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc;</div><div class="line"><a name="l03086"></a><span class="lineno"> 3086</span>&#160;            angle = 2.*acos(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.geoc.s.w);</div><div class="line"><a name="l03087"></a><span class="lineno"> 3087</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.geoc.s = <a class="code" href="vector_8cpp.html#aecec827dcad2784658f70113f527fa4a">q_change_around_z</a>(angle+.2*<a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>*dtuse);</div><div class="line"><a name="l03088"></a><span class="lineno"> 3088</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.geoc.v = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(.2*<a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>());</div><div class="line"><a name="l03089"></a><span class="lineno"> 3089</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga34669623045ba324af3e0e465da4673c">att_geoc2icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03090"></a><span class="lineno"> 3090</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga4942297c63cf2b95cde477a04cdde02d">att_planec2lvlh</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03091"></a><span class="lineno"> 3091</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03092"></a><span class="lineno"> 3092</span>&#160;        <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l03093"></a><span class="lineno"> 3093</span>&#160;        <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l03094"></a><span class="lineno"> 3094</span>&#160;        <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l03095"></a><span class="lineno"> 3095</span>&#160;        <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l03096"></a><span class="lineno"> 3096</span>&#160;        <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l03097"></a><span class="lineno"> 3097</span>&#160;        <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l03098"></a><span class="lineno"> 3098</span>&#160;            <span class="comment">//              gjh.step[gjh.order+1].sloc.att.icrf.s = q_drotate_between_rv(cinfo-&gt;pieces[physics.mode-2].normal,rv_smult(-1.,gjh.step[gjh.order+1].sloc.pos.icrf.s));</span></div><div class="line"><a name="l03099"></a><span class="lineno"> 3099</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.icrf.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03100"></a><span class="lineno"> 3100</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03101"></a><span class="lineno"> 3101</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03102"></a><span class="lineno"> 3102</span>&#160;        <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l03103"></a><span class="lineno"> 3103</span>&#160;            angle = (1440.*(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc - <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a>) - (<span class="keywordtype">int</span>)(1440.*(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.utc - <a class="code" href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a>))) * 2.*<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>;</div><div class="line"><a name="l03104"></a><span class="lineno"> 3104</span>&#160;            unitx = unitp =  <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03105"></a><span class="lineno"> 3105</span>&#160;            unitx.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = 1.;</div><div class="line"><a name="l03106"></a><span class="lineno"> 3106</span>&#160;            unitp.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[0] = cos(angle);</div><div class="line"><a name="l03107"></a><span class="lineno"> 3107</span>&#160;            unitp.<a class="code" href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">col</a>[1] = sin(angle);</div><div class="line"><a name="l03108"></a><span class="lineno"> 3108</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.lvlh.s = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(unitp,unitx);</div><div class="line"><a name="l03109"></a><span class="lineno"> 3109</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.lvlh.v = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03110"></a><span class="lineno"> 3110</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.att.lvlh.v.col[2] = 2.*<a class="code" href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a>/1440.;</div><div class="line"><a name="l03111"></a><span class="lineno"> 3111</span>&#160;            <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03112"></a><span class="lineno"> 3112</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03113"></a><span class="lineno"> 3113</span>&#160;        }</div><div class="line"><a name="l03114"></a><span class="lineno"> 3114</span>&#160;        <span class="comment">//      simulate_hardware(cinfo, gjh.step[gjh.order+1].sloc);</span></div><div class="line"><a name="l03115"></a><span class="lineno"> 3115</span>&#160;        <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03116"></a><span class="lineno"> 3116</span>&#160;        <span class="comment">// Perform positional and attitude accelerations at new position</span></div><div class="line"><a name="l03117"></a><span class="lineno"> 3117</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a>(physics, gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc);</div><div class="line"><a name="l03118"></a><span class="lineno"> 3118</span>&#160;</div><div class="line"><a name="l03119"></a><span class="lineno"> 3119</span>&#160;        <span class="comment">// Calculate s(order/2+1)</span></div><div class="line"><a name="l03120"></a><span class="lineno"> 3120</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].s.col[0] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[0] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[0]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.a.col[0])/2.;</div><div class="line"><a name="l03121"></a><span class="lineno"> 3121</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].s.col[1] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[1] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[1]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.a.col[1])/2.;</div><div class="line"><a name="l03122"></a><span class="lineno"> 3122</span>&#160;        gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].s.col[2] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].s.col[2] + (gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc.pos.eci.a.col[2]+gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>+1].sloc.pos.eci.a.col[2])/2.;</div><div class="line"><a name="l03123"></a><span class="lineno"> 3123</span>&#160;</div><div class="line"><a name="l03124"></a><span class="lineno"> 3124</span>&#160;        <span class="comment">// Shift everything over 1</span></div><div class="line"><a name="l03125"></a><span class="lineno"> 3125</span>&#160;        <span class="keywordflow">for</span> (j=0; j&lt;=gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>; j++)</div><div class="line"><a name="l03126"></a><span class="lineno"> 3126</span>&#160;            gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j] = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[j+1];</div><div class="line"><a name="l03127"></a><span class="lineno"> 3127</span>&#160;</div><div class="line"><a name="l03128"></a><span class="lineno"> 3128</span>&#160;        <span class="comment">// Add latest calculation</span></div><div class="line"><a name="l03129"></a><span class="lineno"> 3129</span>&#160;        locvec.push_back(gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc);</div><div class="line"><a name="l03130"></a><span class="lineno"> 3130</span>&#160;</div><div class="line"><a name="l03131"></a><span class="lineno"> 3131</span>&#160;    }</div><div class="line"><a name="l03132"></a><span class="lineno"> 3132</span>&#160;</div><div class="line"><a name="l03133"></a><span class="lineno"> 3133</span>&#160;    loc = gjh.<a class="code" href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">step</a>[gjh.<a class="code" href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">order</a>].sloc;</div><div class="line"><a name="l03134"></a><span class="lineno"> 3134</span>&#160;    <span class="keywordflow">return</span> locvec;</div><div class="line"><a name="l03135"></a><span class="lineno"> 3135</span>&#160;}</div><div class="ttc" id="group__mathlib__functions_html_ga6c172896ca2b6ac998542b43084a3fbb"><div class="ttname"><a href="group__mathlib__functions.html#ga6c172896ca2b6ac998542b43084a3fbb">m1_smult</a></div><div class="ttdeci">matrix1d m1_smult(double number, matrix1d row)</div><div class="ttdoc">Multiply 1D matrix by a scalar. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:979</div></div>
<div class="ttc" id="unionuvector_html"><div class="ttname"><a href="unionuvector.html">uvector</a></div><div class="ttdoc">Quaternion/Rvector Union. </div><div class="ttdef"><b>Definition:</b> mathlib.h:155</div></div>
<div class="ttc" id="structdem__pixel_html_aeb37f380181cd6ad125584e5fab174a8"><div class="ttname"><a href="structdem__pixel.html#aeb37f380181cd6ad125584e5fab174a8">dem_pixel::nmap</a></div><div class="ttdeci">float nmap[3]</div><div class="ttdef"><b>Definition:</b> demlib.h:85</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga5a57f375657d1f5532f0289719805206"><div class="ttname"><a href="group__mathlib__functions.html#ga5a57f375657d1f5532f0289719805206">rm_skew</a></div><div class="ttdeci">rmatrix rm_skew(rvector row)</div><div class="ttdoc">Create skew symmetric rmatrix from rvector. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:857</div></div>
<div class="ttc" id="structmatrix1d_html_aa012fc3b0f1c1a4a96054218ab13e353"><div class="ttname"><a href="structmatrix1d.html#aa012fc3b0f1c1a4a96054218ab13e353">matrix1d::cols</a></div><div class="ttdeci">uint16_t cols</div><div class="ttdoc">Number of elements. </div><div class="ttdef"><b>Definition:</b> matrix.h:77</div></div>
<div class="ttc" id="eci2kep__test_8cpp_html_aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f"><div class="ttname"><a href="eci2kep__test_8cpp.html#aa94081298ab2dfd0f261cce6c203d9aaa5be8d0f77f0d0b6c3724e5c446737d1f">e</a></div><div class="ttdef"><b>Definition:</b> eci2kep_test.cpp:33</div></div>
<div class="ttc" id="vector_8cpp_html_ae8b2683785836c9b3afd6ea770fbe584"><div class="ttname"><a href="vector_8cpp.html#ae8b2683785836c9b3afd6ea770fbe584">q_sub</a></div><div class="ttdeci">quaternion q_sub(quaternion a, quaternion b)</div><div class="ttdoc">Subtract two quaternions. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1186</div></div>
<div class="ttc" id="group__mathlib__functions_html_gad3d78ceb8af40ce126896a854dc2bb22"><div class="ttname"><a href="group__mathlib__functions.html#gad3d78ceb8af40ce126896a854dc2bb22">rv_add</a></div><div class="ttdeci">rvector rv_add(rvector a, rvector b)</div><div class="ttdoc">Add two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:299</div></div>
<div class="ttc" id="unionuvector_html_a43a4f1b1ae3408298ec499e7604e2d8a"><div class="ttname"><a href="unionuvector.html#a43a4f1b1ae3408298ec499e7604e2d8a">uvector::r</a></div><div class="ttdeci">rvector r</div><div class="ttdef"><b>Definition:</b> mathlib.h:161</div></div>
<div class="ttc" id="structrvector_html"><div class="ttname"><a href="structrvector.html">rvector</a></div><div class="ttdoc">3 element generic row vector </div><div class="ttdef"><b>Definition:</b> vector.h:53</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structphysicsstruc_html_aa41fdb408a64cc53683853bfa8629d32"><div class="ttname"><a href="structphysicsstruc.html#aa41fdb408a64cc53683853bfa8629d32">physicsstruc::thrust</a></div><div class="ttdeci">Vector thrust</div><div class="ttdef"><b>Definition:</b> physicsdef.h:163</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4942297c63cf2b95cde477a04cdde02d"><div class="ttname"><a href="group__convertlib__functions.html#ga4942297c63cf2b95cde477a04cdde02d">att_planec2lvlh</a></div><div class="ttdeci">void att_planec2lvlh(locstruc *loc)</div><div class="ttdoc">Convert ITRS attitude to LVLH attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1823</div></div>
<div class="ttc" id="group__mathlib__functions_html_gac6a350c8823f5ad93e80299ab777f602"><div class="ttname"><a href="group__mathlib__functions.html#gac6a350c8823f5ad93e80299ab777f602">length_rv</a></div><div class="ttdeci">double length_rv(rvector v)</div><div class="ttdoc">Length of row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:748</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8044d1e9feba3476837335411c2e0333"><div class="ttname"><a href="group__convertlib__functions.html#ga8044d1e9feba3476837335411c2e0333">att_selc2icrf</a></div><div class="ttdeci">void att_selc2icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1732</div></div>
<div class="ttc" id="structgj__handle_html_a2f488fdbc7994a7fc495a4b751cba1ff"><div class="ttname"><a href="structgj__handle.html#a2f488fdbc7994a7fc495a4b751cba1ff">gj_handle::dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition:</b> physicsdef.h:107</div></div>
<div class="ttc" id="structquaternion_html"><div class="ttname"><a href="structquaternion.html">quaternion</a></div><div class="ttdoc">Quaternion, scalar last, using x, y, z. </div><div class="ttdef"><b>Definition:</b> vector.h:213</div></div>
<div class="ttc" id="vector_8cpp_html_af0190e18ded30d427cd96871428cceb1"><div class="ttname"><a href="vector_8cpp.html#af0190e18ded30d427cd96871428cceb1">q_conjugate</a></div><div class="ttdeci">quaternion q_conjugate(quaternion q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:1010</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="unionuvector_html_a0e880bc6da791c1679798534dd4808eb"><div class="ttname"><a href="unionuvector.html#a0e880bc6da791c1679798534dd4808eb">uvector::m1</a></div><div class="ttdeci">matrix1d m1</div><div class="ttdef"><b>Definition:</b> mathlib.h:165</div></div>
<div class="ttc" id="class_cosmos_1_1_math_1_1_vectors_1_1_vector_html_a74bd3149cec03a4abcbbca0103e6e634"><div class="ttname"><a href="class_cosmos_1_1_math_1_1_vectors_1_1_vector.html#a74bd3149cec03a4abcbbca0103e6e634">Cosmos::Math::Vectors::Vector::to_rv</a></div><div class="ttdeci">rvector to_rv()</div><div class="ttdoc">Convert from cvector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1638</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="unionuvector_html_ad159f6a7f62bc17852fb25e1074ab732"><div class="ttname"><a href="unionuvector.html#ad159f6a7f62bc17852fb25e1074ab732">uvector::q</a></div><div class="ttdeci">quaternion q</div><div class="ttdef"><b>Definition:</b> mathlib.h:157</div></div>
<div class="ttc" id="group__mathlib__functions_html_gad995945480af2a582bf127561531a43b"><div class="ttname"><a href="group__mathlib__functions.html#gad995945480af2a582bf127561531a43b">m1_mmult</a></div><div class="ttdeci">matrix1d m1_mmult(matrix2d Matrix, matrix1d Vector)</div><div class="ttdoc">Multiply matrix1d by matrix2d. </div><div class="ttdef"><b>Definition:</b> matrix.cpp:1041</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="vector_8cpp_html_a8e5dcd01c7a75147e34e90580e3e11f9"><div class="ttname"><a href="vector_8cpp.html#a8e5dcd01c7a75147e34e90580e3e11f9">q_fmult</a></div><div class="ttdeci">quaternion q_fmult(rvector r1, quaternion q2)</div><div class="ttdoc">rvector quaternion multiply </div><div class="ttdef"><b>Definition:</b> vector.cpp:1079</div></div>
<div class="ttc" id="physicslib_8cpp_html_a56b5812a8b6883ca5fe5e5345a526b75"><div class="ttname"><a href="physicslib_8cpp.html#a56b5812a8b6883ca5fe5e5345a526b75">initialutc</a></div><div class="ttdeci">static double initialutc</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:43</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga0ab927d0ce1a6822fd4be8392515c41d"><div class="ttname"><a href="group__mathlib__functions.html#ga0ab927d0ce1a6822fd4be8392515c41d">rv_unity</a></div><div class="ttdeci">rvector rv_unity(double scale)</div><div class="ttdoc">Scaled y row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:129</div></div>
<div class="ttc" id="structmatrix2d_html_a1e46c323ac5c556d1564e6552fc95eb6"><div class="ttname"><a href="structmatrix2d.html#a1e46c323ac5c556d1564e6552fc95eb6">matrix2d::array</a></div><div class="ttdeci">double array[4][4]</div><div class="ttdoc">Elements. </div><div class="ttdef"><b>Definition:</b> matrix.h:88</div></div>
<div class="ttc" id="vector_8cpp_html_a7b455a47657477c96faae73ef614fb3d"><div class="ttname"><a href="vector_8cpp.html#a7b455a47657477c96faae73ef614fb3d">q_smult</a></div><div class="ttdeci">quaternion q_smult(double a, quaternion b)</div><div class="ttdoc">Multiply quaternion by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1151</div></div>
<div class="ttc" id="vector_8cpp_html_a4cfee4d6799b84744d6885b0c7c30630"><div class="ttname"><a href="vector_8cpp.html#a4cfee4d6799b84744d6885b0c7c30630">length_q</a></div><div class="ttdeci">double length_q(quaternion q)</div><div class="ttdoc">Length of quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1329</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="vector_8cpp_html_ad3b9f20d98c02e6a2c6fc57a7c55826d"><div class="ttname"><a href="vector_8cpp.html#ad3b9f20d98c02e6a2c6fc57a7c55826d">normalize_q</a></div><div class="ttdeci">void normalize_q(quaternion *q)</div><div class="ttdef"><b>Definition:</b> vector.cpp:961</div></div>
<div class="ttc" id="group__demlib__functions_html_gaf7e4f0cdeccd2fdb836f06659d0524d7"><div class="ttname"><a href="group__demlib__functions.html#gaf7e4f0cdeccd2fdb836f06659d0524d7">map_dem_pixel</a></div><div class="ttdeci">dem_pixel map_dem_pixel(int body, double lon, double lat, double res)</div><div class="ttdoc">Height in DEM. </div><div class="ttdef"><b>Definition:</b> demlib.cpp:357</div></div>
<div class="ttc" id="structmatrix2d_html_a76037cca0e427c74ab59ea871c034acd"><div class="ttname"><a href="structmatrix2d.html#a76037cca0e427c74ab59ea871c034acd">matrix2d::rows</a></div><div class="ttdeci">uint16_t rows</div><div class="ttdoc">Number of rows. </div><div class="ttdef"><b>Definition:</b> matrix.h:84</div></div>
<div class="ttc" id="structrmatrix_html"><div class="ttname"><a href="structrmatrix.html">rmatrix</a></div><div class="ttdoc">3x3 element generic matrix </div><div class="ttdef"><b>Definition:</b> matrix.h:41</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga34669623045ba324af3e0e465da4673c"><div class="ttname"><a href="group__convertlib__functions.html#ga34669623045ba324af3e0e465da4673c">att_geoc2icrf</a></div><div class="ttdeci">void att_geoc2icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1619</div></div>
<div class="ttc" id="vector_8cpp_html_aecec827dcad2784658f70113f527fa4a"><div class="ttname"><a href="vector_8cpp.html#aecec827dcad2784658f70113f527fa4a">q_change_around_z</a></div><div class="ttdeci">quaternion q_change_around_z(double angle)</div><div class="ttdoc">Rotation quaternion for Z axis. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1461</div></div>
<div class="ttc" id="structmatrix2d_html"><div class="ttname"><a href="structmatrix2d.html">matrix2d</a></div><div class="ttdoc">nxm element 2D matrix </div><div class="ttdef"><b>Definition:</b> matrix.h:81</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__convertlib__constants_html_gab390472803f74cb9dfbf3f47cf6b82cd"><div class="ttname"><a href="group__convertlib__constants.html#gab390472803f74cb9dfbf3f47cf6b82cd">RMOONM</a></div><div class="ttdeci">#define RMOONM</div><div class="ttdoc">SI Radius of Moon. </div><div class="ttdef"><b>Definition:</b> convertdef.h:58</div></div>
<div class="ttc" id="group__mathlib__functions_html_gab90467a79da270c024863945d0cea778"><div class="ttname"><a href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a></div><div class="ttdeci">rvector rv_unitz(double scale)</div><div class="ttdoc">Scaled z row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:140</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga47c2eee20fb1d9d75dbec8e84fc0c133"><div class="ttname"><a href="group__convertlib__functions.html#ga47c2eee20fb1d9d75dbec8e84fc0c133">att_icrf</a></div><div class="ttdeci">void att_icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1798</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="structgj__handle_html_acbc5bd29496ca4d3b055cac4de98f8ae"><div class="ttname"><a href="structgj__handle.html#acbc5bd29496ca4d3b055cac4de98f8ae">gj_handle::order</a></div><div class="ttdeci">uint32_t order</div><div class="ttdef"><b>Definition:</b> physicsdef.h:109</div></div>
<div class="ttc" id="group__demlib__planets_html_gaea348e6fd7b22620d80ab0f5643b7fbe"><div class="ttname"><a href="group__demlib__planets.html#gaea348e6fd7b22620d80ab0f5643b7fbe">COSMOS_MOON</a></div><div class="ttdeci">#define COSMOS_MOON</div><div class="ttdef"><b>Definition:</b> convertdef.h:144</div></div>
<div class="ttc" id="group__demlib__planets_html_ga953a753d5b76c9871e10a848b6a264f0"><div class="ttname"><a href="group__demlib__planets.html#ga953a753d5b76c9871e10a848b6a264f0">COSMOS_EARTH</a></div><div class="ttdeci">#define COSMOS_EARTH</div><div class="ttdef"><b>Definition:</b> convertdef.h:137</div></div>
<div class="ttc" id="group__convertlib__constants_html_ga6fb8d193b2acad94b9562024006a1d33"><div class="ttname"><a href="group__convertlib__constants.html#ga6fb8d193b2acad94b9562024006a1d33">REARTHM</a></div><div class="ttdeci">#define REARTHM</div><div class="ttdoc">SI Radius of Earth. </div><div class="ttdef"><b>Definition:</b> convertdef.h:60</div></div>
<div class="ttc" id="structgj__handle_html_a7fd87f83546183ecfa0c85018a259aa1"><div class="ttname"><a href="structgj__handle.html#a7fd87f83546183ecfa0c85018a259aa1">gj_handle::dtsq</a></div><div class="ttdeci">double dtsq</div><div class="ttdef"><b>Definition:</b> physicsdef.h:108</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="structmatrix2d_html_a0b93d7a1de4f1e801d8c834cd0d744fc"><div class="ttname"><a href="structmatrix2d.html#a0b93d7a1de4f1e801d8c834cd0d744fc">matrix2d::cols</a></div><div class="ttdeci">uint16_t cols</div><div class="ttdoc">Number of elements. </div><div class="ttdef"><b>Definition:</b> matrix.h:86</div></div>
<div class="ttc" id="structrvector_html_a437a4e54ac234bd50d3545aaa04312fd"><div class="ttname"><a href="structrvector.html#a437a4e54ac234bd50d3545aaa04312fd">rvector::col</a></div><div class="ttdeci">double col[3]</div><div class="ttdef"><b>Definition:</b> vector.h:55</div></div>
<div class="ttc" id="structphysicsstruc_html_ad34bd2ae633ea1bdbf01e2f38bf35a36"><div class="ttname"><a href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">physicsstruc::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Time step in seconds. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:141</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga452b1f8bfdeb3462c9306be76da2a47b"><div class="ttname"><a href="group__mathlib__functions.html#ga452b1f8bfdeb3462c9306be76da2a47b">irotate</a></div><div class="ttdeci">rvector irotate(quaternion q, rvector v)</div><div class="ttdoc">Indirectly rotate a row vector using a quaternion. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:2308</div></div>
<div class="ttc" id="structgj__handle_html_ae9962ed18b4c84e077e08e1fdf081795"><div class="ttname"><a href="structgj__handle.html#ae9962ed18b4c84e077e08e1fdf081795">gj_handle::step</a></div><div class="ttdeci">vector&lt; gjstruc &gt; step</div><div class="ttdef"><b>Definition:</b> physicsdef.h:111</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structphysicsstruc_html_ac7ce668e6c24f9cc73b884da33a758ce"><div class="ttname"><a href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">physicsstruc::mode</a></div><div class="ttdeci">int32_t mode</div><div class="ttdef"><b>Definition:</b> physicsdef.h:151</div></div>
<div class="ttc" id="group__mathlib__constants_html_gaf44fd25b63d0688e4373be36c271ab2c"><div class="ttname"><a href="group__mathlib__constants.html#gaf44fd25b63d0688e4373be36c271ab2c">DPI</a></div><div class="ttdeci">const double DPI</div><div class="ttdoc">Double precision PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:14</div></div>
<div class="ttc" id="structdem__pixel_html"><div class="ttname"><a href="structdem__pixel.html">dem_pixel</a></div><div class="ttdoc">Location value. </div><div class="ttdef"><b>Definition:</b> demlib.h:82</div></div>
<div class="ttc" id="group__mathlib__functions_html_gacd0bd1cf5e88440f2912f37c9a5e2c4b"><div class="ttname"><a href="group__mathlib__functions.html#gacd0bd1cf5e88440f2912f37c9a5e2c4b">rv_unitx</a></div><div class="ttdeci">rvector rv_unitx(double scale)</div><div class="ttdoc">Scaled x row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:118</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4d53b830876193698ea7ac99cd3ba8a4"><div class="ttname"><a href="group__convertlib__functions.html#ga4d53b830876193698ea7ac99cd3ba8a4">att_topo</a></div><div class="ttdeci">int32_t att_topo(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2202</div></div>
<div class="ttc" id="structrmatrix_html_aa665325d4b450cb862942302ec648f3d"><div class="ttname"><a href="structrmatrix.html#aa665325d4b450cb862942302ec648f3d">rmatrix::row</a></div><div class="ttdeci">rvector row[3]</div><div class="ttdef"><b>Definition:</b> matrix.h:43</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga87872977600612c97f2ccd895a18c1a4"><div class="ttname"><a href="group__mathlib__functions.html#ga87872977600612c97f2ccd895a18c1a4">rv_cross</a></div><div class="ttdeci">rvector rv_cross(rvector a, rvector b)</div><div class="ttdoc">Take cross product of two row vectors. </div><div class="ttdef"><b>Definition:</b> vector.cpp:363</div></div>
<div class="ttc" id="vector_8cpp_html_a5c389f779b8f5b2273b4ae64557a8ea5"><div class="ttname"><a href="vector_8cpp.html#a5c389f779b8f5b2273b4ae64557a8ea5">q_add</a></div><div class="ttdeci">quaternion q_add(quaternion a, quaternion b)</div><div class="ttdoc">Add two quaternions. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1168</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga94983544dca7cd6b87c05c769ce62921"><div class="ttname"><a href="group__physicslib__functions.html#ga94983544dca7cd6b87c05c769ce62921">pos_accel</a></div><div class="ttdeci">int32_t pos_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Position acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1553</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga90c1cff517710673c6b13a284cb714ac"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int orbit_propagate </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>root</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>mjd</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Load TLE's from file. </p>
<div class="fragment"><div class="line"><a name="l03260"></a><span class="lineno"> 3260</span>&#160;{</div><div class="line"><a name="l03261"></a><span class="lineno"> 3261</span>&#160;    <a class="code" href="structcartpos.html">cartpos</a> npos;</div><div class="line"><a name="l03262"></a><span class="lineno"> 3262</span>&#160;    int32_t chunks, <a class="code" href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a>, <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l03263"></a><span class="lineno"> 3263</span>&#160;    <span class="keywordtype">double</span> nutc;</div><div class="line"><a name="l03264"></a><span class="lineno"> 3264</span>&#160;</div><div class="line"><a name="l03265"></a><span class="lineno"> 3265</span>&#160;    chunks = (uint32_t)(.5 + 86400.*(utc-cinfo-&gt;node.loc.utc)/cinfo-&gt;physics.dt);</div><div class="line"><a name="l03266"></a><span class="lineno"> 3266</span>&#160;    <span class="keywordflow">if</span> (chunks &gt; 100000)</div><div class="line"><a name="l03267"></a><span class="lineno"> 3267</span>&#160;    {</div><div class="line"><a name="l03268"></a><span class="lineno"> 3268</span>&#160;        chunks = 100000;</div><div class="line"><a name="l03269"></a><span class="lineno"> 3269</span>&#160;    }</div><div class="line"><a name="l03270"></a><span class="lineno"> 3270</span>&#160;    nutc = cinfo-&gt;node.loc.utc;</div><div class="line"><a name="l03271"></a><span class="lineno"> 3271</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;chunks; i++)</div><div class="line"><a name="l03272"></a><span class="lineno"> 3272</span>&#160;    {</div><div class="line"><a name="l03273"></a><span class="lineno"> 3273</span>&#160;        nutc += cinfo-&gt;physics.dt/86400.;</div><div class="line"><a name="l03274"></a><span class="lineno"> 3274</span>&#160;        <span class="keywordflow">switch</span> (<a class="code" href="physicslib_8cpp.html#a57258dfe68a418276d1aeb994687f8d9">orbitfile</a>[0])</div><div class="line"><a name="l03275"></a><span class="lineno"> 3275</span>&#160;        {</div><div class="line"><a name="l03276"></a><span class="lineno"> 3276</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div><div class="line"><a name="l03277"></a><span class="lineno"> 3277</span>&#160;            <span class="keywordflow">if</span> ((iretn=<a class="code" href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a>(nutc,<a class="code" href="physicslib_8cpp.html#a60d17d0a390203fef71c0a9d15daaf47">stkhandle</a>,npos)) &lt; 0)</div><div class="line"><a name="l03278"></a><span class="lineno"> 3278</span>&#160;                <span class="keywordflow">return</span> iretn;</div><div class="line"><a name="l03279"></a><span class="lineno"> 3279</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03280"></a><span class="lineno"> 3280</span>&#160;        <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div><div class="line"><a name="l03281"></a><span class="lineno"> 3281</span>&#160;            <span class="keywordflow">if</span> ((iretn=<a class="code" href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a>(nutc,cinfo-&gt;tle,npos)) &lt; 0)</div><div class="line"><a name="l03282"></a><span class="lineno"> 3282</span>&#160;                <span class="keywordflow">return</span> iretn;</div><div class="line"><a name="l03283"></a><span class="lineno"> 3283</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03284"></a><span class="lineno"> 3284</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l03285"></a><span class="lineno"> 3285</span>&#160;            <span class="keywordflow">return</span> (<a class="code" href="group__error__defines.html#ga4b8b3d79a08e6bea07a7c0a51d2d910b">ORBIT_ERROR_NOTSUPPORTED</a>);</div><div class="line"><a name="l03286"></a><span class="lineno"> 3286</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l03287"></a><span class="lineno"> 3287</span>&#160;        }</div><div class="line"><a name="l03288"></a><span class="lineno"> 3288</span>&#160;        <a class="code" href="group__physicslib__functions.html#ga956263bca754093679747bc3d12b733d">update_eci</a>(cinfo,nutc,npos);</div><div class="line"><a name="l03289"></a><span class="lineno"> 3289</span>&#160;</div><div class="line"><a name="l03290"></a><span class="lineno"> 3290</span>&#160;    }</div><div class="line"><a name="l03291"></a><span class="lineno"> 3291</span>&#160;</div><div class="line"><a name="l03292"></a><span class="lineno"> 3292</span>&#160;</div><div class="line"><a name="l03293"></a><span class="lineno"> 3293</span>&#160;    cinfo-&gt;timestamp = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l03294"></a><span class="lineno"> 3294</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03295"></a><span class="lineno"> 3295</span>&#160;}</div><div class="ttc" id="group__physicslib__functions_html_ga956263bca754093679747bc3d12b733d"><div class="ttname"><a href="group__physicslib__functions.html#ga956263bca754093679747bc3d12b733d">update_eci</a></div><div class="ttdeci">int update_eci(cosmosstruc *cinfo, double utc, cartpos pos)</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:3297</div></div>
<div class="ttc" id="physicslib_8cpp_html_a57258dfe68a418276d1aeb994687f8d9"><div class="ttname"><a href="physicslib_8cpp.html#a57258dfe68a418276d1aeb994687f8d9">orbitfile</a></div><div class="ttdeci">static string orbitfile</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:44</div></div>
<div class="ttc" id="rw__test_8cpp_html_acb559820d9ca11295b4500f179ef6392"><div class="ttname"><a href="rw__test_8cpp.html#acb559820d9ca11295b4500f179ef6392">i</a></div><div class="ttdeci">int i</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="structcartpos_html"><div class="ttname"><a href="structcartpos.html">cartpos</a></div><div class="ttdoc">Cartesian full position structure. </div><div class="ttdef"><b>Definition:</b> convertdef.h:158</div></div>
<div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__error__defines_html_ga4b8b3d79a08e6bea07a7c0a51d2d910b"><div class="ttname"><a href="group__error__defines.html#ga4b8b3d79a08e6bea07a7c0a51d2d910b">ORBIT_ERROR_NOTSUPPORTED</a></div><div class="ttdeci">#define ORBIT_ERROR_NOTSUPPORTED</div><div class="ttdef"><b>Definition:</b> cosmos-errno.h:140</div></div>
<div class="ttc" id="physicslib_8cpp_html_a60d17d0a390203fef71c0a9d15daaf47"><div class="ttname"><a href="physicslib_8cpp.html#a60d17d0a390203fef71c0a9d15daaf47">stkhandle</a></div><div class="ttdeci">static stkstruc stkhandle</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:45</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8f7230867b57198344a49faeab0a83f2"><div class="ttname"><a href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a></div><div class="ttdeci">int lines2eci(double utc, vector&lt; tlestruc &gt;lines, cartpos &amp;eci)</div><div class="ttdoc">Return position from TLE set. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3073</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad43f2fcdeaaa277215f0e490f443af08"><div class="ttname"><a href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a></div><div class="ttdeci">int stk2eci(double utc, stkstruc &amp;stk, cartpos &amp;eci)</div><div class="ttdoc">ECI from STK data. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3732</div></div>
</div><!-- fragment -->
</div>
</div>
<a class="anchor" id="ga4a729180343719d08b86825e9b0dd0ee"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int orbit_init </td>
          <td>(</td>
          <td class="paramtype">int32_t&#160;</td>
          <td class="paramname"><em>mode</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>dt</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>utc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">string&#160;</td>
          <td class="paramname"><em>ofile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structcosmosstruc.html">cosmosstruc</a> *&#160;</td>
          <td class="paramname"><em>cinfo</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Initialize orbit from orbital data. </p>
<p>Initializes satellite structure using orbital data </p><dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">mode</td><td>The style of propagation. Zero is free propagation. </td></tr>
    <tr><td class="paramname">dt</td><td>Step size in seconds </td></tr>
    <tr><td class="paramname">utc</td><td>Initial step time as UTC in Modified Julian Days. If set to 0., first time in the orbital data will be used. </td></tr>
    <tr><td class="paramname">ofile</td><td>Name of the file containing orbital data. Two Line Element set if first letter is 't', STK data if first letter is 's'. </td></tr>
    <tr><td class="paramname">cinfo</td><td>Reference to <a class="el" href="structcosmosstruc.html" title="JSON Name Space structure. ">cosmosstruc</a> to use.</td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>Returns 0 if succsessful, otherwise negative error. </dd></dl>
<div class="fragment"><div class="line"><a name="l03151"></a><span class="lineno"> 3151</span>&#160;{</div><div class="line"><a name="l03152"></a><span class="lineno"> 3152</span>&#160;    int32_t <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l03153"></a><span class="lineno"> 3153</span>&#160;    <a class="code" href="structtlestruc.html">tlestruc</a> tline;</div><div class="line"><a name="l03154"></a><span class="lineno"> 3154</span>&#160;</div><div class="line"><a name="l03155"></a><span class="lineno"> 3155</span>&#160;    <span class="comment">// Munge time step to fit local granularity</span></div><div class="line"><a name="l03156"></a><span class="lineno"> 3156</span>&#160;    <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a> = 86400.*((utc + <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>/86400.)-utc);</div><div class="line"><a name="l03157"></a><span class="lineno"> 3157</span>&#160;</div><div class="line"><a name="l03158"></a><span class="lineno"> 3158</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a> = <a class="code" href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a>;</div><div class="line"><a name="l03159"></a><span class="lineno"> 3159</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">dtj</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">dt</a>/86400.;</div><div class="line"><a name="l03160"></a><span class="lineno"> 3160</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a> = mode;</div><div class="line"><a name="l03161"></a><span class="lineno"> 3161</span>&#160;</div><div class="line"><a name="l03162"></a><span class="lineno"> 3162</span>&#160;    <a class="code" href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03163"></a><span class="lineno"> 3163</span>&#160;</div><div class="line"><a name="l03164"></a><span class="lineno"> 3164</span>&#160;    <span class="keywordflow">switch</span> (ofile[0])</div><div class="line"><a name="l03165"></a><span class="lineno"> 3165</span>&#160;    {</div><div class="line"><a name="l03166"></a><span class="lineno"> 3166</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;s&#39;</span>:</div><div class="line"><a name="l03167"></a><span class="lineno"> 3167</span>&#160;        <span class="keywordflow">if</span> ((iretn=<a class="code" href="group__convertlib__functions.html#ga0686dc0e2351e5122a72c3c93234b4d7">load_stk</a>(ofile,<a class="code" href="physicslib_8cpp.html#a60d17d0a390203fef71c0a9d15daaf47">stkhandle</a>)) &lt; 2)</div><div class="line"><a name="l03168"></a><span class="lineno"> 3168</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l03169"></a><span class="lineno"> 3169</span>&#160;        <span class="keywordflow">if</span> (utc == 0.)</div><div class="line"><a name="l03170"></a><span class="lineno"> 3170</span>&#160;        {</div><div class="line"><a name="l03171"></a><span class="lineno"> 3171</span>&#160;            utc = <a class="code" href="physicslib_8cpp.html#a60d17d0a390203fef71c0a9d15daaf47">stkhandle</a>.<a class="code" href="structstkstruc.html#ac121eb1de6617c57a6ad80b4753fa560">pos</a>[1].<a class="code" href="structcposstruc.html#a90c583d0c316e341fdd89ecacfb92cf7">utc</a>;</div><div class="line"><a name="l03172"></a><span class="lineno"> 3172</span>&#160;        }</div><div class="line"><a name="l03173"></a><span class="lineno"> 3173</span>&#160;        <span class="keywordflow">if</span> ((iretn=<a class="code" href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a>(utc,<a class="code" href="physicslib_8cpp.html#a60d17d0a390203fef71c0a9d15daaf47">stkhandle</a>,cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>)) &lt; 0)</div><div class="line"><a name="l03174"></a><span class="lineno"> 3174</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l03175"></a><span class="lineno"> 3175</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03176"></a><span class="lineno"> 3176</span>&#160;    <span class="keywordflow">case</span> <span class="charliteral">&#39;t&#39;</span>:</div><div class="line"><a name="l03177"></a><span class="lineno"> 3177</span>&#160;        <span class="keywordflow">if</span> ((iretn=<a class="code" href="group__convertlib__functions.html#gabd510736647f0b5ebdac88d4c9097cb6">load_lines</a>(ofile, cinfo-&gt;<a class="code" href="structcosmosstruc.html#a95ccd25a3478cdc9cf27f77f6da409e3">tle</a>)) &lt; 0)</div><div class="line"><a name="l03178"></a><span class="lineno"> 3178</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l03179"></a><span class="lineno"> 3179</span>&#160;        <span class="keywordflow">if</span> (utc == 0.)</div><div class="line"><a name="l03180"></a><span class="lineno"> 3180</span>&#160;        {</div><div class="line"><a name="l03181"></a><span class="lineno"> 3181</span>&#160;            tline = <a class="code" href="group__convertlib__functions.html#gab7f9384229d0c8072986a673316b07f2">get_line</a>(0, cinfo-&gt;<a class="code" href="structcosmosstruc.html#a95ccd25a3478cdc9cf27f77f6da409e3">tle</a>);</div><div class="line"><a name="l03182"></a><span class="lineno"> 3182</span>&#160;            utc = tline.<a class="code" href="structtlestruc.html#ada163d20810e9fbdcf2e92f13b5c1af5">utc</a>;</div><div class="line"><a name="l03183"></a><span class="lineno"> 3183</span>&#160;        }</div><div class="line"><a name="l03184"></a><span class="lineno"> 3184</span>&#160;        <span class="keywordflow">if</span> ((iretn=<a class="code" href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a>(utc,cinfo-&gt;<a class="code" href="structcosmosstruc.html#a95ccd25a3478cdc9cf27f77f6da409e3">tle</a>,cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>)) &lt; 0)</div><div class="line"><a name="l03185"></a><span class="lineno"> 3185</span>&#160;            <span class="keywordflow">return</span> <a class="code" href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a>;</div><div class="line"><a name="l03186"></a><span class="lineno"> 3186</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03187"></a><span class="lineno"> 3187</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l03188"></a><span class="lineno"> 3188</span>&#160;        <span class="keywordflow">return</span> (<a class="code" href="group__error__defines.html#ga4b8b3d79a08e6bea07a7c0a51d2d910b">ORBIT_ERROR_NOTSUPPORTED</a>);</div><div class="line"><a name="l03189"></a><span class="lineno"> 3189</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03190"></a><span class="lineno"> 3190</span>&#160;    }</div><div class="line"><a name="l03191"></a><span class="lineno"> 3191</span>&#160;</div><div class="line"><a name="l03192"></a><span class="lineno"> 3192</span>&#160;    <a class="code" href="physicslib_8cpp.html#a57258dfe68a418276d1aeb994687f8d9">orbitfile</a> = ofile;</div><div class="line"><a name="l03193"></a><span class="lineno"> 3193</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">eci</a>.<a class="code" href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">pass</a>++;</div><div class="line"><a name="l03194"></a><span class="lineno"> 3194</span>&#160;    <a class="code" href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03195"></a><span class="lineno"> 3195</span>&#160;</div><div class="line"><a name="l03196"></a><span class="lineno"> 3196</span>&#160;    <span class="comment">// Initial attitude</span></div><div class="line"><a name="l03197"></a><span class="lineno"> 3197</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a729474b703b213c723c98937382c673c">ftorque</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03198"></a><span class="lineno"> 3198</span>&#160;    <span class="keywordflow">switch</span> (cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a>)</div><div class="line"><a name="l03199"></a><span class="lineno"> 3199</span>&#160;    {</div><div class="line"><a name="l03200"></a><span class="lineno"> 3200</span>&#160;    <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l03201"></a><span class="lineno"> 3201</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l03202"></a><span class="lineno"> 3202</span>&#160;        <span class="comment">//  cinfo-&gt;node.loc.att.icrf.s = q_eye();</span></div><div class="line"><a name="l03203"></a><span class="lineno"> 3203</span>&#160;        <span class="comment">//  cinfo-&gt;node.loc.att.icrf.v = rv_smult(1.,rv_unitz());</span></div><div class="line"><a name="l03204"></a><span class="lineno"> 3204</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03205"></a><span class="lineno"> 3205</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03206"></a><span class="lineno"> 3206</span>&#160;    <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l03207"></a><span class="lineno"> 3207</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l03208"></a><span class="lineno"> 3208</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l03209"></a><span class="lineno"> 3209</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03210"></a><span class="lineno"> 3210</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03211"></a><span class="lineno"> 3211</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03212"></a><span class="lineno"> 3212</span>&#160;    <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l03213"></a><span class="lineno"> 3213</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">topo</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l03214"></a><span class="lineno"> 3214</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">topo</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l03215"></a><span class="lineno"> 3215</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">topo</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03216"></a><span class="lineno"> 3216</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">topo</a>.<a class="code" href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">pass</a>++;</div><div class="line"><a name="l03217"></a><span class="lineno"> 3217</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga4d53b830876193698ea7ac99cd3ba8a4">att_topo</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03218"></a><span class="lineno"> 3218</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03219"></a><span class="lineno"> 3219</span>&#160;    <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l03220"></a><span class="lineno"> 3220</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l03221"></a><span class="lineno"> 3221</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l03222"></a><span class="lineno"> 3222</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">lvlh</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03223"></a><span class="lineno"> 3223</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03224"></a><span class="lineno"> 3224</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03225"></a><span class="lineno"> 3225</span>&#160;    <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l03226"></a><span class="lineno"> 3226</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03227"></a><span class="lineno"> 3227</span>&#160;    <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l03228"></a><span class="lineno"> 3228</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">utc</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l03229"></a><span class="lineno"> 3229</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a>();</div><div class="line"><a name="l03230"></a><span class="lineno"> 3230</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">geoc</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(.2*<a class="code" href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a>,<a class="code" href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a>());</div><div class="line"><a name="l03231"></a><span class="lineno"> 3231</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga34669623045ba324af3e0e465da4673c">att_geoc2icrf</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03232"></a><span class="lineno"> 3232</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga4942297c63cf2b95cde477a04cdde02d">att_planec2lvlh</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03233"></a><span class="lineno"> 3233</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03234"></a><span class="lineno"> 3234</span>&#160;    <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l03235"></a><span class="lineno"> 3235</span>&#160;    <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l03236"></a><span class="lineno"> 3236</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l03237"></a><span class="lineno"> 3237</span>&#160;    <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l03238"></a><span class="lineno"> 3238</span>&#160;    <span class="keywordflow">case</span> 10:</div><div class="line"><a name="l03239"></a><span class="lineno"> 3239</span>&#160;    <span class="keywordflow">case</span> 11:</div><div class="line"><a name="l03240"></a><span class="lineno"> 3240</span>&#160;    <span class="keywordflow">case</span> 12:</div><div class="line"><a name="l03241"></a><span class="lineno"> 3241</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">s</a> = <a class="code" href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">faces</a>[abs(cinfo-&gt;<a class="code" href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">pieces</a>[cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">mode</a>-2].face_idx[0])].normal.to_rv(),<a class="code" href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a>(-1.,cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">pos</a>.<a class="code" href="structposstruc.html#acd31426d000874db136ca434f3f62b14">icrf</a>.<a class="code" href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">s</a>));</div><div class="line"><a name="l03242"></a><span class="lineno"> 3242</span>&#160;        cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">att</a>.<a class="code" href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">icrf</a>.<a class="code" href="structqatt.html#ae7a4146ef39f05363058605cf084c828">v</a> = <a class="code" href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a>();</div><div class="line"><a name="l03243"></a><span class="lineno"> 3243</span>&#160;        <a class="code" href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a>(&amp;cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03244"></a><span class="lineno"> 3244</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l03245"></a><span class="lineno"> 3245</span>&#160;    }</div><div class="line"><a name="l03246"></a><span class="lineno"> 3246</span>&#160;</div><div class="line"><a name="l03247"></a><span class="lineno"> 3247</span>&#160;</div><div class="line"><a name="l03248"></a><span class="lineno"> 3248</span>&#160;    <span class="comment">// Initialize hardware</span></div><div class="line"><a name="l03249"></a><span class="lineno"> 3249</span>&#160;    <a class="code" href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a>(cinfo,cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03250"></a><span class="lineno"> 3250</span>&#160;    <a class="code" href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a>(cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>, cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>);</div><div class="line"><a name="l03251"></a><span class="lineno"> 3251</span>&#160;    <span class="comment">//  groundstations(cinfo,&amp;cinfo-&gt;node.loc);</span></div><div class="line"><a name="l03252"></a><span class="lineno"> 3252</span>&#160;</div><div class="line"><a name="l03253"></a><span class="lineno"> 3253</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">physics</a>.<a class="code" href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">mjdbase</a> = cinfo-&gt;<a class="code" href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">node</a>.<a class="code" href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">loc</a>.<a class="code" href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">utc</a>;</div><div class="line"><a name="l03254"></a><span class="lineno"> 3254</span>&#160;</div><div class="line"><a name="l03255"></a><span class="lineno"> 3255</span>&#160;    cinfo-&gt;<a class="code" href="structcosmosstruc.html#abdcf31199a01354992ee8b3f6677c9cd">timestamp</a> = <a class="code" href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a>();</div><div class="line"><a name="l03256"></a><span class="lineno"> 3256</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l03257"></a><span class="lineno"> 3257</span>&#160;}</div><div class="ttc" id="structcosmosstruc_html_abdcf31199a01354992ee8b3f6677c9cd"><div class="ttname"><a href="structcosmosstruc.html#abdcf31199a01354992ee8b3f6677c9cd">cosmosstruc::timestamp</a></div><div class="ttdeci">double timestamp</div><div class="ttdoc">Timestamp for last change to data. </div><div class="ttdef"><b>Definition:</b> jsondef.h:1998</div></div>
<div class="ttc" id="structcosmosstruc_html_a8955419ef9cc9e850608091159cfb316"><div class="ttname"><a href="structcosmosstruc.html#a8955419ef9cc9e850608091159cfb316">cosmosstruc::faces</a></div><div class="ttdeci">vector&lt; facestruc &gt; faces</div><div class="ttdoc">Vector of all faces in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2020</div></div>
<div class="ttc" id="structcosmosstruc_html_a95ccd25a3478cdc9cf27f77f6da409e3"><div class="ttname"><a href="structcosmosstruc.html#a95ccd25a3478cdc9cf27f77f6da409e3">cosmosstruc::tle</a></div><div class="ttdeci">vector&lt; tlestruc &gt; tle</div><div class="ttdoc">Array of Two Line Elements. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2044</div></div>
<div class="ttc" id="structcosmosstruc_html_af66e63a63cc00533144a1e422f75ff6e"><div class="ttname"><a href="structcosmosstruc.html#af66e63a63cc00533144a1e422f75ff6e">cosmosstruc::physics</a></div><div class="ttdeci">physicsstruc physics</div><div class="ttdoc">Structure for physics modelling. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2032</div></div>
<div class="ttc" id="structattstruc_html_a7fa9276c6dcd5ac70c1519721956e3a1"><div class="ttname"><a href="structattstruc.html#a7fa9276c6dcd5ac70c1519721956e3a1">attstruc::geoc</a></div><div class="ttdeci">qatt geoc</div><div class="ttdef"><b>Definition:</b> convertdef.h:418</div></div>
<div class="ttc" id="structtlestruc_html"><div class="ttname"><a href="structtlestruc.html">tlestruc</a></div><div class="ttdoc">In units for the SGP4 propogator (not NORAD TLE itself). </div><div class="ttdef"><b>Definition:</b> convertdef.h:445</div></div>
<div class="ttc" id="structstkstruc_html_ac121eb1de6617c57a6ad80b4753fa560"><div class="ttname"><a href="structstkstruc.html#ac121eb1de6617c57a6ad80b4753fa560">stkstruc::pos</a></div><div class="ttdeci">cposstruc * pos</div><div class="ttdoc">Array of positions. </div><div class="ttdef"><b>Definition:</b> convertdef.h:479</div></div>
<div class="ttc" id="agent__file3_8cpp_html_aa17c2ab1d1e9db85d65db31aeb423e5e"><div class="ttname"><a href="agent__file3_8cpp.html#aa17c2ab1d1e9db85d65db31aeb423e5e">dt</a></div><div class="ttdeci">ElapsedTime dt</div><div class="ttdef"><b>Definition:</b> agent_file3.cpp:183</div></div>
<div class="ttc" id="physicslib_8cpp_html_a57258dfe68a418276d1aeb994687f8d9"><div class="ttname"><a href="physicslib_8cpp.html#a57258dfe68a418276d1aeb994687f8d9">orbitfile</a></div><div class="ttdeci">static string orbitfile</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:44</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4942297c63cf2b95cde477a04cdde02d"><div class="ttname"><a href="group__convertlib__functions.html#ga4942297c63cf2b95cde477a04cdde02d">att_planec2lvlh</a></div><div class="ttdeci">void att_planec2lvlh(locstruc *loc)</div><div class="ttdoc">Convert ITRS attitude to LVLH attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1823</div></div>
<div class="ttc" id="structcartpos_html_a78cbaffab7e843424e84e17f85838e7c"><div class="ttname"><a href="structcartpos.html#a78cbaffab7e843424e84e17f85838e7c">cartpos::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:169</div></div>
<div class="ttc" id="rw__test_8cpp_html_afece067d35cd26a458c56fa8f276e734"><div class="ttname"><a href="rw__test_8cpp.html#afece067d35cd26a458c56fa8f276e734">iretn</a></div><div class="ttdeci">int iretn</div><div class="ttdef"><b>Definition:</b> rw_test.cpp:37</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga94feaa83d915eaacdc5ce8e86cf9d0db"><div class="ttname"><a href="group__convertlib__functions.html#ga94feaa83d915eaacdc5ce8e86cf9d0db">att_icrf2lvlh</a></div><div class="ttdeci">void att_icrf2lvlh(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1786</div></div>
<div class="ttc" id="structphysicsstruc_html_a729474b703b213c723c98937382c673c"><div class="ttname"><a href="structphysicsstruc.html#a729474b703b213c723c98937382c673c">physicsstruc::ftorque</a></div><div class="ttdeci">Vector ftorque</div><div class="ttdef"><b>Definition:</b> physicsdef.h:153</div></div>
<div class="ttc" id="structlocstruc_html_a3e292c0cfc34066509120bcddeb5b33d"><div class="ttname"><a href="structlocstruc.html#a3e292c0cfc34066509120bcddeb5b33d">locstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">Master time for location, in Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:430</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga176c89dd2090f07441e4bbced785a87a"><div class="ttname"><a href="group__convertlib__functions.html#ga176c89dd2090f07441e4bbced785a87a">att_lvlh2icrf</a></div><div class="ttdeci">int32_t att_lvlh2icrf(locstruc *loc)</div><div class="ttdoc">Convert LVLH attitude to ICRF attitude. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1990</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad8bb4df5e17661de5f87ca5ad087fef9"><div class="ttname"><a href="group__convertlib__functions.html#gad8bb4df5e17661de5f87ca5ad087fef9">pos_clear</a></div><div class="ttdeci">int32_t pos_clear(locstruc &amp;loc)</div><div class="ttdoc">Initialize posstruc. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:74</div></div>
<div class="ttc" id="structattstruc_html_aec8fb6dfc04ad7ba962ea19f7e357bf5"><div class="ttname"><a href="structattstruc.html#aec8fb6dfc04ad7ba962ea19f7e357bf5">attstruc::lvlh</a></div><div class="ttdeci">qatt lvlh</div><div class="ttdef"><b>Definition:</b> convertdef.h:417</div></div>
<div class="ttc" id="structqatt_html_ae7a4146ef39f05363058605cf084c828"><div class="ttname"><a href="structqatt.html#ae7a4146ef39f05363058605cf084c828">qatt::v</a></div><div class="ttdeci">rvector v</div><div class="ttdoc">1st derivative: Omega - angular velocity </div><div class="ttdef"><b>Definition:</b> convertdef.h:281</div></div>
<div class="ttc" id="group__mathlib__functions_html_gaa923fae632d6a76362063fddc779d861"><div class="ttname"><a href="group__mathlib__functions.html#gaa923fae632d6a76362063fddc779d861">rv_smult</a></div><div class="ttdeci">rvector rv_smult(double a, rvector b)</div><div class="ttdoc">Multiply row vector by scalar. </div><div class="ttdef"><b>Definition:</b> vector.cpp:266</div></div>
<div class="ttc" id="structcosmosstruc_html_af4e942210d74ec7b18eed16914c366ce"><div class="ttname"><a href="structcosmosstruc.html#af4e942210d74ec7b18eed16914c366ce">cosmosstruc::node</a></div><div class="ttdeci">nodestruc node</div><div class="ttdoc">Structure for summary information in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2014</div></div>
<div class="ttc" id="structqatt_html_abc312a476f5ca0e062639bd3cdcf2662"><div class="ttname"><a href="structqatt.html#abc312a476f5ca0e062639bd3cdcf2662">qatt::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:277</div></div>
<div class="ttc" id="structcartpos_html_ab9c0e27906f5ade25bd47d2eabc0c67e"><div class="ttname"><a href="structcartpos.html#ab9c0e27906f5ade25bd47d2eabc0c67e">cartpos::s</a></div><div class="ttdeci">rvector s</div><div class="ttdoc">Location. </div><div class="ttdef"><b>Definition:</b> convertdef.h:163</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga1a926ca1b9ab0b6951b866a916c71f53"><div class="ttname"><a href="group__mathlib__functions.html#ga1a926ca1b9ab0b6951b866a916c71f53">q_drotate_between_rv</a></div><div class="ttdeci">quaternion q_drotate_between_rv(rvector from, rvector to)</div><div class="ttdoc">Create rotation quaternion from 2 row vectors. </div><div class="ttdef"><b>Definition:</b> mathlib.cpp:81</div></div>
<div class="ttc" id="structlocstruc_html_a323a46da3a2dbbe3ed343cb781aa017b"><div class="ttname"><a href="structlocstruc.html#a323a46da3a2dbbe3ed343cb781aa017b">locstruc::att</a></div><div class="ttdeci">attstruc att</div><div class="ttdoc">attstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:434</div></div>
<div class="ttc" id="structcposstruc_html_a90c583d0c316e341fdd89ecacfb92cf7"><div class="ttname"><a href="structcposstruc.html#a90c583d0c316e341fdd89ecacfb92cf7">cposstruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdoc">UTC as Modified Julian Day. </div><div class="ttdef"><b>Definition:</b> convertdef.h:182</div></div>
<div class="ttc" id="group__error__defines_html_ga4b8b3d79a08e6bea07a7c0a51d2d910b"><div class="ttname"><a href="group__error__defines.html#ga4b8b3d79a08e6bea07a7c0a51d2d910b">ORBIT_ERROR_NOTSUPPORTED</a></div><div class="ttdeci">#define ORBIT_ERROR_NOTSUPPORTED</div><div class="ttdef"><b>Definition:</b> cosmos-errno.h:140</div></div>
<div class="ttc" id="group__physicslib__functions_html_gae062777be16aa6b1810950abd2bccfef"><div class="ttname"><a href="group__physicslib__functions.html#gae062777be16aa6b1810950abd2bccfef">att_accel</a></div><div class="ttdeci">void att_accel(physicsstruc &amp;physics, locstruc &amp;loc)</div><div class="ttdoc">Attitude acceleration. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:1493</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga34669623045ba324af3e0e465da4673c"><div class="ttname"><a href="group__convertlib__functions.html#ga34669623045ba324af3e0e465da4673c">att_geoc2icrf</a></div><div class="ttdeci">void att_geoc2icrf(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:1619</div></div>
<div class="ttc" id="structattstruc_html_ab287777a27972ef373d3333fc7564a27"><div class="ttname"><a href="structattstruc.html#ab287777a27972ef373d3333fc7564a27">attstruc::icrf</a></div><div class="ttdeci">qatt icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:420</div></div>
<div class="ttc" id="group__convertlib__functions_html_gab7f9384229d0c8072986a673316b07f2"><div class="ttname"><a href="group__convertlib__functions.html#gab7f9384229d0c8072986a673316b07f2">get_line</a></div><div class="ttdeci">tlestruc get_line(uint16_t index, vector&lt; tlestruc &gt; lines)</div><div class="ttdoc">Get TLE from array of TLE&amp;#39;s. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3428</div></div>
<div class="ttc" id="structnodestruc_html_a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7"><div class="ttname"><a href="structnodestruc.html#a11b7bdf3e2c41bdef7eb3f8b0ad4d9b7">nodestruc::loc</a></div><div class="ttdeci">locstruc loc</div><div class="ttdoc">Location structure. </div><div class="ttdef"><b>Definition:</b> jsondef.h:1767</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabced54fcfdf73edf48747fe8bb727c80"><div class="ttname"><a href="group__convertlib__functions.html#gabced54fcfdf73edf48747fe8bb727c80">pos_eci</a></div><div class="ttdeci">int32_t pos_eci(locstruc *loc)</div><div class="ttdoc">Set ECI position. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:247</div></div>
<div class="ttc" id="group__mathlib__functions_html_gab90467a79da270c024863945d0cea778"><div class="ttname"><a href="group__mathlib__functions.html#gab90467a79da270c024863945d0cea778">rv_unitz</a></div><div class="ttdeci">rvector rv_unitz(double scale)</div><div class="ttdoc">Scaled z row vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:140</div></div>
<div class="ttc" id="group__mathlib__functions_html_ga31f1f732587e4fbefe0378d8843a3e25"><div class="ttname"><a href="group__mathlib__functions.html#ga31f1f732587e4fbefe0378d8843a3e25">rv_zero</a></div><div class="ttdeci">rvector rv_zero()</div><div class="ttdoc">Zero row order vector. </div><div class="ttdef"><b>Definition:</b> vector.cpp:107</div></div>
<div class="ttc" id="physicslib_8cpp_html_a60d17d0a390203fef71c0a9d15daaf47"><div class="ttname"><a href="physicslib_8cpp.html#a60d17d0a390203fef71c0a9d15daaf47">stkhandle</a></div><div class="ttdeci">static stkstruc stkhandle</div><div class="ttdef"><b>Definition:</b> physicslib.cpp:45</div></div>
<div class="ttc" id="group__convertlib__functions_html_gabd510736647f0b5ebdac88d4c9097cb6"><div class="ttname"><a href="group__convertlib__functions.html#gabd510736647f0b5ebdac88d4c9097cb6">load_lines</a></div><div class="ttdeci">int32_t load_lines(string fname, vector&lt; tlestruc &gt; &amp;lines)</div><div class="ttdoc">Load TLE from file. TODO!!! Rename Function to loadTle and create new class for dealing with TLEs...</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3528</div></div>
<div class="ttc" id="group__timelib__functions_html_ga39f0682a60fce7940363aad40ad4a244"><div class="ttname"><a href="group__timelib__functions.html#ga39f0682a60fce7940363aad40ad4a244">currentmjd</a></div><div class="ttdeci">double currentmjd(double offset)</div><div class="ttdoc">Current UTC in Modified Julian Days. </div><div class="ttdef"><b>Definition:</b> timelib.cpp:65</div></div>
<div class="ttc" id="structlocstruc_html_a720579567683aee2663de0a7e46942aa"><div class="ttname"><a href="structlocstruc.html#a720579567683aee2663de0a7e46942aa">locstruc::pos</a></div><div class="ttdeci">posstruc pos</div><div class="ttdoc">posstruc for this time. </div><div class="ttdef"><b>Definition:</b> convertdef.h:432</div></div>
<div class="ttc" id="structqatt_html_aa206cfdf50dd7c1e53d2880672480de6"><div class="ttname"><a href="structqatt.html#aa206cfdf50dd7c1e53d2880672480de6">qatt::pass</a></div><div class="ttdeci">uint32_t pass</div><div class="ttdoc">pass indicator: allows synchronization with other attitude and position values. </div><div class="ttdef"><b>Definition:</b> convertdef.h:285</div></div>
<div class="ttc" id="structattstruc_html_a7a07ed22deee4d7ce41c4b97aeaaa836"><div class="ttname"><a href="structattstruc.html#a7a07ed22deee4d7ce41c4b97aeaaa836">attstruc::topo</a></div><div class="ttdeci">qatt topo</div><div class="ttdef"><b>Definition:</b> convertdef.h:416</div></div>
<div class="ttc" id="group__physicslib__functions_html_ga076acc0ac689c3de1a49720ec3fc5f76"><div class="ttname"><a href="group__physicslib__functions.html#ga076acc0ac689c3de1a49720ec3fc5f76">hardware_init_eci</a></div><div class="ttdeci">void hardware_init_eci(cosmosstruc *cinfo, locstruc &amp;loc)</div><div class="ttdoc">Initialize Hardware. </div><div class="ttdef"><b>Definition:</b> physicslib.cpp:877</div></div>
<div class="ttc" id="group__mathlib__constants_html_ga7cfc7d37e17162e1c94a0bf0a9ef62a8"><div class="ttname"><a href="group__mathlib__constants.html#ga7cfc7d37e17162e1c94a0bf0a9ef62a8">D2PI</a></div><div class="ttdeci">const double D2PI</div><div class="ttdoc">Double precision 2*PI. </div><div class="ttdef"><b>Definition:</b> math/constants.h:16</div></div>
<div class="ttc" id="structqatt_html_aa08c71a91b95ee10d8c844c65131e65e"><div class="ttname"><a href="structqatt.html#aa08c71a91b95ee10d8c844c65131e65e">qatt::s</a></div><div class="ttdeci">quaternion s</div><div class="ttdoc">0th derivative: Quaternion </div><div class="ttdef"><b>Definition:</b> convertdef.h:279</div></div>
<div class="ttc" id="structcosmosstruc_html_a581d83a1e99811accb5d74efab9877f6"><div class="ttname"><a href="structcosmosstruc.html#a581d83a1e99811accb5d74efab9877f6">cosmosstruc::pieces</a></div><div class="ttdeci">vector&lt; piecestruc &gt; pieces</div><div class="ttdoc">Vector of all pieces in node. </div><div class="ttdef"><b>Definition:</b> jsondef.h:2022</div></div>
<div class="ttc" id="structphysicsstruc_html_ad34bd2ae633ea1bdbf01e2f38bf35a36"><div class="ttname"><a href="structphysicsstruc.html#ad34bd2ae633ea1bdbf01e2f38bf35a36">physicsstruc::dt</a></div><div class="ttdeci">double dt</div><div class="ttdoc">Time step in seconds. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:141</div></div>
<div class="ttc" id="structposstruc_html_a638c9f59bb5cd4627eeed4bf04c6f476"><div class="ttname"><a href="structposstruc.html#a638c9f59bb5cd4627eeed4bf04c6f476">posstruc::eci</a></div><div class="ttdeci">cartpos eci</div><div class="ttdef"><b>Definition:</b> convertdef.h:396</div></div>
<div class="ttc" id="vector_8cpp_html_a9de9af12a5823bb14ae2b3fb07139b3d"><div class="ttname"><a href="vector_8cpp.html#a9de9af12a5823bb14ae2b3fb07139b3d">q_eye</a></div><div class="ttdeci">quaternion q_eye()</div><div class="ttdoc">Identity quaternion. </div><div class="ttdef"><b>Definition:</b> vector.cpp:1310</div></div>
<div class="ttc" id="structphysicsstruc_html_ac7ce668e6c24f9cc73b884da33a758ce"><div class="ttname"><a href="structphysicsstruc.html#ac7ce668e6c24f9cc73b884da33a758ce">physicsstruc::mode</a></div><div class="ttdeci">int32_t mode</div><div class="ttdef"><b>Definition:</b> physicsdef.h:151</div></div>
<div class="ttc" id="structposstruc_html_acd31426d000874db136ca434f3f62b14"><div class="ttname"><a href="structposstruc.html#acd31426d000874db136ca434f3f62b14">posstruc::icrf</a></div><div class="ttdeci">cartpos icrf</div><div class="ttdef"><b>Definition:</b> convertdef.h:395</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga4d53b830876193698ea7ac99cd3ba8a4"><div class="ttname"><a href="group__convertlib__functions.html#ga4d53b830876193698ea7ac99cd3ba8a4">att_topo</a></div><div class="ttdeci">int32_t att_topo(locstruc *loc)</div><div class="ttdef"><b>Definition:</b> convertlib.cpp:2202</div></div>
<div class="ttc" id="structtlestruc_html_ada163d20810e9fbdcf2e92f13b5c1af5"><div class="ttname"><a href="structtlestruc.html#ada163d20810e9fbdcf2e92f13b5c1af5">tlestruc::utc</a></div><div class="ttdeci">double utc</div><div class="ttdef"><b>Definition:</b> convertdef.h:447</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga8f7230867b57198344a49faeab0a83f2"><div class="ttname"><a href="group__convertlib__functions.html#ga8f7230867b57198344a49faeab0a83f2">lines2eci</a></div><div class="ttdeci">int lines2eci(double utc, vector&lt; tlestruc &gt;lines, cartpos &amp;eci)</div><div class="ttdoc">Return position from TLE set. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3073</div></div>
<div class="ttc" id="structphysicsstruc_html_a52ff2d9795a3a78753a6bbe1e0bb5b6e"><div class="ttname"><a href="structphysicsstruc.html#a52ff2d9795a3a78753a6bbe1e0bb5b6e">physicsstruc::dtj</a></div><div class="ttdeci">double dtj</div><div class="ttdoc">Time step in Julian days. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:143</div></div>
<div class="ttc" id="group__convertlib__functions_html_ga0686dc0e2351e5122a72c3c93234b4d7"><div class="ttname"><a href="group__convertlib__functions.html#ga0686dc0e2351e5122a72c3c93234b4d7">load_stk</a></div><div class="ttdeci">int32_t load_stk(string filename, stkstruc &amp;stkdata)</div><div class="ttdoc">Load STK elements. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3682</div></div>
<div class="ttc" id="group__convertlib__functions_html_gad43f2fcdeaaa277215f0e490f443af08"><div class="ttname"><a href="group__convertlib__functions.html#gad43f2fcdeaaa277215f0e490f443af08">stk2eci</a></div><div class="ttdeci">int stk2eci(double utc, stkstruc &amp;stk, cartpos &amp;eci)</div><div class="ttdoc">ECI from STK data. </div><div class="ttdef"><b>Definition:</b> convertlib.cpp:3732</div></div>
<div class="ttc" id="structphysicsstruc_html_a7c26927025bc587595b9f328042ff8fa"><div class="ttname"><a href="structphysicsstruc.html#a7c26927025bc587595b9f328042ff8fa">physicsstruc::mjdbase</a></div><div class="ttdeci">double mjdbase</div><div class="ttdoc">Simulated starting time in MJD. </div><div class="ttdef"><b>Definition:</b> physicsdef.h:145</div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated on Sun Oct 4 2020 00:17:38 for COSMOS core by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.11 </li>
  </ul>
</div>
</body>
</html>
